{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.EPAmendmentHistoryComponent = void 0;\nconst tslib_1 = require(\"tslib\");\nconst core_1 = require(\"@angular/core\");\nconst common_1 = require(\"@angular/common\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"@angular/router\"));\nconst i2 = tslib_1.__importStar(require(\"./amendment-history.service\"));\nconst i3 = tslib_1.__importStar(require(\"app/shared/service/ns2-http.service\"));\nconst i4 = tslib_1.__importStar(require(\"app/ng-connect\"));\nconst i5 = tslib_1.__importStar(require(\"app/core/util/export-utils.service\"));\nconst i6 = tslib_1.__importStar(require(\"app/core/util/date-utils.service\"));\nconst i7 = tslib_1.__importStar(require(\"@angular/forms\"));\nconst i8 = tslib_1.__importStar(require(\"primeng/api\"));\nconst i9 = tslib_1.__importStar(require(\"primeng/button\"));\nconst i10 = tslib_1.__importStar(require(\"primeng/tooltip\"));\nconst i11 = tslib_1.__importStar(require(\"primeng/table\"));\nconst i12 = tslib_1.__importStar(require(\"primeng/dialog\"));\nconst i13 = tslib_1.__importStar(require(\"primeng/calendar\"));\nconst i14 = tslib_1.__importStar(require(\"primeng/multiselect\"));\nconst i15 = tslib_1.__importStar(require(\"../admendment-snapshot/admendment-snapshot.component\"));\nconst i16 = tslib_1.__importStar(require(\"@angular/common\"));\nconst i17 = tslib_1.__importStar(require(\"./amendment-history.pipe\"));\nconst _c0 = [\"dt\"];\nfunction EPAmendmentHistoryComponent_ng_template_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n            \");\n    i0.ɵɵelementStart(1, \"div\", 10);\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementStart(3, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function EPAmendmentHistoryComponent_ng_template_12_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      const _r0 = i0.ɵɵreference(10);\n      return i0.ɵɵresetView(ctx_r5.exportCSV(_r0));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n        \");\n  }\n}\nfunction EPAmendmentHistoryComponent_ng_template_14_ng_template_27_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n                \");\n    i0.ɵɵelementStart(1, \"p-multiSelect\", 29);\n    i0.ɵɵlistener(\"onChange\", function EPAmendmentHistoryComponent_ng_template_14_ng_template_27_Template_p_multiSelect_onChange_1_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r12);\n      const filter_r10 = restoredCtx.filterCallback;\n      return i0.ɵɵresetView(filter_r10($event.value));\n    });\n    i0.ɵɵtext(2, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \"\\n            \");\n  }\n  if (rf & 2) {\n    const value_r9 = ctx.$implicit;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", value_r9)(\"options\", ctx_r7.amendmentTypeDropdownCodes);\n  }\n}\nfunction EPAmendmentHistoryComponent_ng_template_14_ng_template_37_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n                \");\n    i0.ɵɵelementStart(1, \"p-calendar\", 30);\n    i0.ɵɵlistener(\"onSelect\", function EPAmendmentHistoryComponent_ng_template_14_ng_template_37_Template_p_calendar_onSelect_1_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const filter_r14 = restoredCtx.filterCallback;\n      const ctx_r15 = i0.ɵɵnextContext(2);\n      const _r0 = i0.ɵɵreference(10);\n      return i0.ɵɵresetView(ctx_r15.dateCallbackFilter($event, filter_r14, \"amendmentDt\", _r0));\n    });\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \"\\n              \");\n  }\n  if (rf & 2) {\n    const value_r13 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", value_r13)(\"ngModel\", value_r13);\n  }\n}\nfunction EPAmendmentHistoryComponent_ng_template_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"th\", 12);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"th\", 13);\n    i0.ɵɵtext(7, \"CSN\");\n    i0.ɵɵelement(8, \"p-sortIcon\", 14);\n    i0.ɵɵtext(9, \"\\n            \");\n    i0.ɵɵelement(10, \"p-columnFilter\", 15);\n    i0.ɵɵtext(11, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n          \");\n    i0.ɵɵelementStart(13, \"th\", 16);\n    i0.ɵɵtext(14, \"Name\");\n    i0.ɵɵelement(15, \"p-sortIcon\", 17);\n    i0.ɵɵtext(16, \"\\n            \");\n    i0.ɵɵelement(17, \"p-columnFilter\", 18);\n    i0.ɵɵtext(18, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19, \"\\n          \");\n    i0.ɵɵelementStart(20, \"th\", 19);\n    i0.ɵɵtext(21, \"Type of Amendment\");\n    i0.ɵɵelement(22, \"p-sortIcon\", 20);\n    i0.ɵɵtext(23, \"\\n            \");\n    i0.ɵɵtext(24, \"\\n            \");\n    i0.ɵɵelementStart(25, \"p-columnFilter\", 21);\n    i0.ɵɵtext(26, \"\\n              \");\n    i0.ɵɵtemplate(27, EPAmendmentHistoryComponent_ng_template_14_ng_template_27_Template, 4, 2, \"ng-template\", 22);\n    i0.ɵɵtext(28, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(29, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(30, \"\\n          \");\n    i0.ɵɵelementStart(31, \"th\", 23);\n    i0.ɵɵtext(32, \"Last Updated\");\n    i0.ɵɵelement(33, \"p-sortIcon\", 24);\n    i0.ɵɵtext(34, \"\\n            \");\n    i0.ɵɵelementStart(35, \"p-columnFilter\", 25);\n    i0.ɵɵtext(36, \"\\n              \");\n    i0.ɵɵtemplate(37, EPAmendmentHistoryComponent_ng_template_14_ng_template_37_Template, 4, 2, \"ng-template\", 22);\n    i0.ɵɵtext(38, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(39, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(40, \"\\n          \");\n    i0.ɵɵelementStart(41, \"th\", 26);\n    i0.ɵɵtext(42, \"Last Updated By\");\n    i0.ɵɵelement(43, \"p-sortIcon\", 27);\n    i0.ɵɵtext(44, \"\\n            \");\n    i0.ɵɵelement(45, \"p-columnFilter\", 28);\n    i0.ɵɵtext(46, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(47, \"\\n          \");\n    i0.ɵɵelementStart(48, \"th\", 12);\n    i0.ɵɵtext(49, \"Snapshot\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(50, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(51, \"\\n      \");\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(25);\n    i0.ɵɵproperty(\"showMatchModes\", false)(\"showOperator\", false)(\"showAddButton\", false);\n  }\n}\nfunction EPAmendmentHistoryComponent_ng_template_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n          \");\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n          \");\n    i0.ɵɵelementStart(12, \"td\");\n    i0.ɵɵtext(13);\n    i0.ɵɵpipe(14, \"amendmentType\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15, \"\\n          \");\n    i0.ɵɵelementStart(16, \"td\");\n    i0.ɵɵtext(17);\n    i0.ɵɵpipe(18, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19, \"\\n          \");\n    i0.ɵɵelementStart(20, \"td\");\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(22, \"\\n          \");\n    i0.ɵɵelementStart(23, \"td\");\n    i0.ɵɵtext(24, \"\\n            \");\n    i0.ɵɵelementStart(25, \"p-button\", 31);\n    i0.ɵɵlistener(\"click\", function EPAmendmentHistoryComponent_ng_template_16_Template_p_button_click_25_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r20);\n      const row_r17 = restoredCtx.$implicit;\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.showSnapshot(row_r17.id));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(26, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(27, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(28, \"\\n      \");\n  }\n  if (rf & 2) {\n    const row_r17 = ctx.$implicit;\n    const i_r18 = ctx.rowIndex;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r18 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(row_r17.csn);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(row_r17.companyName);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(14, 6, row_r17.amendmentType));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(18, 8, row_r17.amendmentDt, \"dd/MM/yyy\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(row_r17.amendmentBy);\n  }\n}\nfunction EPAmendmentHistoryComponent_ng_template_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵelementStart(3, \"td\", 32);\n    i0.ɵɵtext(4, \"No records found.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n    \");\n  }\n}\nconst _c1 = function () {\n  return {\n    width: \"94vw\",\n    height: \"100vh\"\n  };\n};\nconst _c2 = function () {\n  return {\n    \"960px\": \"75vw\"\n  };\n};\nconst _c3 = function () {\n  return [10, 25, 50];\n};\nclass EPAmendmentHistoryComponent {\n  constructor(route, router, companyHistoryService, n2httpService, codeService, exportUtilsService, dateUtilsService, localeId) {\n    this.route = route;\n    this.router = router;\n    this.companyHistoryService = companyHistoryService;\n    this.n2httpService = n2httpService;\n    this.codeService = codeService;\n    this.exportUtilsService = exportUtilsService;\n    this.dateUtilsService = dateUtilsService;\n    this.localeId = localeId;\n    this.pageData = {\n      currentPage: 0\n    };\n    this.pageSize = 10;\n    this.showSnapshotDialog = false;\n  }\n  ngOnInit() {\n    console.log(\"loading amendment history\");\n    this.loadCode();\n  }\n  loadCode() {\n    this.codeService.gets('ADM_COY_HIST_AMEND_TYPE').subscribe(codes => {\n      this.amendmentTypeDropdownCodes = codes[0];\n    });\n  }\n  loadData(event) {\n    this.loading = true;\n    this.lazyLoadEvent = event;\n    setTimeout(() => {\n      const options = this.n2httpService.convertLazyEvent(event, this.pageData, this.pageSize);\n      this.companyHistoryService.getAll(options).subscribe(res => {\n        console.log(res);\n        this.amendmentHistory = res.body.data.content;\n        this.totalRecords = res.body.data.totalElements;\n        this.loading = false;\n      }, error => {\n        console.log(error.message);\n      });\n    }, 1000);\n  }\n  onPage(event) {\n    console.log(\"pageevent\", event);\n    this.pageSize = event.rows;\n    this.pageData.currentPage = event.first / event.rows;\n  }\n  exportCSV(dataTable) {\n    const options = this.n2httpService.convertLazyEvent(this.lazyLoadEvent, 0, this.totalRecords);\n    this.companyHistoryService.getAll(options).subscribe({\n      next: res => {\n        if (res.body?.data?.content) {\n          const data = res.body?.data?.content;\n          const columns = [{\n            field: 'sn',\n            header: 'SN',\n            index: 0\n          }, {\n            field: 'csn',\n            header: 'CSN',\n            index: 1\n          }, {\n            field: 'companyName',\n            header: 'Name',\n            index: 2\n          }, {\n            field: 'amendmentType',\n            header: 'Type of Amendment',\n            index: 3\n          }, {\n            field: 'amendmentDt',\n            header: 'Last Updated',\n            index: 4\n          }, {\n            field: 'amendmentBy',\n            header: 'Last Updated By',\n            index: 5\n          }];\n          const dtoList = [];\n          data.forEach((d, index) => {\n            dtoList.push({\n              sn: index + 1,\n              csn: d.csn,\n              companyName: d.companyName,\n              amendmentType: this.getLabelFromCode(d.amendmentType, this.amendmentTypeDropdownCodes),\n              amendmentDt: `${String(this.dateUtilsService.formatStrDate(d.amendmentDt, \"DD-MM-YYYY\"))} ${String(d.amendmentDt ? d.amendmentDt : \"\")}`,\n              amendmentBy: d.amendmentBy\n            });\n          });\n          this.exportUtilsService.exportCSV(dataTable, dtoList, res.body.data.total_no_of_elems, columns, \"data_\".concat((0, common_1.formatDate)(new Date(), \"dd-MM-YYYY\", this.localeId)));\n        }\n      },\n      error(error) {\n        console.log(error);\n        this.toastService.error(\"Failed to load history\");\n        this.loading = false;\n      }\n    });\n  }\n  showSnapshot(data) {\n    console.log(this.selectedId);\n    console.log(this.showSnapshotDialog);\n    console.log(\"----\");\n    this.selectedId = data;\n    this.showSnapshotDialog = true;\n    console.log(\"----\");\n    console.log(this.showSnapshotDialog);\n    console.log(\"====\");\n  }\n  dateCallbackFilter(input, filter, id, table) {\n    filter(new Date(input).toISOString());\n    //Patch back\n    const filterMetadata = table.filters[id];\n    filterMetadata[0].value = input;\n  }\n  getLabelFromCode(codeId, codeArray) {\n    const label = codeArray.find(c => c.codeId === codeId).label['en-US'];\n    return label;\n  }\n}\nexports.EPAmendmentHistoryComponent = EPAmendmentHistoryComponent;\nEPAmendmentHistoryComponent.ɵfac = function EPAmendmentHistoryComponent_Factory(t) {\n  return new (t || EPAmendmentHistoryComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.CompanyHistoryService), i0.ɵɵdirectiveInject(i3.Ns2HttpService), i0.ɵɵdirectiveInject(i4.IcCodeService), i0.ɵɵdirectiveInject(i5.ExportUtilsService), i0.ɵɵdirectiveInject(i6.DateUtilsService), i0.ɵɵdirectiveInject(core_1.LOCALE_ID));\n};\nEPAmendmentHistoryComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: EPAmendmentHistoryComponent,\n  selectors: [[\"n2-ep-amendment-history\"]],\n  viewQuery: function EPAmendmentHistoryComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.dataTable = _t.first);\n    }\n  },\n  features: [i0.ɵɵProvidersFeature([])],\n  decls: 23,\n  vars: 19,\n  consts: [[\"header\", \"Employer Details\", 3, \"breakpoints\", \"draggable\", \"resizable\", \"modal\", \"visible\", \"visibleChange\"], [3, \"companyHistoryId\"], [1, \"grid\"], [1, \"col-12\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"paginator\", \"rows\", \"lazy\", \"totalRecords\", \"loading\", \"showCurrentPageReport\", \"rowsPerPageOptions\", \"onLazyLoad\", \"onPage\"], [\"dt\", \"\"], [\"pTemplate\", \"caption\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"emptymessage\"], [1, \"p-d-flex\"], [\"type\", \"button\", \"pButton\", \"\", \"pRipple\", \"\", \"icon\", \"pi pi-file-o\", \"pTooltip\", \"CSV\", \"tooltipPosition\", \"bottom\", 3, \"click\"], [\"scope\", \"col\"], [\"scope\", \"col\", \"pSortableColumn\", \"csn\"], [\"field\", \"csn\"], [\"type\", \"text\", \"field\", \"csn\", \"display\", \"menu\", \"matchMode\", \"contains\"], [\"scope\", \"col\", \"pSortableColumn\", \"companyName\"], [\"field\", \"companyName\"], [\"type\", \"text\", \"field\", \"companyName\", \"display\", \"menu\", \"matchMode\", \"contains\"], [\"scope\", \"col\", \"pSortableColumn\", \"amendmentType\"], [\"field\", \"amendmentType\"], [\"field\", \"amendmentType\", \"matchMode\", \"in\", \"display\", \"menu\", 1, \"ml-auto\", 3, \"showMatchModes\", \"showOperator\", \"showAddButton\"], [\"pTemplate\", \"filter\"], [\"scope\", \"col\", \"pSortableColumn\", \"amendmentDt\"], [\"field\", \"amendmentDt\"], [\"field\", \"amendmentDt\", \"display\", \"menu\", \"matchMode\", \"contains\"], [\"scope\", \"col\", \"pSortableColumn\", \"amendmentBy\"], [\"field\", \"amendmentBy\"], [\"type\", \"text\", \"field\", \"amendmentBy\", \"display\", \"menu\", \"matchMode\", \"contains\"], [\"placeholder\", \"Any\", \"optionLabel\", \"label.en-US\", \"optionValue\", \"codeId\", 3, \"ngModel\", \"options\", \"onChange\"], [\"dataType\", \"string\", \"dateFormat\", \"dd/mm/yy\", 3, \"ngModel\", \"onSelect\"], [\"icon\", \"pi pi-search\", 3, \"click\"], [\"colspan\", \"12\"]],\n  template: function EPAmendmentHistoryComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"p-dialog\", 0);\n      i0.ɵɵlistener(\"visibleChange\", function EPAmendmentHistoryComponent_Template_p_dialog_visibleChange_0_listener($event) {\n        return ctx.showSnapshotDialog = $event;\n      });\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelement(2, \"n2-admendment-snapshot\", 1);\n      i0.ɵɵtext(3, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(4, \"\\n\\n\");\n      i0.ɵɵelementStart(5, \"div\", 2);\n      i0.ɵɵtext(6, \"\\n    \");\n      i0.ɵɵelementStart(7, \"div\", 3);\n      i0.ɵɵtext(8, \"\\n        \");\n      i0.ɵɵelementStart(9, \"p-table\", 4, 5);\n      i0.ɵɵlistener(\"onLazyLoad\", function EPAmendmentHistoryComponent_Template_p_table_onLazyLoad_9_listener($event) {\n        return ctx.loadData($event);\n      })(\"onPage\", function EPAmendmentHistoryComponent_Template_p_table_onPage_9_listener($event) {\n        return ctx.onPage($event);\n      });\n      i0.ɵɵtext(11, \"\\n        \");\n      i0.ɵɵtemplate(12, EPAmendmentHistoryComponent_ng_template_12_Template, 6, 0, \"ng-template\", 6);\n      i0.ɵɵtext(13, \"\\n        \");\n      i0.ɵɵtemplate(14, EPAmendmentHistoryComponent_ng_template_14_Template, 52, 3, \"ng-template\", 7);\n      i0.ɵɵtext(15, \"\\n      \");\n      i0.ɵɵtemplate(16, EPAmendmentHistoryComponent_ng_template_16_Template, 29, 11, \"ng-template\", 8);\n      i0.ɵɵtext(17, \"\\n      \");\n      i0.ɵɵtemplate(18, EPAmendmentHistoryComponent_ng_template_18_Template, 7, 0, \"ng-template\", 9);\n      i0.ɵɵtext(19, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(20, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(21, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(22, \"\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(16, _c1));\n      i0.ɵɵproperty(\"breakpoints\", i0.ɵɵpureFunction0(17, _c2))(\"draggable\", false)(\"resizable\", false)(\"modal\", true)(\"visible\", ctx.showSnapshotDialog);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"companyHistoryId\", ctx.selectedId);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"value\", ctx.amendmentHistory)(\"paginator\", true)(\"rows\", 10)(\"lazy\", true)(\"totalRecords\", ctx.totalRecords)(\"loading\", ctx.loading)(\"showCurrentPageReport\", true)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(18, _c3));\n    }\n  },\n  dependencies: [i7.NgControlStatus, i7.NgModel, i8.PrimeTemplate, i9.ButtonDirective, i9.Button, i10.Tooltip, i11.Table, i11.SortableColumn, i11.SortIcon, i11.ColumnFilter, i12.Dialog, i13.Calendar, i14.MultiSelect, i15.AdmendmentSnapshotComponent, i16.DatePipe, i17.AmendmentTypePipe],\n  styles: [\"[_nghost-%COMP%]     .p-dialog-mask {\\n  background-color: rgba(0, 0, 0, 0.4);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFtZW5kbWVudC1oaXN0b3J5LmNvbXBvbmVudC5zY3NzIiwiLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxccHJvamVjdHMlMjAyXFxuc3BheWlpYXBwXFxzcmNcXG1haW5cXHdlYmFwcFxcYXBwXFxhZG1pbmlzdHJhdGlvblxcZW1wbG95ZXItcHJvZmlsZVxcYW1lbmRtZW50LWhpc3RvcnlcXGFtZW5kbWVudC1oaXN0b3J5LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksb0NBQUE7QUNDSiIsImZpbGUiOiJhbWVuZG1lbnQtaGlzdG9yeS5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IDo6bmctZGVlcCAucC1kaWFsb2ctbWFzayB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwNjtcclxuICB9IiwiOmhvc3QgOjpuZy1kZWVwIC5wLWRpYWxvZy1tYXNrIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjQpO1xufSJdfQ== */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvYWRtaW5pc3RyYXRpb24vZW1wbG95ZXItcHJvZmlsZS9hbWVuZG1lbnQtaGlzdG9yeS9hbWVuZG1lbnQtaGlzdG9yeS5jb21wb25lbnQuc2NzcyIsIndlYnBhY2s6Ly8uLy4uLy4uL3Byb2plY3RzJTIwMi9uc3BheWlpYXBwL3NyYy9tYWluL3dlYmFwcC9hcHAvYWRtaW5pc3RyYXRpb24vZW1wbG95ZXItcHJvZmlsZS9hbWVuZG1lbnQtaGlzdG9yeS9hbWVuZG1lbnQtaGlzdG9yeS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLG9DQUFBO0FDQ0o7QURDQSx3c0JBQXdzQiIsInNvdXJjZXNDb250ZW50IjpbIjpob3N0IDo6bmctZGVlcCAucC1kaWFsb2ctbWFzayB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwNjtcclxuICB9IiwiOmhvc3QgOjpuZy1kZWVwIC5wLWRpYWxvZy1tYXNrIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjQpO1xufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","EPAmendmentHistoryComponent","constructor","route","router","companyHistoryService","n2httpService","codeService","exportUtilsService","dateUtilsService","localeId","currentPage","ngOnInit","console","log","loadCode","gets","subscribe","codes","amendmentTypeDropdownCodes","loadData","event","loading","lazyLoadEvent","setTimeout","options","convertLazyEvent","pageData","pageSize","getAll","res","amendmentHistory","body","data","content","totalRecords","totalElements","error","message","onPage","rows","first","exportCSV","dataTable","next","columns","field","header","index","dtoList","forEach","d","push","sn","csn","companyName","amendmentType","getLabelFromCode","amendmentDt","String","formatStrDate","amendmentBy","total_no_of_elems","concat","Date","toastService","showSnapshot","selectedId","showSnapshotDialog","dateCallbackFilter","input","filter","id","table","toISOString","filterMetadata","filters","value","codeId","codeArray","label","find","c","exports","core_1","selectors","viewQuery","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\administration\\employer-profile\\amendment-history\\amendment-history.component.ts","C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\administration\\employer-profile\\amendment-history\\amendment-history.component.html"],"sourcesContent":["import { CodeView, IcCodeService } from 'app/ng-connect';\r\nimport { Component, Inject, LOCALE_ID, OnInit, ViewChild } from '@angular/core';\r\nimport { Router, ActivatedRoute } from '@angular/router';\r\n\r\nimport { ICompanyHistory } from './amendment-history.model';\r\n\r\nimport { ExportUtilsService } from 'app/core/util/export-utils.service';\r\nimport { HttpResponse, HttpErrorResponse } from '@angular/common/http';\r\nimport { CompanyHistoryService } from './amendment-history.service';\r\nimport { FilterMetadata, LazyLoadEvent } from 'primeng/api';\r\nimport { Ns2HttpService } from 'app/shared/service/ns2-http.service';\r\nimport { Table } from 'primeng/table';\r\nimport { DateUtilsService } from 'app/core/util/date-utils.service';\r\nimport { formatDate } from '@angular/common';\r\nimport { Code } from 'app/admin/code-admin/code/code.model';\r\nimport { USE_EXTEND } from '@ngx-translate/core';\r\n\r\n@Component({\r\n  selector: 'n2-ep-amendment-history',\r\n  styleUrls: ['./amendment-history.component.scss'],\r\n  templateUrl: './amendment-history.component.html',\r\n  providers: []\r\n})\r\nexport class EPAmendmentHistoryComponent implements OnInit {\r\n\r\n  amendmentHistory : ICompanyHistory[];\r\n\r\n  // Lazy loading\r\n  totalRecords: number;\r\n  loading: boolean;\r\n  pageData: {currentPage: number} = {\r\n    currentPage: 0\r\n  }\r\n  pageSize = 10;\r\n  lazyLoadEvent: LazyLoadEvent;\r\n\r\n  showSnapshotDialog = false;\r\n  selectedId: string;\r\n\r\n  amendmentTypeDropdownCodes: CodeView[];\r\n  \r\n  @ViewChild('dt') dataTable: Table;\r\n\r\n  constructor(\r\n    private route:ActivatedRoute,\r\n    private router:Router,\r\n    private companyHistoryService: CompanyHistoryService,\r\n    private n2httpService: Ns2HttpService,\r\n    private codeService: IcCodeService,\r\n    private exportUtilsService: ExportUtilsService,\r\n    private dateUtilsService: DateUtilsService,\r\n    @Inject(LOCALE_ID) protected localeId: string\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    console.log(\"loading amendment history\");\r\n    this.loadCode();\r\n  }\r\n\r\n  loadCode(): void {\r\n    this.codeService.gets('ADM_COY_HIST_AMEND_TYPE')\r\n    .subscribe((codes: any[]) => {\r\n      this.amendmentTypeDropdownCodes = codes[0];\r\n    });\r\n  }\r\n  loadData(event: LazyLoadEvent): void {\r\n    this.loading =  true;\r\n    this.lazyLoadEvent = event;\r\n    setTimeout(() => {\r\n      const options = this.n2httpService.convertLazyEvent(event, this.pageData, this.pageSize);\r\n\r\n      this.companyHistoryService.getAll(options).subscribe(\r\n        (res : HttpResponse<any>) => {\r\n          console.log(res);\r\n          this.amendmentHistory = res.body.data.content;\r\n          this.totalRecords = res.body.data.totalElements;\r\n          this.loading = false;\r\n        },\r\n        (error: HttpErrorResponse) => {\r\n              console.log(error.message);\r\n        }\r\n      );\r\n    }, 1000);\r\n  }\r\n\r\n  onPage(event:any): void{\r\n    console.log(\"pageevent\", event);\r\n    this.pageSize = event.rows;\r\n    this.pageData.currentPage = event.first/event.rows;\r\n\r\n  }\r\n\r\n  exportCSV(dataTable: Table): void {\r\n    const options = this.n2httpService.convertLazyEvent(this.lazyLoadEvent, 0, this.totalRecords);\r\n\r\n    this.companyHistoryService.getAll(options).subscribe({\r\n      next: (res: HttpResponse<any>) => {\r\n        if(res.body?.data?.content) {\r\n\r\n          const data = res.body?.data?.content;\r\n\r\n          const columns = \r\n          [\r\n            {field: 'sn', header: 'SN', index: 0},\r\n            {field: 'csn', header: 'CSN', index: 1},\r\n            {field: 'companyName', header: 'Name', index: 2},\r\n            {field: 'amendmentType', header: 'Type of Amendment', index: 3},\r\n            {field: 'amendmentDt', header: 'Last Updated', index: 4},\r\n            {field: 'amendmentBy', header: 'Last Updated By', index: 5}\r\n          ];\r\n\r\n          const dtoList:any[] = [];\r\n          data.forEach((d: ICompanyHistory, index: number) => {\r\n            dtoList.push({\r\n              sn: index + 1,\r\n              csn: d.csn,\r\n              companyName: d.companyName,\r\n              amendmentType: this.getLabelFromCode(d.amendmentType, this.amendmentTypeDropdownCodes), \r\n              amendmentDt: `${String(this.dateUtilsService.formatStrDate(d.amendmentDt, \"DD-MM-YYYY\"))} ${String(d.amendmentDt ? d.amendmentDt : \"\")}`,\r\n              amendmentBy: d.amendmentBy\r\n            });\r\n          });\r\n          this.exportUtilsService.exportCSV(dataTable, dtoList,res.body.data.total_no_of_elems, columns, \r\n            \"data_\".concat(formatDate(new Date(),\"dd-MM-YYYY\", this.localeId)));\r\n        }\r\n      }, \r\n      error(error: HttpErrorResponse) {\r\n        console.log(error);\r\n        this.toastService.error(\"Failed to load history\");\r\n        this.loading=false;\r\n      }\r\n    });\r\n  }\r\n\r\n  showSnapshot(data: any): void {\r\n    console.log(this.selectedId);\r\n    console.log(this.showSnapshotDialog);\r\n    console.log(\"----\");\r\n    this.selectedId = data;\r\n    this.showSnapshotDialog = true;\r\n    console.log(\"----\");\r\n    console.log(this.showSnapshotDialog);\r\n    console.log(\"====\");\r\n  }\r\n\r\n  dateCallbackFilter(input: any, filter: (a: any) => void, id: string, table: Table): void {\r\n    filter(new Date(input).toISOString());\r\n\r\n    //Patch back\r\n    const filterMetadata = table.filters[id] as FilterMetadata[];\r\n    filterMetadata[0].value = input;\r\n  }\r\n\r\n  getLabelFromCode(codeId: string, codeArray: CodeView[], ): string {\r\n    const label: string = codeArray.find(c => c.codeId === codeId).label['en-US'];\r\n    return label;\r\n  }\r\n}\r\n","<p-dialog\r\n  header=\"Employer Details\"\r\n  [breakpoints]=\"{'960px':'75vw'}\"\r\n  [style]=\"{width: '94vw', height: '100vh'}\"\r\n  [draggable]=\"false\"\r\n  [resizable]=\"false\"\r\n  [modal]=\"true\"\r\n  [(visible)]=\"showSnapshotDialog\">\r\n  <n2-admendment-snapshot [companyHistoryId]=\"selectedId\"></n2-admendment-snapshot>\r\n</p-dialog>\r\n\r\n<div class=\"grid\">\r\n    <div class=\"col-12\">\r\n        <p-table #dt [value]=\"amendmentHistory\"\r\n             styleClass=\"p-datatable-gridlines\"\r\n             [paginator]=\"true\"\r\n             [rows]=\"10\"\r\n             [lazy]=\"true\"\r\n             (onLazyLoad)=\"loadData($event)\"\r\n             [totalRecords]=\"totalRecords\"\r\n             (onPage) = \"onPage($event)\"\r\n             [loading]=\"loading\"\r\n             [showCurrentPageReport]=\"true\"\r\n             currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} entries\"\r\n             [rowsPerPageOptions]=\"[10,25,50]\">\r\n        <ng-template pTemplate=\"caption\">\r\n            <div class=\"p-d-flex\">\r\n                <button type=\"button\" pButton pRipple icon=\"pi pi-file-o\" (click)=\"exportCSV(dt)\" pTooltip=\"CSV\" tooltipPosition=\"bottom\"></button>\r\n            </div>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"header\">\r\n        <tr>\r\n          <th scope=\"col\">SN</th>\r\n          <th scope=\"col\" pSortableColumn=\"csn\">CSN<p-sortIcon field=\"csn\"></p-sortIcon>\r\n            <p-columnFilter type=\"text\" field=\"csn\" display=\"menu\" matchMode=\"contains\"></p-columnFilter>\r\n          </th>\r\n          <th scope=\"col\" pSortableColumn=\"companyName\">Name<p-sortIcon field=\"companyName\"></p-sortIcon>\r\n            <p-columnFilter type=\"text\" field=\"companyName\" display=\"menu\" matchMode=\"contains\"></p-columnFilter>\r\n          </th>\r\n          <th scope=\"col\" pSortableColumn=\"amendmentType\">Type of Amendment<p-sortIcon field=\"amendmentType\"></p-sortIcon>\r\n            <!-- <p-columnFilter type=\"text\" field=\"amendmentType\" display=\"menu\" matchMode=\"contains\"></p-columnFilter> -->\r\n            <p-columnFilter field=\"amendmentType\" matchMode=\"in\" display=\"menu\" [showMatchModes]=\"false\"\r\n            [showOperator]=\"false\" [showAddButton]=\"false\" class=\"ml-auto\">\r\n              <ng-template pTemplate=\"filter\" let-value let-filter=\"filterCallback\" >\r\n                <p-multiSelect [ngModel]=\"value\" [options]=\"amendmentTypeDropdownCodes\" placeholder=\"Any\"\r\n                  (onChange)=\"filter($event.value)\" optionLabel=\"label.en-US\" optionValue=\"codeId\">\r\n              </p-multiSelect>\r\n            </ng-template>\r\n            </p-columnFilter>\r\n          </th>\r\n          <th scope=\"col\" pSortableColumn=\"amendmentDt\">Last Updated<p-sortIcon field=\"amendmentDt\"></p-sortIcon>\r\n            <p-columnFilter field=\"amendmentDt\" display=\"menu\" matchMode=\"contains\">\r\n              <ng-template pTemplate=\"filter\" let-value let-filter=\"filterCallback\">\r\n                <p-calendar dataType=\"string\" [ngModel]=\"value\" [ngModel]=\"value\" (onSelect)=\"dateCallbackFilter($event, filter, 'amendmentDt', dt)\" dateFormat=\"dd/mm/yy\">\r\n                </p-calendar>\r\n              </ng-template>\r\n            </p-columnFilter>\r\n          </th>\r\n          <th scope=\"col\" pSortableColumn=\"amendmentBy\">Last Updated By<p-sortIcon field=\"amendmentBy\"></p-sortIcon>\r\n            <p-columnFilter type=\"text\" field=\"amendmentBy\" display=\"menu\" matchMode=\"contains\"></p-columnFilter>\r\n          </th>\r\n          <th scope=\"col\">Snapshot</th>\r\n        </tr>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"body\" let-row let-i=\"rowIndex\">\r\n        <tr>\r\n          <td>{{i+1}}</td>\r\n          <td>{{row.csn}}</td>\r\n          <td>{{row.companyName}}</td>\r\n          <td>{{row.amendmentType | amendmentType }}</td>\r\n          <td>{{row.amendmentDt | date: 'dd/MM/yyy'}}</td>\r\n          <td>{{row.amendmentBy}}</td>\r\n          <td>\r\n            <p-button icon=\"pi pi-search\" (click)=\"showSnapshot(row.id)\"></p-button>\r\n          </td>\r\n        </tr>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"emptymessage\">\r\n        <tr>\r\n            <td colspan=\"12\">No records found.</td>\r\n        </tr>\r\n    </ng-template>\r\n    </p-table>\r\n    </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}