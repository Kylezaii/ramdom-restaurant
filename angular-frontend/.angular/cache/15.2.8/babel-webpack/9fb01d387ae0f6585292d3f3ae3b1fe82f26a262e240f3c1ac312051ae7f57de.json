{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PublicHolidayComponent = void 0;\nconst tslib_1 = require(\"tslib\");\nconst core_1 = require(\"@angular/core\");\nconst common_1 = require(\"@angular/common\");\nconst forms_1 = require(\"@angular/forms\");\nconst nspay2_constants_1 = require(\"app/nspay2.constants\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"@angular/router\"));\nconst i2 = tslib_1.__importStar(require(\"@angular/forms\"));\nconst i3 = tslib_1.__importStar(require(\"./../../../shared/confirm/nsp-confirm.service\"));\nconst i4 = tslib_1.__importStar(require(\"primeng/api\"));\nconst i5 = tslib_1.__importStar(require(\"app/layouts/service/customtoast.service\"));\nconst i6 = tslib_1.__importStar(require(\"./service/public-holiday.service\"));\nconst i7 = tslib_1.__importStar(require(\"app/core/util/date-utils.service\"));\nconst i8 = tslib_1.__importStar(require(\"app/core/util/export-utils.service\"));\nconst i9 = tslib_1.__importStar(require(\"@angular/common\"));\nconst i10 = tslib_1.__importStar(require(\"primeng/button\"));\nconst i11 = tslib_1.__importStar(require(\"primeng/checkbox\"));\nconst i12 = tslib_1.__importStar(require(\"primeng/tooltip\"));\nconst i13 = tslib_1.__importStar(require(\"primeng/table\"));\nconst i14 = tslib_1.__importStar(require(\"primeng/dialog\"));\nconst i15 = tslib_1.__importStar(require(\"primeng/inputtextarea\"));\nconst i16 = tslib_1.__importStar(require(\"primeng/confirmpopup\"));\nconst i17 = tslib_1.__importStar(require(\"primeng/calendar\"));\nconst i18 = tslib_1.__importStar(require(\"../../../shared/status/status.pipe\"));\nfunction PublicHolidayComponent_span_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 17);\n    i0.ɵɵtext(1, \"Max length of 100 characters\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PublicHolidayComponent_span_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 17);\n    i0.ɵɵtext(1, \"Required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PublicHolidayComponent_ng_template_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n      \");\n    i0.ɵɵelementStart(1, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function PublicHolidayComponent_ng_template_31_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.displayDialog = false);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(2, \"\\n      \");\n    i0.ɵɵelement(3, \"p-confirmPopup\", 19);\n    i0.ɵɵtext(4, \"\\n      \");\n    i0.ɵɵelementStart(5, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function PublicHolidayComponent_ng_template_31_Template_button_click_5_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.confirmAdd($event, \"addConfirmPopup\"));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n    \");\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"disabled\", !ctx_r2.addDateForm.valid);\n  }\n}\nfunction PublicHolidayComponent_ng_template_39_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"div\", 21);\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function PublicHolidayComponent_ng_template_39_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      const _r3 = i0.ɵɵreference(37);\n      return i0.ɵɵresetView(ctx_r15.exportCSV(_r3));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"lowercase\");\n    i0.ɵɵpipe(6, \"status\");\n    i0.ɵɵpipe(7, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n      \");\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate4(\"\\n          YEAR \", ctx_r4.currentYear, \" (Last \", i0.ɵɵpipeBind1(5, 4, i0.ɵɵpipeBind1(6, 6, ctx_r4.latestCurrentYearDate == null ? null : ctx_r4.latestCurrentYearDate.status)), \" by \", ctx_r4.latestCurrentYearDate == null ? null : ctx_r4.latestCurrentYearDate.statusBy, \" on \", i0.ɵɵpipeBind2(7, 8, ctx_r4.latestCurrentYearDate == null ? null : ctx_r4.latestCurrentYearDate.statusDt, \"dd/MM/yyyy\"), \")\\n        \");\n  }\n}\nfunction PublicHolidayComponent_ng_template_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"th\", 23);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"th\", 24);\n    i0.ɵɵtext(7, \"Blackout Date \");\n    i0.ɵɵelement(8, \"p-sortIcon\", 25);\n    i0.ɵɵtext(9, \" \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n          \");\n    i0.ɵɵelementStart(11, \"th\", 26);\n    i0.ɵɵtext(12, \"Remarks \");\n    i0.ɵɵelement(13, \"p-sortIcon\", 27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n          \");\n    i0.ɵɵelementStart(15, \"th\", 23);\n    i0.ɵɵtext(16, \"Validity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n      \");\n  }\n}\nfunction PublicHolidayComponent_ng_template_43_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n          \");\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14, \"\\n            \");\n    i0.ɵɵelementStart(15, \"p-checkbox\", 28);\n    i0.ɵɵlistener(\"ngModelChange\", function PublicHolidayComponent_ng_template_43_Template_p_checkbox_ngModelChange_15_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r20);\n      const data_r17 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(data_r17.validityBool = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n      \");\n  }\n  if (rf & 2) {\n    const data_r17 = ctx.$implicit;\n    const i_r18 = ctx.rowIndex;\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r18 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 6, data_r17.holidayDateInit, \"dd-MM-yyyy\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(data_r17.remarks);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", data_r17.validityBool)(\"binary\", true)(\"disabled\", ctx_r6.disablePending);\n  }\n}\nfunction PublicHolidayComponent_ng_template_52_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"div\", 21);\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function PublicHolidayComponent_ng_template_52_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext();\n      const _r7 = i0.ɵɵreference(50);\n      return i0.ɵɵresetView(ctx_r21.exportCSV(_r7));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"lowercase\");\n    i0.ɵɵpipe(6, \"status\");\n    i0.ɵɵpipe(7, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n      \");\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate4(\"\\n          YEAR \", ctx_r8.nextYear, \" (Last \", i0.ɵɵpipeBind1(5, 4, i0.ɵɵpipeBind1(6, 6, ctx_r8.latestNextYearDate == null ? null : ctx_r8.latestNextYearDate.status)), \" by \", ctx_r8.latestNextYearDate == null ? null : ctx_r8.latestNextYearDate.statusBy, \" on \", i0.ɵɵpipeBind2(7, 8, ctx_r8.latestNextYearDate == null ? null : ctx_r8.latestNextYearDate.statusDt, \"dd/MM/yyyy\"), \")\\n        \");\n  }\n}\nfunction PublicHolidayComponent_ng_template_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"th\", 23);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"th\", 24);\n    i0.ɵɵtext(7, \"Blackout Date \");\n    i0.ɵɵelement(8, \"p-sortIcon\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \" \\n          \");\n    i0.ɵɵelementStart(10, \"th\", 26);\n    i0.ɵɵtext(11, \"Remarks \");\n    i0.ɵɵelement(12, \"p-sortIcon\", 27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(13, \"\\n          \");\n    i0.ɵɵelementStart(14, \"th\", 23);\n    i0.ɵɵtext(15, \"Validity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n      \");\n  }\n}\nfunction PublicHolidayComponent_ng_template_56_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r26 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n          \");\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14, \"\\n            \");\n    i0.ɵɵelementStart(15, \"p-checkbox\", 28);\n    i0.ɵɵlistener(\"ngModelChange\", function PublicHolidayComponent_ng_template_56_Template_p_checkbox_ngModelChange_15_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r26);\n      const data_r23 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(data_r23.validityBool = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n      \");\n  }\n  if (rf & 2) {\n    const data_r23 = ctx.$implicit;\n    const i_r24 = ctx.rowIndex;\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r24 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 6, data_r23.holidayDateInit, \"dd-MM-yyyy\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(data_r23.remarks);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", data_r23.validityBool)(\"binary\", true)(\"disabled\", ctx_r10.disablePending);\n  }\n}\nfunction PublicHolidayComponent_div_61_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵtext(1, \"\\n  \");\n    i0.ɵɵelementStart(2, \"div\");\n    i0.ɵɵtext(3, \"\\n    \");\n    i0.ɵɵelementStart(4, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function PublicHolidayComponent_div_61_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r27.showAddDialog());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n    \");\n    i0.ɵɵelementStart(6, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function PublicHolidayComponent_div_61_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r29 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r29.reset());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n    \");\n    i0.ɵɵelement(8, \"p-confirmPopup\", 31);\n    i0.ɵɵtext(9, \"\\n    \");\n    i0.ɵɵelementStart(10, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function PublicHolidayComponent_div_61_Template_button_click_10_listener($event) {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r30 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r30.confirm($event, \"submitConfirmPopup\"));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n  \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function () {\n  return {\n    width: \"40%\"\n  };\n};\nconst _c1 = function () {\n  return [10, 25, 50];\n};\nclass PublicHolidayComponent {\n  constructor(router, formBuilder, nspConfirmService, messageService, toastService, publicHolidayService, dateUtilsService, exportUtilsService, localeId) {\n    this.router = router;\n    this.formBuilder = formBuilder;\n    this.nspConfirmService = nspConfirmService;\n    this.messageService = messageService;\n    this.toastService = toastService;\n    this.publicHolidayService = publicHolidayService;\n    this.dateUtilsService = dateUtilsService;\n    this.exportUtilsService = exportUtilsService;\n    this.localeId = localeId;\n    this.myNSPAY2_STATUS = nspay2_constants_1.NSPAY2_STATUS;\n    this.hasData = false;\n    this.displayDialog = false;\n    this.disablePending = false;\n    this.publicHolidayList = [];\n    this.requestList = [];\n    this.currentYearDates = [];\n    this.nextYearDates = [];\n    this.latestCurrentYearDate = {};\n    this.latestNextYearDate = {};\n    this.currentYearDatesForm = [];\n    this.nextYearDatesForm = [];\n    this.addDateForm = new forms_1.FormGroup({\n      date: new forms_1.FormControl(null, forms_1.Validators.required),\n      remarks: new forms_1.FormControl(null, [forms_1.Validators.required, forms_1.Validators.maxLength(100)])\n    });\n    this.currentYear = new Date().getFullYear();\n    this.nextYear = this.currentYear + 1;\n    this.minDate = new Date();\n    this.maxDate = new Date();\n  }\n  ngOnInit() {\n    this.currentYear = new Date().getFullYear();\n    this.nextYear = this.currentYear + 1;\n    const today = new Date();\n    this.minDate = new Date();\n    this.maxDate = new Date();\n    this.minDate.setDate(today.getDate() + 1);\n    this.maxDate.setFullYear(this.nextYear, 11, 31);\n    this.publicHolidayService.getCurrent().subscribe(res => {\n      this.mapResponse(res.body.data);\n      this.copyDataToForm();\n    }, error => {\n      console.log(error.message);\n    });\n  }\n  showAddDialog() {\n    this.displayDialog = true;\n  }\n  mapResponse(resBody) {\n    const data = resBody;\n    this.publicHolidayList = data;\n    if (Object.keys(this.publicHolidayList).length > 0) {\n      this.hasData = true;\n      console.log(\"not empty\");\n      // Convert to date\n      this.publicHolidayList.forEach(d => {\n        d.holidayDateInit = new Date(d.holidayDate);\n        d.validityBool = d.validity === 'Y';\n        // Disable if there is at least 1 record pensding approval\n        if (d.status === nspay2_constants_1.NSPAY2_STATUS.PENDING_APPROVAL) {\n          this.disablePending = true;\n        }\n      });\n      this.currentYearDates = this.publicHolidayList.filter(d => d.holidayDateInit?.getFullYear() === this.currentYear);\n      if (this.currentYearDates.length > 0) {\n        this.latestCurrentYearDate = this.currentYearDates.reduce(function (b, a) {\n          return b.statusDt > a.statusDt ? b : a;\n        });\n      }\n      this.nextYearDates = this.publicHolidayList.filter(d => d.holidayDateInit?.getFullYear() === this.nextYear);\n      if (this.nextYearDates.length > 0) {\n        this.latestNextYearDate = this.nextYearDates.reduce(function (b, a) {\n          return b.statusDt > a.statusDt ? b : a;\n        });\n      }\n      // }\n    }\n  }\n\n  copyDataToForm() {\n    this.currentYearDatesForm = [];\n    this.currentYearDates.forEach(val => this.currentYearDatesForm.push(Object.assign({}, val)));\n    this.nextYearDatesForm = [];\n    this.nextYearDates.forEach(val => this.nextYearDatesForm.push(Object.assign({}, val)));\n  }\n  prepareDataForRequest() {\n    // copy form to data\n    this.currentYearDates = this.currentYearDatesForm;\n    this.nextYearDates = this.nextYearDatesForm;\n    const combinedDateList = [];\n    this.currentYearDates.forEach(val => {\n      val.validity = val.validityBool ? 'Y' : 'N';\n      delete val.validityBool;\n      combinedDateList.push(Object.assign({}, val));\n    });\n    this.nextYearDates.forEach(val => {\n      val.validity = val.validityBool ? 'Y' : 'N';\n      delete val.validityBool;\n      combinedDateList.push(Object.assign({}, val));\n    });\n  }\n  pushChangesToRequestList() {\n    this.currentYearDatesForm.forEach(val => {\n      // if user changed to false, original is always true\n      if (!val.validityBool) {\n        val.validity = 'N';\n        this.requestList.push(val);\n      }\n    });\n    this.nextYearDatesForm.forEach(val => {\n      if (!val.validityBool) {\n        val.validity = 'N';\n        this.requestList.push(val);\n      }\n    });\n  }\n  confirm(event, key) {\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\n      this.pushChangesToRequestList();\n      this.submitRequest();\n    });\n  }\n  confirmAdd(event, key) {\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\n      this.displayDialog = false;\n      this.addDate();\n    });\n  }\n  addDate() {\n    const formValue = this.addDateForm.value;\n    const newDate = formValue.date;\n    const remarks = formValue.remarks;\n    const newHolidayDate = {};\n    newHolidayDate.holidayDateInit = newDate;\n    newHolidayDate.holidayDate = (0, common_1.formatDate)(newDate, \"YYYY-MM-dd\", this.localeId);\n    newHolidayDate.remarks = remarks;\n    newHolidayDate.validity = 'Y';\n    newHolidayDate.validityBool = true;\n    if (newDate.getFullYear() === this.currentYear) {\n      this.currentYearDatesForm.push(newHolidayDate);\n      this.requestList.push(newHolidayDate);\n    } else if (newDate.getFullYear() === this.nextYear) {\n      this.nextYearDatesForm.push(newHolidayDate);\n      this.requestList.push(newHolidayDate);\n    } else {\n      this.toastService.add({\n        severity: 'error',\n        summary: 'Invalid Year',\n        detail: \"Failed to add new date as year out of range\"\n      });\n    }\n    console.log(\"currentYearDatesForm\", this.currentYearDatesForm);\n    console.log(\"requestList\", this.requestList);\n    this.addDateForm.reset();\n  }\n  submitRequest() {\n    if (this.requestList.length > 0) {\n      console.log(\"requestList\", this.requestList);\n      this.publicHolidayService.createUpdate(this.requestList).subscribe(res => {\n        console.log(res.body);\n        this.toastService.success(\"Public holidays submitted for approval\");\n        this.refreshComponent();\n      }, error => {\n        console.log(error.message);\n        this.toastService.error(error.message);\n      });\n    } else {\n      this.toastService.error(\"No changes made\");\n    }\n  }\n  reset() {\n    this.copyDataToForm();\n  }\n  exportCSV(dataTable) {\n    const data = dataTable._value;\n    const columns = [{\n      field: 'sn',\n      header: 'SN',\n      index: 0\n    }, {\n      field: 'payrollDate',\n      header: 'Blackout Date',\n      index: 1\n    }, {\n      field: 'remarks',\n      header: 'Remarks',\n      index: 2\n    }, {\n      field: 'validity',\n      header: 'Validity',\n      index: 3\n    }];\n    const dtoList = [];\n    console.log(\"data\", data);\n    data.forEach((d, index) => {\n      const dto = {\n        sn: index + 1,\n        payrollDate: this.dateUtilsService.convertDateToStr(d.holidayDateInit, 'DD-MM-YYYY'),\n        remarks: d.remarks,\n        validity: d.validity\n      };\n      dtoList.push(dto);\n    });\n    this.exportUtilsService.exportCSV(dataTable, dtoList, data.length, columns, \"data_\".concat((0, common_1.formatDate)(new Date(), \"dd-MM-YYYY\", this.localeId)));\n  }\n  refreshComponent() {\n    const currentRoute = this.router.url;\n    this.router.navigateByUrl('/', {\n      skipLocationChange: true\n    }).then(() => {\n      this.router.navigate([currentRoute]);\n    });\n  }\n}\nexports.PublicHolidayComponent = PublicHolidayComponent;\nPublicHolidayComponent.ɵfac = function PublicHolidayComponent_Factory(t) {\n  return new (t || PublicHolidayComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.NspConfirmationService), i0.ɵɵdirectiveInject(i4.MessageService), i0.ɵɵdirectiveInject(i5.CustomToastService), i0.ɵɵdirectiveInject(i6.PublicHolidayService), i0.ɵɵdirectiveInject(i7.DateUtilsService), i0.ɵɵdirectiveInject(i8.ExportUtilsService), i0.ɵɵdirectiveInject(core_1.LOCALE_ID));\n};\nPublicHolidayComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PublicHolidayComponent,\n  selectors: [[\"n2-public-holiday\"]],\n  decls: 63,\n  vars: 25,\n  consts: [[1, \"grid\"], [\"header\", \"New Public Holiday\", 3, \"visible\", \"draggable\", \"resizable\", \"visibleChange\"], [3, \"formGroup\"], [1, \"field\", \"grid\"], [1, \"col\"], [\"id\", \"inputDate\", \"formControlName\", \"date\", \"dateFormat\", \"dd-mm-yy\", \"placeholder\", \"Select a date\", \"appendTo\", \"body\", 1, \"inputfield\", \"w-full\", 3, \"readonlyInput\", \"minDate\", \"maxDate\"], [\"pInputTextarea\", \"\", \"formControlName\", \"remarks\", \"type\", \"text\", \"rows\", \"5\", 1, \"inputfield\", \"w-full\"], [\"class\", \"p-error\", 4, \"ngIf\"], [\"pTemplate\", \"footer\"], [1, \"col-6\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"paginator\", \"rows\", \"showCurrentPageReport\", \"rowsPerPageOptions\"], [\"dt\", \"\"], [\"pTemplate\", \"caption\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"dt2\", \"\"], [\"class\", \"flex justify-content-end align-items-center\", 4, \"ngIf\"], [1, \"p-error\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Cancel\", 1, \"p-button-danger\", 3, \"click\"], [\"key\", \"addConfirmPopup\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Add Date\", 3, \"disabled\", \"click\"], [1, \"flex\", \"align-items-center\"], [\"type\", \"button\", \"pButton\", \"\", \"pRipple\", \"\", \"icon\", \"pi pi-file\", \"pTooltip\", \"CSV\", 1, \"mr-2\", 3, \"click\"], [\"scope\", \"col\"], [\"scope\", \"col\", \"pSortableColumn\", \"holidayDateInit\"], [\"field\", \"holidayDateInit\"], [\"scope\", \"col\", \"pSortableColumn\", \"remarks\"], [\"field\", \"remarks\"], [3, \"ngModel\", \"binary\", \"disabled\", \"ngModelChange\"], [1, \"flex\", \"justify-content-end\", \"align-items-center\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Add Date\", 1, \"p-button-secondary\", 3, \"click\"], [\"key\", \"submitConfirmPopup\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Submit\", 3, \"click\"]],\n  template: function PublicHolidayComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelementStart(2, \"p-dialog\", 1);\n      i0.ɵɵlistener(\"visibleChange\", function PublicHolidayComponent_Template_p_dialog_visibleChange_2_listener($event) {\n        return ctx.displayDialog = $event;\n      });\n      i0.ɵɵtext(3, \"\\n    \");\n      i0.ɵɵelementStart(4, \"form\", 2);\n      i0.ɵɵtext(5, \"\\n      \");\n      i0.ɵɵelementStart(6, \"div\", 3);\n      i0.ɵɵtext(7, \"\\n        \");\n      i0.ɵɵelementStart(8, \"div\", 4);\n      i0.ɵɵtext(9, \"\\n          \");\n      i0.ɵɵelementStart(10, \"p-calendar\", 5);\n      i0.ɵɵtext(11, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(12, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(13, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(14, \"\\n\\n      \");\n      i0.ɵɵelementStart(15, \"h6\");\n      i0.ɵɵtext(16, \"Remarks\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(17, \"\\n      \");\n      i0.ɵɵelementStart(18, \"div\", 3);\n      i0.ɵɵtext(19, \"\\n        \");\n      i0.ɵɵelementStart(20, \"div\", 4);\n      i0.ɵɵtext(21, \"\\n              \");\n      i0.ɵɵelement(22, \"textarea\", 6);\n      i0.ɵɵtext(23, \"\\n          \");\n      i0.ɵɵtemplate(24, PublicHolidayComponent_span_24_Template, 2, 0, \"span\", 7);\n      i0.ɵɵtext(25, \"\\n          \");\n      i0.ɵɵtemplate(26, PublicHolidayComponent_span_26_Template, 2, 0, \"span\", 7);\n      i0.ɵɵtext(27, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(28, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(29, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(30, \"\\n\\n    \");\n      i0.ɵɵtemplate(31, PublicHolidayComponent_ng_template_31_Template, 7, 1, \"ng-template\", 8);\n      i0.ɵɵtext(32, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(33, \"\\n\\n  \");\n      i0.ɵɵelementStart(34, \"div\", 9);\n      i0.ɵɵtext(35, \"\\n    \");\n      i0.ɵɵelementStart(36, \"p-table\", 10, 11);\n      i0.ɵɵtext(38, \"\\n      \");\n      i0.ɵɵtemplate(39, PublicHolidayComponent_ng_template_39_Template, 9, 11, \"ng-template\", 12);\n      i0.ɵɵtext(40, \"\\n      \");\n      i0.ɵɵtemplate(41, PublicHolidayComponent_ng_template_41_Template, 19, 0, \"ng-template\", 13);\n      i0.ɵɵtext(42, \"\\n      \");\n      i0.ɵɵtemplate(43, PublicHolidayComponent_ng_template_43_Template, 19, 9, \"ng-template\", 14);\n      i0.ɵɵtext(44, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(45, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(46, \"\\n\\n  \");\n      i0.ɵɵelementStart(47, \"div\", 9);\n      i0.ɵɵtext(48, \"\\n    \");\n      i0.ɵɵelementStart(49, \"p-table\", 10, 15);\n      i0.ɵɵtext(51, \"\\n      \");\n      i0.ɵɵtemplate(52, PublicHolidayComponent_ng_template_52_Template, 9, 11, \"ng-template\", 12);\n      i0.ɵɵtext(53, \"\\n      \");\n      i0.ɵɵtemplate(54, PublicHolidayComponent_ng_template_54_Template, 18, 0, \"ng-template\", 13);\n      i0.ɵɵtext(55, \"\\n      \");\n      i0.ɵɵtemplate(56, PublicHolidayComponent_ng_template_56_Template, 19, 9, \"ng-template\", 14);\n      i0.ɵɵtext(57, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(58, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(59, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(60, \"\\n\\n\");\n      i0.ɵɵtemplate(61, PublicHolidayComponent_div_61_Template, 13, 0, \"div\", 16);\n      i0.ɵɵtext(62, \"\\n\\n\");\n    }\n    if (rf & 2) {\n      let tmp_8_0;\n      let tmp_9_0;\n      i0.ɵɵadvance(2);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(22, _c0));\n      i0.ɵɵproperty(\"visible\", ctx.displayDialog)(\"draggable\", false)(\"resizable\", false);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"formGroup\", ctx.addDateForm);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"readonlyInput\", true)(\"minDate\", ctx.minDate)(\"maxDate\", ctx.maxDate);\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"ngIf\", (tmp_8_0 = ctx.addDateForm.get(\"remarks\")) == null ? null : tmp_8_0.hasError(\"maxlength\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ((tmp_9_0 = ctx.addDateForm.get(\"remarks\")) == null ? null : tmp_9_0.hasError(\"required\")) && ((tmp_9_0 = ctx.addDateForm.get(\"remarks\")) == null ? null : tmp_9_0.dirty));\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"value\", ctx.currentYearDatesForm)(\"paginator\", true)(\"rows\", 10)(\"showCurrentPageReport\", true)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(23, _c1));\n      i0.ɵɵadvance(13);\n      i0.ɵɵproperty(\"value\", ctx.nextYearDatesForm)(\"paginator\", true)(\"rows\", 10)(\"showCurrentPageReport\", true)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(24, _c1));\n      i0.ɵɵadvance(12);\n      i0.ɵɵproperty(\"ngIf\", !ctx.disablePending);\n    }\n  },\n  dependencies: [i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.NgModel, i9.NgIf, i2.FormGroupDirective, i2.FormControlName, i4.PrimeTemplate, i10.ButtonDirective, i11.Checkbox, i12.Tooltip, i13.Table, i13.SortableColumn, i13.SortIcon, i14.Dialog, i15.InputTextarea, i16.ConfirmPopup, i17.Calendar, i9.LowerCasePipe, i9.DatePipe, i18.StatusPipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwdWJsaWMtaG9saWRheS5jb21wb25lbnQuY3NzIn0= */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvYWRtaW5pc3RyYXRpb24vYmxhY2stb3V0LWRhdGUvcHVibGljLWhvbGlkYXkvcHVibGljLWhvbGlkYXkuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0EsNEtBQTRLIiwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","PublicHolidayComponent","constructor","router","formBuilder","nspConfirmService","messageService","toastService","publicHolidayService","dateUtilsService","exportUtilsService","localeId","nspay2_constants_1","forms_1","date","required","remarks","maxLength","currentYear","Date","getFullYear","nextYear","minDate","maxDate","ngOnInit","today","setDate","getDate","setFullYear","getCurrent","subscribe","res","mapResponse","body","data","copyDataToForm","error","console","log","message","showAddDialog","displayDialog","resBody","publicHolidayList","Object","keys","length","hasData","forEach","d","holidayDateInit","holidayDate","validityBool","validity","status","PENDING_APPROVAL","disablePending","currentYearDates","filter","latestCurrentYearDate","reduce","b","a","statusDt","nextYearDates","latestNextYearDate","currentYearDatesForm","val","push","assign","nextYearDatesForm","prepareDataForRequest","combinedDateList","pushChangesToRequestList","requestList","confirm","event","key","onConfirmPopup","submitRequest","confirmAdd","addDate","formValue","addDateForm","value","newDate","newHolidayDate","add","severity","summary","detail","reset","createUpdate","success","refreshComponent","exportCSV","dataTable","_value","columns","field","header","index","dtoList","dto","sn","payrollDate","convertDateToStr","concat","currentRoute","url","navigateByUrl","skipLocationChange","then","navigate","exports","core_1","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\administration\\black-out-date\\public-holiday\\public-holiday.component.ts","C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\administration\\black-out-date\\public-holiday\\public-holiday.component.html"],"sourcesContent":["import { NspConfirmationService } from './../../../shared/confirm/nsp-confirm.service';\r\nimport {Component, Inject,  LOCALE_ID, OnInit} from '@angular/core';\r\nimport {Router} from '@angular/router';\r\nimport {formatDate} from \"@angular/common\";\r\n\r\nimport {FormBuilder, FormControl, FormGroup, Validators} from '@angular/forms';\r\nimport {HttpErrorResponse, HttpResponse} from '@angular/common/http';\r\nimport {MessageService} from 'primeng/api';\r\nimport {CustomToastService} from 'app/layouts/service/customtoast.service';\r\nimport {PublicHolidayService} from './service/public-holiday.service';\r\nimport {IPublicHoliday} from './public-holiday.model';\r\nimport {NSPAY2_STATUS} from 'app/nspay2.constants';\r\nimport { DateUtilsService } from 'app/core/util/date-utils.service';\r\nimport { ExportUtilsService } from 'app/core/util/export-utils.service';\r\nimport { Table } from 'primeng/table';\r\n@Component({\r\n  selector: 'n2-public-holiday',\r\n  templateUrl: './public-holiday.component.html',\r\n  styleUrls: ['./public-holiday.component.css']\r\n})\r\nexport class PublicHolidayComponent implements OnInit {\r\n\r\n  readonly myNSPAY2_STATUS = NSPAY2_STATUS;\r\n\r\n  hasData = false;\r\n  displayDialog = false;\r\n\r\n  currentYear: number;\r\n  nextYear: number;\r\n\r\n  minDate: Date;\r\n  maxDate: Date;\r\n\r\n  disablePending = false;\r\n\r\n  publicHolidayList: IPublicHoliday[] = [];\r\n  requestList: IPublicHoliday[] = [];\r\n\r\n  currentYearDates: IPublicHoliday[] = [];\r\n  nextYearDates: IPublicHoliday[] = [];\r\n\r\n  latestCurrentYearDate: IPublicHoliday = {};\r\n  latestNextYearDate: IPublicHoliday = {};\r\n\r\n  currentYearDatesForm: IPublicHoliday[] = [];\r\n  nextYearDatesForm: IPublicHoliday[] = [];\r\n\r\n  addDateForm: FormGroup = new FormGroup({\r\n    date: new FormControl(null, Validators.required),\r\n    remarks: new FormControl(null, [Validators.required, Validators.maxLength(100)])\r\n  });\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private formBuilder: FormBuilder,\r\n    private nspConfirmService: NspConfirmationService,\r\n    private messageService: MessageService,\r\n    private toastService: CustomToastService,\r\n    private publicHolidayService: PublicHolidayService,\r\n    private dateUtilsService: DateUtilsService,\r\n    private exportUtilsService: ExportUtilsService,\r\n    @Inject(LOCALE_ID) protected localeId: string\r\n  ) {\r\n    this.currentYear = new Date().getFullYear();\r\n    this.nextYear = this.currentYear + 1;\r\n    this.minDate = new Date();\r\n    this.maxDate = new Date();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.currentYear = new Date().getFullYear();\r\n    this.nextYear = this.currentYear + 1;\r\n    const today = new Date();\r\n\r\n    this.minDate = new Date();\r\n    this.maxDate = new Date();\r\n\r\n    this.minDate.setDate(today.getDate() + 1);\r\n    this.maxDate.setFullYear(this.nextYear, 11, 31);\r\n    this.publicHolidayService.getCurrent().subscribe(\r\n      (res: HttpResponse<any>) => {\r\n        this.mapResponse(res.body.data);\r\n        this.copyDataToForm();\r\n      },\r\n      (error: HttpErrorResponse) => {\r\n        console.log(error.message);\r\n      }\r\n    );\r\n  }\r\n\r\n  showAddDialog(): void {\r\n    this.displayDialog = true;\r\n  }\r\n\r\n  mapResponse(resBody: any): void {\r\n    const data: IPublicHoliday[] = resBody;\r\n    this.publicHolidayList = data;\r\n\r\n    if (Object.keys(this.publicHolidayList).length > 0) {\r\n      this.hasData = true\r\n      console.log(\"not empty\");\r\n\r\n      // Convert to date\r\n      this.publicHolidayList.forEach(d => {\r\n        d.holidayDateInit = new Date(d.holidayDate);\r\n        d.validityBool = d.validity === 'Y';\r\n\r\n        // Disable if there is at least 1 record pensding approval\r\n        if (d.status === NSPAY2_STATUS.PENDING_APPROVAL) {\r\n          this.disablePending = true;\r\n        }\r\n      });\r\n\r\n      this.currentYearDates = this.publicHolidayList.filter(d => d.holidayDateInit?.getFullYear() === this.currentYear);\r\n      if (this.currentYearDates.length > 0) {\r\n        this.latestCurrentYearDate = this.currentYearDates.reduce(function (b, a) {\r\n          return b.statusDt > a.statusDt ? b : a;\r\n        });\r\n      }\r\n\r\n      this.nextYearDates = this.publicHolidayList.filter(d => d.holidayDateInit?.getFullYear() === this.nextYear);\r\n      if (this.nextYearDates.length > 0) {\r\n        this.latestNextYearDate = this.nextYearDates.reduce(function (b, a) {\r\n          return b.statusDt > a.statusDt ? b : a;\r\n        });\r\n      }\r\n      // }\r\n    }\r\n  }\r\n\r\n  copyDataToForm(): void {\r\n    this.currentYearDatesForm = [];\r\n    this.currentYearDates.forEach(val => this.currentYearDatesForm.push(Object.assign({}, val)));\r\n\r\n    this.nextYearDatesForm = [];\r\n    this.nextYearDates.forEach(val => this.nextYearDatesForm.push(Object.assign({}, val)));\r\n  }\r\n\r\n  prepareDataForRequest(): void {\r\n    // copy form to data\r\n    this.currentYearDates = this.currentYearDatesForm;\r\n    this.nextYearDates = this.nextYearDatesForm;\r\n\r\n    const combinedDateList: IPublicHoliday[] = [];\r\n\r\n    this.currentYearDates.forEach(val => {\r\n      val.validity = val.validityBool ? 'Y' : 'N';\r\n      delete val.validityBool;\r\n      combinedDateList.push(Object.assign({}, val));\r\n    });\r\n\r\n    this.nextYearDates.forEach(val => {\r\n      val.validity = val.validityBool ? 'Y' : 'N';\r\n      delete val.validityBool;\r\n      combinedDateList.push(Object.assign({}, val))\r\n    });\r\n\r\n  }\r\n\r\n  pushChangesToRequestList(): void {\r\n    this.currentYearDatesForm.forEach(val => {\r\n      // if user changed to false, original is always true\r\n      if (!val.validityBool) {\r\n        val.validity = 'N'\r\n        this.requestList.push(val);\r\n      }\r\n    });\r\n\r\n    this.nextYearDatesForm.forEach(val => {\r\n      if (!val.validityBool) {\r\n        val.validity = 'N'\r\n        this.requestList.push(val);\r\n      }\r\n    });\r\n  }\r\n\r\n  confirm(event: Event, key: string): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\r\n      this.pushChangesToRequestList();\r\n      this.submitRequest();\r\n    });\r\n  }\r\n\r\n  confirmAdd(event: Event, key: string): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\r\n      this.displayDialog = false;\r\n      this.addDate();\r\n    });\r\n  }\r\n\r\n  addDate(): void {\r\n    const formValue = this.addDateForm.value;\r\n\r\n    const newDate: Date = formValue.date;\r\n    const remarks = formValue.remarks;\r\n    const newHolidayDate: IPublicHoliday = {};\r\n\r\n    newHolidayDate.holidayDateInit = newDate;\r\n    newHolidayDate.holidayDate = formatDate(newDate, \"YYYY-MM-dd\", this.localeId);\r\n    newHolidayDate.remarks = remarks;\r\n    newHolidayDate.validity = 'Y';\r\n    newHolidayDate.validityBool = true;\r\n\r\n    if (newDate.getFullYear() === this.currentYear) {\r\n      this.currentYearDatesForm.push(newHolidayDate);\r\n      this.requestList.push(newHolidayDate);\r\n    } else if (newDate.getFullYear() === this.nextYear) {\r\n      this.nextYearDatesForm.push(newHolidayDate);\r\n      this.requestList.push(newHolidayDate);\r\n    } else {\r\n      this.toastService.add({\r\n        severity: 'error',\r\n        summary: 'Invalid Year',\r\n        detail: \"Failed to add new date as year out of range\"\r\n      });\r\n    }\r\n\r\n    console.log(\"currentYearDatesForm\", this.currentYearDatesForm);\r\n    console.log(\"requestList\", this.requestList);\r\n    this.addDateForm.reset();\r\n  }\r\n\r\n  submitRequest(): void {\r\n    if (this.requestList.length > 0) {\r\n\r\n      console.log(\"requestList\", this.requestList);\r\n\r\n      this.publicHolidayService.createUpdate(this.requestList).subscribe(\r\n        (res: HttpResponse<any>) => {\r\n          console.log(res.body);\r\n          this.toastService.success(\"Public holidays submitted for approval\");\r\n          this.refreshComponent();\r\n        },\r\n        (error: HttpErrorResponse) => {\r\n          console.log(error.message);\r\n          this.toastService.error(error.message);\r\n        }\r\n      );\r\n    } else {\r\n      this.toastService.error(\"No changes made\");\r\n    }\r\n  }\r\n\r\n  reset(): void {\r\n    this.copyDataToForm();\r\n  }\r\n\r\n  exportCSV(dataTable: Table): void {\r\n    const data = dataTable._value;\r\n    const columns =[\r\n      {field: 'sn', header: 'SN', index: 0},\r\n      {field: 'payrollDate', header: 'Blackout Date', index: 1},\r\n      {field: 'remarks', header: 'Remarks', index: 2},\r\n      {field: 'validity', header: 'Validity', index: 3}\r\n    ]\r\n\r\n    const dtoList:any[] = [];\r\n    console.log(\"data\", data);\r\n    data.forEach((d: IPublicHoliday, index: number) => {\r\n      const dto = {\r\n        sn: index + 1,\r\n        payrollDate: this.dateUtilsService.convertDateToStr(d.holidayDateInit, 'DD-MM-YYYY'),\r\n        remarks: d.remarks,\r\n        validity: d.validity\r\n      }\r\n      dtoList.push(dto);\r\n    });\r\n    this.exportUtilsService.exportCSV(dataTable, dtoList, data.length, columns,\r\n      \"data_\".concat(formatDate(new Date(),\"dd-MM-YYYY\", this.localeId)));\r\n  }\r\n\r\n  protected refreshComponent(): void {\r\n    const currentRoute = this.router.url;\r\n\r\n    this.router.navigateByUrl('/', {skipLocationChange: true}).then(() => {\r\n      this.router.navigate([currentRoute]);\r\n    });\r\n  }\r\n}\r\n","<div class=\"grid\">\r\n  <p-dialog header=\"New Public Holiday\"\r\n          [(visible)]=\"displayDialog\"\r\n          [draggable]=\"false\"\r\n          [resizable]=\"false\"\r\n          [style]=\"{width: '40%'}\">\r\n    <form [formGroup]=\"addDateForm\">\r\n      <div class=\"field grid\">\r\n        <div class=\"col\">\r\n          <p-calendar id=\"inputDate\"\r\n                      formControlName=\"date\"\r\n                      dateFormat=\"dd-mm-yy\"\r\n                      [readonlyInput]=\"true\"\r\n                      [minDate]=\"minDate\"\r\n                      [maxDate]=\"maxDate\"\r\n                      placeholder=\"Select a date\"\r\n                      appendTo=\"body\"\r\n                      class=\"inputfield w-full\">\r\n          </p-calendar>\r\n        </div>\r\n      </div>\r\n\r\n      <h6>Remarks</h6>\r\n      <div class=\"field grid\">\r\n        <div class=\"col\">\r\n              <textarea pInputTextarea\r\n                        formControlName=\"remarks\"\r\n                        class=\"inputfield w-full\"\r\n                        type=\"text\"\r\n                        rows=\"5\"></textarea>\r\n          <span *ngIf=\"addDateForm.get('remarks')?.hasError('maxlength')\" class=\"p-error\">Max length of 100 characters</span>\r\n          <span *ngIf=\"addDateForm.get('remarks')?.hasError('required') && addDateForm.get('remarks')?.dirty\" class=\"p-error\">Required</span>\r\n        </div>\r\n      </div>\r\n    </form>\r\n\r\n    <ng-template pTemplate=\"footer\">\r\n      <button pButton type=\"button\" label=\"Cancel\" (click)=\"displayDialog = false\" class=\"p-button-danger\"></button>\r\n      <p-confirmPopup key='addConfirmPopup'></p-confirmPopup>\r\n      <button pButton type=\"button\" label=\"Add Date\" (click)=\"confirmAdd($event, 'addConfirmPopup')\" [disabled]=\"!addDateForm.valid\"></button>\r\n    </ng-template>\r\n  </p-dialog>\r\n\r\n  <div class=\"col-6\">\r\n    <p-table #dt [value]=\"currentYearDatesForm\"\r\n             styleClass=\"p-datatable-gridlines\"\r\n             [paginator]=\"true\"\r\n             [rows]=\"10\"\r\n             currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} entries\"\r\n             [showCurrentPageReport]=\"true\"\r\n             [rowsPerPageOptions]=\"[10,25,50]\">\r\n      <ng-template pTemplate=\"caption\">\r\n        <div class=\"flex align-items-center\">\r\n          <button type=\"button\" pButton pRipple icon=\"pi pi-file\" (click)=\"exportCSV(dt)\" class=\"mr-2\" pTooltip=\"CSV\"></button>\r\n          YEAR {{ currentYear }} (Last {{latestCurrentYearDate?.status! | status | lowercase}} by {{latestCurrentYearDate?.statusBy}} on {{latestCurrentYearDate?.statusDt | date: 'dd/MM/yyyy'}})\r\n        </div>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"header\">\r\n        <tr>\r\n          <th scope=\"col\">SN</th>\r\n          <th scope=\"col\" pSortableColumn=\"holidayDateInit\">Blackout Date <p-sortIcon field=\"holidayDateInit\"></p-sortIcon> </th>\r\n          <th scope=\"col\" pSortableColumn=\"remarks\">Remarks <p-sortIcon field=\"remarks\"></p-sortIcon></th>\r\n          <th scope=\"col\">Validity</th>\r\n        </tr>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"body\" let-data let-i=\"rowIndex\">\r\n        <tr>\r\n          <td>{{i+1}}</td>\r\n          <td>{{data.holidayDateInit | date: 'dd-MM-yyyy'}}</td>\r\n          <td>{{data.remarks}}</td>\r\n          <td>\r\n            <p-checkbox [(ngModel)]=\"data.validityBool\" [binary]=\"true\"\r\n              [disabled]=\"disablePending\"></p-checkbox>\r\n          </td>\r\n        </tr>\r\n      </ng-template>\r\n    </p-table>\r\n  </div>\r\n\r\n  <div class=\"col-6\">\r\n    <p-table #dt2 [value]=\"nextYearDatesForm\"\r\n             styleClass=\"p-datatable-gridlines\"\r\n             [paginator]=\"true\"\r\n             [rows]=\"10\"\r\n             currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} entries\"\r\n             [showCurrentPageReport]=\"true\"\r\n             [rowsPerPageOptions]=\"[10,25,50]\">\r\n      <ng-template pTemplate=\"caption\">\r\n        <div class=\"flex align-items-center\">\r\n          <button type=\"button\" pButton pRipple icon=\"pi pi-file\" (click)=\"exportCSV(dt2)\" class=\"mr-2\" pTooltip=\"CSV\"></button>\r\n          YEAR {{ nextYear }} (Last {{latestNextYearDate?.status! | status | lowercase}} by {{latestNextYearDate?.statusBy}} on {{latestNextYearDate?.statusDt | date: 'dd/MM/yyyy'}})\r\n        </div>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"header\">\r\n        <tr>\r\n          <th scope=\"col\">SN</th>\r\n          <th scope=\"col\" pSortableColumn=\"holidayDateInit\">Blackout Date <p-sortIcon field=\"holidayDateInit\"></p-sortIcon></th> \r\n          <th scope=\"col\" pSortableColumn=\"remarks\">Remarks <p-sortIcon field=\"remarks\"></p-sortIcon></th>\r\n          <th scope=\"col\">Validity</th>\r\n        </tr>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"body\" let-data let-i=\"rowIndex\">\r\n        <tr>\r\n          <td>{{i+1}}</td>\r\n          <td>{{data.holidayDateInit | date: 'dd-MM-yyyy'}}</td>\r\n          <td>{{data.remarks}}</td>\r\n          <td>\r\n            <p-checkbox [(ngModel)]=\"data.validityBool\" [binary]=\"true\"\r\n            [disabled]=\"disablePending\"></p-checkbox>\r\n          </td>\r\n        </tr>\r\n      </ng-template>\r\n    </p-table>\r\n  </div>\r\n</div>\r\n\r\n<div *ngIf=\"!disablePending\" class=\"flex justify-content-end align-items-center\">\r\n  <div>\r\n    <button pButton type=\"button\" label=\"Add Date\" (click)=\"showAddDialog()\" class=\"p-button-secondary\"></button>\r\n    <button pButton type=\"button\" label=\"Cancel\" (click)=\"reset()\" class=\"p-button-danger\"></button>\r\n    <p-confirmPopup key=\"submitConfirmPopup\"></p-confirmPopup>\r\n    <button pButton type=\"button\" label=\"Submit\" (click)=\"confirm($event, 'submitConfirmPopup')\"></button>\r\n  </div>\r\n</div>\r\n\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}