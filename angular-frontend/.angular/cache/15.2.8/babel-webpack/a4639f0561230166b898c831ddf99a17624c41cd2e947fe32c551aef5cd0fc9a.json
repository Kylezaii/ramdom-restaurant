{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MipsUploadApprovalComponent = void 0;\nconst tslib_1 = require(\"tslib\");\nconst core_1 = require(\"@angular/core\");\nconst forms_1 = require(\"@angular/forms\");\nconst fileupload2_directive_1 = require(\"app/shared/validator/fileupload2.directive\");\nconst common_1 = require(\"@angular/common\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"@angular/router\"));\nconst i2 = tslib_1.__importStar(require(\"app/shared/confirm/nsp-confirm.service\"));\nconst i3 = tslib_1.__importStar(require(\"../service/mips-upload.service\"));\nconst i4 = tslib_1.__importStar(require(\"app/core/util/date-utils.service\"));\nconst i5 = tslib_1.__importStar(require(\"app/core/util/export-utils.service\"));\nconst i6 = tslib_1.__importStar(require(\"app/layouts/service/customtoast.service\"));\nconst i7 = tslib_1.__importStar(require(\"@angular/forms\"));\nconst i8 = tslib_1.__importStar(require(\"@angular/common\"));\nconst i9 = tslib_1.__importStar(require(\"primeng/api\"));\nconst i10 = tslib_1.__importStar(require(\"primeng/button\"));\nconst i11 = tslib_1.__importStar(require(\"primeng/tooltip\"));\nconst i12 = tslib_1.__importStar(require(\"primeng/table\"));\nconst i13 = tslib_1.__importStar(require(\"primeng/confirmpopup\"));\nconst i14 = tslib_1.__importStar(require(\"../../../shared/component/file-upload/file-upload.component\"));\nconst i15 = tslib_1.__importStar(require(\"primeng/panel\"));\nconst i16 = tslib_1.__importStar(require(\"primeng/ripple\"));\nconst i17 = tslib_1.__importStar(require(\"../../../shared/pipe/default-string.pipe\"));\nconst _c0 = [\"mipsVerifyFileUpload\"];\nfunction MipsUploadApprovalComponent_p_table_6_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"div\", 0);\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"div\", 27);\n    i0.ɵɵtext(4, \"\\n            \");\n    i0.ɵɵelementStart(5, \"button\", 28);\n    i0.ɵɵlistener(\"click\", function MipsUploadApprovalComponent_p_table_6_ng_template_3_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r10);\n      i0.ɵɵnextContext();\n      const _r4 = i0.ɵɵreference(1);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.exportCSV(_r4));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n          \");\n    i0.ɵɵelementStart(8, \"div\", 29);\n    i0.ɵɵtext(9, \"MIPS Upload Pending Approval\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n        \");\n  }\n}\nfunction MipsUploadApprovalComponent_p_table_6_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"th\", 30);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"th\", 31);\n    i0.ɵɵtext(7, \"Uploaded By\\n            \");\n    i0.ɵɵelement(8, \"p-sortIcon\", 32);\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n          \");\n    i0.ɵɵelementStart(11, \"th\", 33);\n    i0.ɵɵtext(12, \"Name\\n            \");\n    i0.ɵɵelement(13, \"p-sortIcon\", 34);\n    i0.ɵɵtext(14, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15, \"\\n          \");\n    i0.ɵɵelementStart(16, \"th\", 35);\n    i0.ɵɵtext(17, \"MIPS ID\\n            \");\n    i0.ɵɵelement(18, \"p-sortIcon\", 36);\n    i0.ɵɵtext(19, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(20, \"\\n          \");\n    i0.ɵɵelementStart(21, \"th\", 37);\n    i0.ɵɵtext(22, \"Refund Amount\\n            \");\n    i0.ɵɵelement(23, \"p-sortIcon\", 38);\n    i0.ɵɵtext(24, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(25, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(26, \"\\n        \");\n  }\n}\nfunction MipsUploadApprovalComponent_p_table_6_ng_template_7_br_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"br\");\n  }\n}\nfunction MipsUploadApprovalComponent_p_table_6_ng_template_7_br_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"br\");\n  }\n}\nfunction MipsUploadApprovalComponent_p_table_6_ng_template_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"defaultString\");\n    i0.ɵɵtemplate(9, MipsUploadApprovalComponent_p_table_6_ng_template_7_br_9_Template, 1, 0, \"br\", 39);\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"defaultString\");\n    i0.ɵɵpipe(12, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(13, \"\\n          \");\n    i0.ɵɵelementStart(14, \"td\");\n    i0.ɵɵtext(15);\n    i0.ɵɵpipe(16, \"defaultString\");\n    i0.ɵɵtemplate(17, MipsUploadApprovalComponent_p_table_6_ng_template_7_br_17_Template, 1, 0, \"br\", 39);\n    i0.ɵɵtext(18);\n    i0.ɵɵpipe(19, \"defaultString\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(20, \"\\n          \");\n    i0.ɵɵelementStart(21, \"td\");\n    i0.ɵɵtext(22);\n    i0.ɵɵpipe(23, \"defaultString\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24, \"\\n          \");\n    i0.ɵɵelementStart(25, \"td\");\n    i0.ɵɵtext(26);\n    i0.ɵɵpipe(27, \"defaultString\");\n    i0.ɵɵpipe(28, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(29, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(30, \"\\n        \");\n  }\n  if (rf & 2) {\n    const mipsRecord_r11 = ctx.$implicit;\n    const i_r12 = ctx.rowIndex;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r12 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 9, ctx_r7.mipsUploadRecord.submittedBy));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r7.mipsUploadRecord.submittedBy);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(11, 11, i0.ɵɵpipeBind2(12, 13, ctx_r7.mipsUploadRecord.submittedDt, \"dd-MM-yyyy '('HHmm')'\")));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(16, 16, mipsRecord_r11.nric));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", mipsRecord_r11.nric);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(19, 18, mipsRecord_r11.name));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(23, 20, mipsRecord_r11.mipsId));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(27, 22, i0.ɵɵpipeBind3(28, 24, mipsRecord_r11.amount, \"SGD\", \"symbol-narrow\")));\n  }\n}\nfunction MipsUploadApprovalComponent_p_table_6_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"td\", 40);\n    i0.ɵɵtext(4, \"No pending approval MIPS Upload records found.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n        \");\n  }\n}\nconst _c1 = function () {\n  return [10, 25, 50];\n};\nfunction MipsUploadApprovalComponent_p_table_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p-table\", 21, 22);\n    i0.ɵɵtext(2, \"\\n        \");\n    i0.ɵɵtemplate(3, MipsUploadApprovalComponent_p_table_6_ng_template_3_Template, 12, 0, \"ng-template\", 23);\n    i0.ɵɵtext(4, \"\\n        \");\n    i0.ɵɵtemplate(5, MipsUploadApprovalComponent_p_table_6_ng_template_5_Template, 27, 0, \"ng-template\", 24);\n    i0.ɵɵtext(6, \"\\n\\n        \");\n    i0.ɵɵtemplate(7, MipsUploadApprovalComponent_p_table_6_ng_template_7_Template, 31, 28, \"ng-template\", 25);\n    i0.ɵɵtext(8, \"\\n\\n        \");\n    i0.ɵɵtemplate(9, MipsUploadApprovalComponent_p_table_6_ng_template_9_Template, 7, 0, \"ng-template\", 26);\n    i0.ɵɵtext(10, \"\\n      \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", ctx_r0.mipsUploadRecord == null ? null : ctx_r0.mipsUploadRecord.overpaymentMips)(\"paginator\", true)(\"rows\", 10)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(5, _c1))(\"showCurrentPageReport\", true);\n  }\n}\nfunction MipsUploadApprovalComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 41);\n    i0.ɵɵtext(1, \"\\n          \");\n    i0.ɵɵelementStart(2, \"div\");\n    i0.ɵɵtext(3, \"\\n            Please upload file for verification.\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"\\n          \");\n    i0.ɵɵelementStart(5, \"div\");\n    i0.ɵɵtext(6, \"\\n            File verification is required for approval.\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n        \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MipsUploadApprovalComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 41);\n    i0.ɵɵtext(1, \"\\n          \");\n    i0.ɵɵelementStart(2, \"div\");\n    i0.ɵɵtext(3, \"\\n            File Verified\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"\\n        \");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c2 = function () {\n  return {\n    \"justify-content\": \"end\"\n  };\n};\nconst _c3 = function () {\n  return {\n    \"margin-left\": \".5em\",\n    \"margin-bottom\": \".5em\"\n  };\n};\nclass MipsUploadApprovalComponent {\n  constructor(router, route, nspConfirmService, mipsService, dateUtilsService, exportUtilsService, toastService, fb, localeId) {\n    this.router = router;\n    this.route = route;\n    this.nspConfirmService = nspConfirmService;\n    this.mipsService = mipsService;\n    this.dateUtilsService = dateUtilsService;\n    this.exportUtilsService = exportUtilsService;\n    this.toastService = toastService;\n    this.fb = fb;\n    this.localeId = localeId;\n    this.mipsUploadRecord = {};\n    this.mipsFileRecordId = \"\";\n    this.isFileVerified = false;\n    this.loading = false;\n    //MIPS\n    this.fileUploadFileLimit = 1;\n    this.mipsVerifyFileUploadForm = this.fb.group({\n      file: new forms_1.FormControl([], [fileupload2_directive_1.FileUploadValidator2.maxFileLimit(this.fileUploadFileLimit), fileupload2_directive_1.FileUploadValidator2.allowableExtension(\".xls,.xlsx\")])\n    });\n  }\n  ngOnInit() {\n    this.route.queryParams.subscribe(params => {\n      this.mipsFileRecordId = params['id'];\n    });\n  }\n  loadMipsRecord() {\n    this.loading = true;\n    this.mipsService.getMipsFileRecord(this.mipsFileRecordId).subscribe(res => {\n      this.mipsUploadRecord = res.body?.data;\n      this.loading = false;\n    }, error => {\n      this.toastService.error(error.error?.error_desc);\n      this.loading = false;\n    });\n  }\n  onApprove(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\n      this.mipsService.approveMipsFileRecord(this.mipsFileRecordId, true).subscribe(res => {\n        this.toastService.success(\"MIPS File Upload approved successfully\");\n        this.routeToInbox();\n      }, error => {\n        this.toastService.error(error.error?.error_desc);\n      });\n    });\n  }\n  onReject(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\n      this.mipsService.approveMipsFileRecord(this.mipsFileRecordId, false).subscribe(res => {\n        this.toastService.success(\"MIPS File Upload rejected successfully\");\n        this.routeToInbox();\n      }, error => {\n        this.toastService.error(error.error?.error_desc);\n      });\n    });\n  }\n  onSubmitVerificationFile(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\n      // Temporary placeholder\n      // TODO: Should check if file is actually verified before setting flag to true\n      const fileTxnId = this.verifyFileUploadComponent.verifiedFiles.map(x => String(x.meta_data.id))[0];\n      const request = {\n        fileTxnId\n      };\n      this.mipsService.verifySource(this.mipsFileRecordId, request).subscribe(res => {\n        this.isFileVerified = res.body?.data;\n        if (this.isFileVerified) {\n          this.loadMipsRecord();\n          this.verifyFileUploadComponent.disableButtons(true);\n        }\n      }, error => {\n        this.toastService.error(error.error?.error_desc);\n      });\n      // this.showMipsUploadRecords = true;\n    });\n  }\n  // Pop up the Confirmation dialog to Cancel current transaction\n  onCancel(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\n      this.routeToInbox();\n    });\n  }\n  routeToInbox() {\n    this.router.navigate(['/inbox']);\n  }\n  exportCSV(dataTable) {\n    const data = this.mipsUploadRecord;\n    const columns = [{\n      field: 'sn',\n      header: 'SN',\n      index: 0\n    }, {\n      field: 'uploadedBy',\n      header: 'Uploaded By',\n      index: 1\n    }, {\n      field: 'name',\n      header: 'Name',\n      index: 2\n    }, {\n      field: 'mipsId',\n      header: 'MIPS ID',\n      index: 3\n    }, {\n      field: 'amount',\n      header: 'Refund Amount',\n      index: 4\n    }];\n    const dtoList = [];\n    data.overpaymentMips.forEach((d, index) => {\n      const dto = {\n        sn: index + 1,\n        uploadedBy: `${String(this.dateUtilsService.formatStrDate(data.submittedDt, \"DD-MM-YYYY (HHmm)\"))} ${String(data.submittedBy ? data.submittedBy : \"\")}`,\n        name: `${d.nric} ${d.name}`,\n        mipsId: d.mipsId,\n        amount: d.amount\n      };\n      dtoList.push(dto);\n    });\n    this.exportUtilsService.exportCSV(dataTable, dtoList, data.overpaymentMips.length, columns, \"data_\".concat((0, common_1.formatDate)(new Date(), \"dd-MM-YYYY\", this.localeId)));\n  }\n}\nexports.MipsUploadApprovalComponent = MipsUploadApprovalComponent;\nMipsUploadApprovalComponent.ɵfac = function MipsUploadApprovalComponent_Factory(t) {\n  return new (t || MipsUploadApprovalComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.NspConfirmationService), i0.ɵɵdirectiveInject(i3.MipsUploadService), i0.ɵɵdirectiveInject(i4.DateUtilsService), i0.ɵɵdirectiveInject(i5.ExportUtilsService), i0.ɵɵdirectiveInject(i6.CustomToastService), i0.ɵɵdirectiveInject(i7.FormBuilder), i0.ɵɵdirectiveInject(core_1.LOCALE_ID));\n};\nMipsUploadApprovalComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: MipsUploadApprovalComponent,\n  selectors: [[\"n2-mips-upload-approval\"]],\n  viewQuery: function MipsUploadApprovalComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 7);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.verifyFileUploadComponent = _t.first);\n    }\n  },\n  decls: 67,\n  vars: 13,\n  consts: [[1, \"grid\"], [1, \"col-8\"], [\"header\", \"MIPS Upload Pending Approval\", 1, \"flex\", \"flex-auto\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"paginator\", \"rows\", \"rowsPerPageOptions\", \"showCurrentPageReport\", 4, \"ngIf\"], [1, \"col-4\", \"flex\"], [\"header\", \"Verify Source File\", 1, \"flex\", \"flex-auto\"], [3, \"formGroup\"], [\"formControlName\", \"file\", 3, \"externalFileLimit\"], [\"mipsVerifyFileUpload\", \"\"], [\"class\", \"col-9\", 4, \"ngIf\"], [1, \"col-3\"], [1, \"flex\"], [\"key\", \"annualWriteOffFileVerifyUpload\"], [\"pButton\", \"\", \"label\", \"Submit\", 3, \"disabled\", \"click\"], [1, \"flex\", \"justify-content-end\", \"align-items-center\", \"gap-2\"], [\"key\", \"annualWriteOffCancel\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Cancel\", 1, \"p-button-danger\", 3, \"click\"], [\"key\", \"annualWriteOffReject\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Reject\", 1, \"p-button-outlined\", 3, \"click\"], [\"key\", \"annualWriteOffApprove\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Approve\", 3, \"disabled\", \"click\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"paginator\", \"rows\", \"rowsPerPageOptions\", \"showCurrentPageReport\"], [\"dt\", \"\"], [\"pTemplate\", \"caption\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"emptymessage\"], [1, \"col-1\", \"nsp-align-left\", \"flex\", \"justify-content-start\", \"align-items-center\"], [\"type\", \"button\", \"pButton\", \"\", \"pRipple\", \"\", \"icon\", \"pi pi-file-o\", \"pTooltip\", \"Export as CSV\", \"tooltipPosition\", \"bottom\", 3, \"click\"], [1, \"col-6\", \"nsp-align-left\", \"flex\", \"justify-content-start\", \"align-items-center\"], [\"scope\", \"col\", 2, \"width\", \"5%\"], [\"scope\", \"col\", \"pSortableColumn\", \"uploadedBy\", 2, \"width\", \"20%\"], [\"field\", \"uploadedBy\"], [\"scope\", \"col\", \"pSortableColumn\", \"name\", 2, \"width\", \"35%\"], [\"field\", \"name\"], [\"scope\", \"col\", \"pSortableColumn\", \"mipsId\", 2, \"width\", \"20%\"], [\"field\", \"mipsId\"], [\"scope\", \"col\", \"pSortableColumn\", \"refundAmount\", 2, \"width\", \"20%\"], [\"field\", \"refundAmount\"], [4, \"ngIf\"], [\"colspan\", \"5\"], [1, \"col-9\"]],\n  template: function MipsUploadApprovalComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelementStart(2, \"div\", 1);\n      i0.ɵɵtext(3, \"\\n    \");\n      i0.ɵɵelementStart(4, \"p-panel\", 2);\n      i0.ɵɵtext(5, \"\\n      \");\n      i0.ɵɵtemplate(6, MipsUploadApprovalComponent_p_table_6_Template, 11, 6, \"p-table\", 3);\n      i0.ɵɵtext(7, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(8, \"\\n\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(9, \"\\n\\n  \");\n      i0.ɵɵelementStart(10, \"div\", 4);\n      i0.ɵɵtext(11, \"\\n    \");\n      i0.ɵɵtext(12, \"\\n    \");\n      i0.ɵɵelementStart(13, \"p-panel\", 5);\n      i0.ɵɵtext(14, \"\\n\\n      \");\n      i0.ɵɵelementStart(15, \"form\", 6);\n      i0.ɵɵtext(16, \"\\n        \");\n      i0.ɵɵelement(17, \"n2-file-upload\", 7, 8);\n      i0.ɵɵtext(19, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(20, \"\\n\\n      \");\n      i0.ɵɵelement(21, \"br\");\n      i0.ɵɵtext(22, \"\\n      \");\n      i0.ɵɵelementStart(23, \"div\", 0);\n      i0.ɵɵtext(24, \"\\n        \");\n      i0.ɵɵtemplate(25, MipsUploadApprovalComponent_div_25_Template, 8, 0, \"div\", 9);\n      i0.ɵɵtext(26, \"\\n        \");\n      i0.ɵɵtemplate(27, MipsUploadApprovalComponent_div_27_Template, 5, 0, \"div\", 9);\n      i0.ɵɵtext(28, \"\\n        \");\n      i0.ɵɵelementStart(29, \"div\", 10);\n      i0.ɵɵtext(30, \"\\n          \");\n      i0.ɵɵelementStart(31, \"div\", 11);\n      i0.ɵɵtext(32, \"\\n            \");\n      i0.ɵɵelement(33, \"p-confirmPopup\", 12);\n      i0.ɵɵtext(34, \"\\n            \");\n      i0.ɵɵelementStart(35, \"button\", 13);\n      i0.ɵɵlistener(\"click\", function MipsUploadApprovalComponent_Template_button_click_35_listener($event) {\n        return ctx.onSubmitVerificationFile($event, \"annualWriteOffFileVerifyUpload\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(36, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(37, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(38, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(39, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(40, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(41, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(42, \"\\n\\n\");\n      i0.ɵɵelementStart(43, \"div\", 14);\n      i0.ɵɵtext(44, \"\\n  \");\n      i0.ɵɵelementStart(45, \"div\");\n      i0.ɵɵtext(46, \"\\n    \");\n      i0.ɵɵelement(47, \"p-confirmPopup\", 15);\n      i0.ɵɵtext(48, \"\\n    \");\n      i0.ɵɵelementStart(49, \"button\", 16);\n      i0.ɵɵlistener(\"click\", function MipsUploadApprovalComponent_Template_button_click_49_listener($event) {\n        return ctx.onCancel($event, \"annualWriteOffCancel\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(50, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(51, \"\\n  \");\n      i0.ɵɵelementStart(52, \"div\");\n      i0.ɵɵtext(53, \"\\n    \");\n      i0.ɵɵelement(54, \"p-confirmPopup\", 17);\n      i0.ɵɵtext(55, \"\\n    \");\n      i0.ɵɵelementStart(56, \"button\", 18);\n      i0.ɵɵlistener(\"click\", function MipsUploadApprovalComponent_Template_button_click_56_listener($event) {\n        return ctx.onReject($event, \"annualWriteOffReject\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(57, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(58, \"\\n  \");\n      i0.ɵɵelementStart(59, \"div\");\n      i0.ɵɵtext(60, \"\\n    \");\n      i0.ɵɵelement(61, \"p-confirmPopup\", 19);\n      i0.ɵɵtext(62, \"\\n    \");\n      i0.ɵɵelementStart(63, \"button\", 20);\n      i0.ɵɵlistener(\"click\", function MipsUploadApprovalComponent_Template_button_click_63_listener($event) {\n        return ctx.onApprove($event, \"annualWriteOffApprove\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(64, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(65, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(66, \"\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngIf\", ctx.isFileVerified);\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"formGroup\", ctx.mipsVerifyFileUploadForm);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"externalFileLimit\", ctx.fileUploadFileLimit);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isFileVerified);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.isFileVerified);\n      i0.ɵɵadvance(4);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(11, _c2));\n      i0.ɵɵadvance(4);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(12, _c3));\n      i0.ɵɵproperty(\"disabled\", ctx.isFileVerified);\n      i0.ɵɵadvance(28);\n      i0.ɵɵproperty(\"disabled\", !ctx.isFileVerified);\n    }\n  },\n  dependencies: [i7.ɵNgNoValidate, i7.NgControlStatus, i7.NgControlStatusGroup, i8.NgIf, i7.FormGroupDirective, i7.FormControlName, i9.PrimeTemplate, i10.ButtonDirective, i11.Tooltip, i12.Table, i12.SortableColumn, i12.SortIcon, i13.ConfirmPopup, i14.FileUploadComponent, i15.Panel, i16.Ripple, i8.CurrencyPipe, i8.DatePipe, i17.DefaultStringPipe],\n  styles: [\"[_nghost-%COMP%]     .p-dialog-mask {\\n  background-color: rgba(0, 0, 0, 0.4);\\n}\\n\\n[_nghost-%COMP%]     .p-toggleable-content {\\n  display: flex;\\n}\\n\\n[_nghost-%COMP%]     .p-panel.p-component {\\n  display: flex;\\n  flex-direction: column;\\n  flex: auto;\\n}\\n\\n[_nghost-%COMP%]     .p-toggleable-content {\\n  display: flex;\\n  flex: auto;\\n}\\n\\n[_nghost-%COMP%]     .p-panel-content {\\n  flex: auto;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1pcHMtdXBsb2FkLWFwcHJvdmFsLmNvbXBvbmVudC5zY3NzIiwiLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxccHJvamVjdHMlMjAyXFxuc3BheWlpYXBwXFxzcmNcXG1haW5cXHdlYmFwcFxcYXBwXFxwYXltZW50XFxvdmVycGF5bWVudFxcbWlwcy11cGxvYWQtYXBwcm92YWxcXG1pcHMtdXBsb2FkLWFwcHJvdmFsLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs0RUFBQTtBQUlBO0VBQ0Usb0NBQUE7QUNBRjs7QURHQTtFQUNFLGFBQUE7QUNBRjs7QURHQTtFQUNFLGFBQUE7RUFDQSxzQkFBQTtFQUNBLFVBQUE7QUNBRjs7QURHQTtFQUNFLGFBQUE7RUFDQSxVQUFBO0FDQUY7O0FER0E7RUFDRSxVQUFBO0FDQUYiLCJmaWxlIjoibWlwcy11cGxvYWQtYXBwcm92YWwuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5PdmVycmlkZSBEaWFsb2cgbWFzayBDU1MgLSBDaGFuZ2UgZnJvbSBUcmFuc3BhcmVudCBiYWNrIHRvIGJsYWNrXHJcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXHJcblxyXG46aG9zdCA6Om5nLWRlZXAgLnAtZGlhbG9nLW1hc2sge1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICMwMDA2O1xyXG59XHJcblxyXG46aG9zdCA6Om5nLWRlZXAgLnAtdG9nZ2xlYWJsZS1jb250ZW50IHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG59XHJcblxyXG46aG9zdCA6Om5nLWRlZXAgLnAtcGFuZWwucC1jb21wb25lbnQge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBmbGV4OiBhdXRvO1xyXG59XHJcblxyXG46aG9zdCA6Om5nLWRlZXAgLnAtdG9nZ2xlYWJsZS1jb250ZW50IHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXg6IGF1dG87XHJcbn1cclxuXHJcbjpob3N0IDo6bmctZGVlcCAucC1wYW5lbC1jb250ZW50IHtcclxuICBmbGV4OiBhdXRvO1xyXG59XHJcbiIsIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5PdmVycmlkZSBEaWFsb2cgbWFzayBDU1MgLSBDaGFuZ2UgZnJvbSBUcmFuc3BhcmVudCBiYWNrIHRvIGJsYWNrXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuOmhvc3QgOjpuZy1kZWVwIC5wLWRpYWxvZy1tYXNrIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjQpO1xufVxuXG46aG9zdCA6Om5nLWRlZXAgLnAtdG9nZ2xlYWJsZS1jb250ZW50IHtcbiAgZGlzcGxheTogZmxleDtcbn1cblxuOmhvc3QgOjpuZy1kZWVwIC5wLXBhbmVsLnAtY29tcG9uZW50IHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgZmxleDogYXV0bztcbn1cblxuOmhvc3QgOjpuZy1kZWVwIC5wLXRvZ2dsZWFibGUtY29udGVudCB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXg6IGF1dG87XG59XG5cbjpob3N0IDo6bmctZGVlcCAucC1wYW5lbC1jb250ZW50IHtcbiAgZmxleDogYXV0bztcbn0iXX0= */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvcGF5bWVudC9vdmVycGF5bWVudC9taXBzLXVwbG9hZC1hcHByb3ZhbC9taXBzLXVwbG9hZC1hcHByb3ZhbC5jb21wb25lbnQuc2NzcyIsIndlYnBhY2s6Ly8uLy4uLy4uL3Byb2plY3RzJTIwMi9uc3BheWlpYXBwL3NyYy9tYWluL3dlYmFwcC9hcHAvcGF5bWVudC9vdmVycGF5bWVudC9taXBzLXVwbG9hZC1hcHByb3ZhbC9taXBzLXVwbG9hZC1hcHByb3ZhbC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7NEVBQUE7QUFJQTtFQUNFLG9DQUFBO0FDQUY7O0FER0E7RUFDRSxhQUFBO0FDQUY7O0FER0E7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxVQUFBO0FDQUY7O0FER0E7RUFDRSxhQUFBO0VBQ0EsVUFBQTtBQ0FGOztBREdBO0VBQ0UsVUFBQTtBQ0FGO0FEQ0EsZ3pFQUFnekUiLCJzb3VyY2VzQ29udGVudCI6WyIvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5PdmVycmlkZSBEaWFsb2cgbWFzayBDU1MgLSBDaGFuZ2UgZnJvbSBUcmFuc3BhcmVudCBiYWNrIHRvIGJsYWNrXHJcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXHJcblxyXG46aG9zdCA6Om5nLWRlZXAgLnAtZGlhbG9nLW1hc2sge1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICMwMDA2O1xyXG59XHJcblxyXG46aG9zdCA6Om5nLWRlZXAgLnAtdG9nZ2xlYWJsZS1jb250ZW50IHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG59XHJcblxyXG46aG9zdCA6Om5nLWRlZXAgLnAtcGFuZWwucC1jb21wb25lbnQge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBmbGV4OiBhdXRvO1xyXG59XHJcblxyXG46aG9zdCA6Om5nLWRlZXAgLnAtdG9nZ2xlYWJsZS1jb250ZW50IHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXg6IGF1dG87XHJcbn1cclxuXHJcbjpob3N0IDo6bmctZGVlcCAucC1wYW5lbC1jb250ZW50IHtcclxuICBmbGV4OiBhdXRvO1xyXG59XHJcbiIsIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5PdmVycmlkZSBEaWFsb2cgbWFzayBDU1MgLSBDaGFuZ2UgZnJvbSBUcmFuc3BhcmVudCBiYWNrIHRvIGJsYWNrXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuOmhvc3QgOjpuZy1kZWVwIC5wLWRpYWxvZy1tYXNrIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjQpO1xufVxuXG46aG9zdCA6Om5nLWRlZXAgLnAtdG9nZ2xlYWJsZS1jb250ZW50IHtcbiAgZGlzcGxheTogZmxleDtcbn1cblxuOmhvc3QgOjpuZy1kZWVwIC5wLXBhbmVsLnAtY29tcG9uZW50IHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgZmxleDogYXV0bztcbn1cblxuOmhvc3QgOjpuZy1kZWVwIC5wLXRvZ2dsZWFibGUtY29udGVudCB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXg6IGF1dG87XG59XG5cbjpob3N0IDo6bmctZGVlcCAucC1wYW5lbC1jb250ZW50IHtcbiAgZmxleDogYXV0bztcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","MipsUploadApprovalComponent","constructor","router","route","nspConfirmService","mipsService","dateUtilsService","exportUtilsService","toastService","fb","localeId","group","file","forms_1","fileupload2_directive_1","maxFileLimit","fileUploadFileLimit","allowableExtension","ngOnInit","queryParams","subscribe","params","mipsFileRecordId","loadMipsRecord","loading","getMipsFileRecord","res","mipsUploadRecord","body","data","error","error_desc","onApprove","event","key","dialog","onConfirmPopup","approveMipsFileRecord","success","routeToInbox","onReject","onSubmitVerificationFile","fileTxnId","verifyFileUploadComponent","verifiedFiles","map","x","String","meta_data","id","request","verifySource","isFileVerified","disableButtons","onCancel","navigate","exportCSV","dataTable","columns","field","header","index","dtoList","overpaymentMips","forEach","d","dto","sn","uploadedBy","formatStrDate","submittedDt","submittedBy","name","nric","mipsId","amount","push","length","concat","Date","exports","core_1","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\payment\\overpayment\\mips-upload-approval\\mips-upload-approval.component.ts","C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\payment\\overpayment\\mips-upload-approval\\mips-upload-approval.component.html"],"sourcesContent":["import { Component, Inject, LOCALE_ID, OnInit, ViewChild } from '@angular/core';\r\nimport { NspConfirmationService } from 'app/shared/confirm/nsp-confirm.service';\r\nimport { CustomToastService } from 'app/layouts/service/customtoast.service';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { IMipsRecord, IMipsUploadRecord } from 'app/payment/overpayment/mips-upload-approval/model/mips-upload-record.model';\r\nimport { HttpErrorResponse, HttpResponse, HttpStatusCode } from '@angular/common/http';\r\nimport { MipsUploadService } from '../service/mips-upload.service';\r\nimport { FormBuilder, FormControl, FormGroup } from '@angular/forms';\r\nimport { FileUploadComponent } from 'app/shared/component/file-upload/file-upload.component';\r\nimport { FileUploadValidator2 } from 'app/shared/validator/fileupload2.directive';\r\nimport { Table } from 'primeng/table';\r\nimport { DateUtilsService } from 'app/core/util/date-utils.service';\r\nimport { ExportUtilsService } from 'app/core/util/export-utils.service';\r\nimport { formatDate } from '@angular/common';\r\n\r\n@Component({\r\n  selector: 'n2-mips-upload-approval',\r\n  templateUrl: './mips-upload-approval.component.html',\r\n  styleUrls: ['./mips-upload-approval.component.scss']\r\n})\r\nexport class MipsUploadApprovalComponent implements OnInit {\r\n  mipsUploadRecord: IMipsUploadRecord = {};\r\n  mipsFileRecordId = \"\";\r\n\r\n  isFileVerified = false;\r\n  loading = false;\r\n\r\n  //MIPS\r\n  fileUploadFileLimit = 1;\r\n  mipsVerifyFileUploadForm: FormGroup = this.fb.group({\r\n    file: new FormControl([], [\r\n      FileUploadValidator2.maxFileLimit(this.fileUploadFileLimit),\r\n      FileUploadValidator2.allowableExtension(\".xls,.xlsx\")])\r\n  });\r\n\r\n  @ViewChild('mipsVerifyFileUpload', { static: true })\r\n  private verifyFileUploadComponent!: FileUploadComponent;\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private nspConfirmService: NspConfirmationService,\r\n    private mipsService: MipsUploadService,\r\n    private dateUtilsService: DateUtilsService,\r\n    private exportUtilsService: ExportUtilsService,\r\n    private toastService: CustomToastService,\r\n    private fb: FormBuilder,\r\n    @Inject(LOCALE_ID) protected localeId: string\r\n    ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.route.queryParams.subscribe(params => {\r\n      this.mipsFileRecordId = params['id'];\r\n    });\r\n  }\r\n\r\n  loadMipsRecord(): void {\r\n    this.loading = true;\r\n    this.mipsService.getMipsFileRecord(this.mipsFileRecordId).subscribe(\r\n      (res: HttpResponse<any>) => {\r\n        this.mipsUploadRecord = res.body?.data;\r\n        this.loading = false;\r\n      },\r\n      (error: HttpErrorResponse) => {\r\n        this.toastService.error(error.error?.error_desc);\r\n        this.loading = false;\r\n      }\r\n    )\r\n  }\r\n\r\n  onApprove(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\r\n      this.mipsService.approveMipsFileRecord(this.mipsFileRecordId, true).subscribe(\r\n        (res: HttpResponse<any>) => {\r\n          this.toastService.success(\"MIPS File Upload approved successfully\");\r\n          this.routeToInbox();\r\n        },\r\n        (error: HttpErrorResponse) => {\r\n          this.toastService.error(error.error?.error_desc);\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  onReject(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\r\n      this.mipsService.approveMipsFileRecord(this.mipsFileRecordId, false).subscribe(\r\n        (res: HttpResponse<any>) => {\r\n          this.toastService.success(\"MIPS File Upload rejected successfully\");\r\n          this.routeToInbox();\r\n        },\r\n        (error: HttpErrorResponse) => {\r\n          this.toastService.error(error.error?.error_desc);\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  onSubmitVerificationFile(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\r\n      // Temporary placeholder\r\n      // TODO: Should check if file is actually verified before setting flag to true\r\n      const fileTxnId = this.verifyFileUploadComponent.verifiedFiles.map(x=>\r\n        String(x.meta_data.id)\r\n      )[0];\r\n\r\n      const request = { fileTxnId };\r\n\r\n      this.mipsService.verifySource(this.mipsFileRecordId, request).subscribe(\r\n        (res: HttpResponse<any>) => {\r\n          this.isFileVerified = res.body?.data;\r\n          if(this.isFileVerified) {\r\n            this.loadMipsRecord();\r\n            this.verifyFileUploadComponent.disableButtons(true);\r\n          }\r\n        },\r\n        (error: HttpErrorResponse) => {\r\n          this.toastService.error(error.error?.error_desc);\r\n        }\r\n      );\r\n      // this.showMipsUploadRecords = true;\r\n    });\r\n  }\r\n\r\n  // Pop up the Confirmation dialog to Cancel current transaction\r\n  onCancel(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\r\n      this.routeToInbox();\r\n    });\r\n  }\r\n\r\n  routeToInbox(): void {\r\n    this.router.navigate(['/inbox']);\r\n  }\r\n\r\n  exportCSV(dataTable: Table): void {\r\n    const data = this.mipsUploadRecord;\r\n\r\n    const columns = \r\n    [\r\n      {field: 'sn', header: 'SN', index: 0},\r\n      {field: 'uploadedBy', header: 'Uploaded By', index: 1},\r\n      {field: 'name', header: 'Name', index: 2},\r\n      {field: 'mipsId', header: 'MIPS ID', index: 3},\r\n      {field: 'amount', header: 'Refund Amount', index: 4},\r\n    ];\r\n\r\n    const dtoList:any[] = [];\r\n    data.overpaymentMips.forEach((d: IMipsRecord, index: number) => {\r\n      const dto = {\r\n        sn: index + 1,\r\n        uploadedBy: `${String(this.dateUtilsService.formatStrDate(data.submittedDt, \"DD-MM-YYYY (HHmm)\"))} ${String(data.submittedBy ? data.submittedBy : \"\")}`,\r\n        name: `${d.nric} ${d.name}`,\r\n        mipsId: d.mipsId,\r\n        amount: d.amount\r\n      }\r\n      dtoList.push(dto);\r\n    });\r\n    this.exportUtilsService.exportCSV(dataTable, dtoList, data.overpaymentMips.length, columns, \r\n      \"data_\".concat(formatDate(new Date(),\"dd-MM-YYYY\", this.localeId)));\r\n  }\r\n\r\n}\r\n","<div class='grid '>\r\n  <div class='col-8'>\r\n    <p-panel class='flex flex-auto' header='MIPS Upload Pending Approval'>\r\n      <p-table\r\n        #dt\r\n        *ngIf='isFileVerified'\r\n        [value]='mipsUploadRecord?.overpaymentMips'\r\n        styleClass='p-datatable-gridlines'\r\n        [paginator]='true'\r\n        [rows]='10'\r\n        [rowsPerPageOptions]='[10,25,50]'\r\n        [showCurrentPageReport]='true'\r\n        currentPageReportTemplate='Showing {first} to {last} of {totalRecords} entries'>\r\n        <ng-template pTemplate='caption'>\r\n        <div class='grid'>\r\n          <div class='col-1 nsp-align-left flex justify-content-start align-items-center'>\r\n            <button type='button' pButton pRipple icon='pi pi-file-o' (click)='exportCSV(dt)' pTooltip='Export as CSV'\r\n                    tooltipPosition='bottom'></button>\r\n          </div>\r\n          <div class='col-6 nsp-align-left flex justify-content-start align-items-center'>MIPS Upload Pending Approval\r\n          </div>\r\n        </div>\r\n        </ng-template>\r\n        <ng-template pTemplate='header'>\r\n        <tr>\r\n          <th scope=\"col\" style='width: 5%'>SN</th>\r\n          <th scope=\"col\" style='width: 20%' pSortableColumn='uploadedBy'>Uploaded By\r\n            <p-sortIcon field='uploadedBy'></p-sortIcon>\r\n          </th>\r\n          <th scope=\"col\" style='width: 35%' pSortableColumn='name'>Name\r\n            <p-sortIcon field='name'></p-sortIcon>\r\n          </th>\r\n          <th scope=\"col\" style='width: 20%' pSortableColumn='mipsId'>MIPS ID\r\n            <p-sortIcon field='mipsId'></p-sortIcon>\r\n          </th>\r\n          <th scope=\"col\" style='width: 20%' pSortableColumn='refundAmount'>Refund Amount\r\n            <p-sortIcon field='refundAmount'></p-sortIcon>\r\n          </th>\r\n        </tr>\r\n        </ng-template>\r\n\r\n        <ng-template pTemplate='body' let-mipsRecord let-i='rowIndex'>\r\n        <tr>\r\n          <td>{{ i + 1 }}</td>\r\n          <td>{{ mipsUploadRecord.submittedBy | defaultString }}<br\r\n            *ngIf='mipsUploadRecord.submittedBy'>{{ mipsUploadRecord.submittedDt | date:'dd-MM-yyyy \\'(\\'HHmm\\')\\'' | defaultString }}</td>\r\n          <td>{{ mipsRecord.nric | defaultString }}<br\r\n            *ngIf='mipsRecord.nric'>{{ mipsRecord.name | defaultString }}</td>\r\n          <td>{{ mipsRecord.mipsId | defaultString}}</td>\r\n          <td>{{ mipsRecord.amount | currency:'SGD':'symbol-narrow'  | defaultString}}</td>\r\n        </tr>\r\n        </ng-template>\r\n\r\n        <ng-template pTemplate='emptymessage'>\r\n        <tr>\r\n          <td colspan='5'>No pending approval MIPS Upload records found.</td>\r\n        </tr>\r\n        </ng-template>\r\n      </p-table>\r\n    </p-panel>\r\n\r\n  </div>\r\n\r\n  <div class='col-4 flex'>\r\n    <!--    Panel for File verification panel    -->\r\n    <p-panel class='flex flex-auto' header='Verify Source File'>\r\n\r\n      <form [formGroup]=\"mipsVerifyFileUploadForm\">\r\n        <n2-file-upload #mipsVerifyFileUpload\r\n          formControlName=\"file\"\r\n          [externalFileLimit]=\"fileUploadFileLimit\"></n2-file-upload>\r\n      </form>\r\n\r\n      <br>\r\n      <div class='grid'>\r\n        <div class='col-9' *ngIf=\"!isFileVerified\">\r\n          <div>\r\n            Please upload file for verification.\r\n          </div>\r\n          <div>\r\n            File verification is required for approval.\r\n          </div>\r\n        </div>\r\n        <div class='col-9' *ngIf=\"isFileVerified\">\r\n          <div>\r\n            File Verified\r\n          </div>\r\n        </div>\r\n        <div class='col-3'>\r\n          <div class='flex' [style]=\"{'justify-content': 'end'}\">\r\n            <p-confirmPopup key=\"annualWriteOffFileVerifyUpload\"></p-confirmPopup>\r\n            <button pButton label='Submit' (click)=\"onSubmitVerificationFile($event, 'annualWriteOffFileVerifyUpload', null)\"\r\n              [disabled]=\"isFileVerified\"\r\n              [style]=\"{'margin-left': '.5em' , 'margin-bottom': '.5em'}\"></button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </p-panel>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"flex justify-content-end align-items-center gap-2\">\r\n  <div>\r\n    <p-confirmPopup key='annualWriteOffCancel'></p-confirmPopup>\r\n    <button class='p-button-danger' type='button' pButton label='Cancel'\r\n            (click)=\"onCancel($event, 'annualWriteOffCancel', null)\"></button>\r\n  </div>\r\n  <div>\r\n    <p-confirmPopup key='annualWriteOffReject'></p-confirmPopup>\r\n    <button class='p-button-outlined' type='button' pButton label='Reject'\r\n            (click)=\"onReject($event, 'annualWriteOffReject', null)\"></button>\r\n  </div>\r\n  <div>\r\n    <p-confirmPopup key='annualWriteOffApprove'></p-confirmPopup>\r\n    <button type='button' pButton label='Approve'\r\n            (click)=\"onApprove($event, 'annualWriteOffApprove', null)\"\r\n            [disabled]=\"!isFileVerified\"></button>\r\n  </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}