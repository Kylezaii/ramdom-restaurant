{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PayrollBlackOutComponent = void 0;\nconst tslib_1 = require(\"tslib\");\nconst core_1 = require(\"@angular/core\");\nconst common_1 = require(\"@angular/common\");\nconst forms_1 = require(\"@angular/forms\");\nconst nspay2_constants_1 = require(\"app/nspay2.constants\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"@angular/router\"));\nconst i2 = tslib_1.__importStar(require(\"@angular/forms\"));\nconst i3 = tslib_1.__importStar(require(\"./service/payroll-black-out.service\"));\nconst i4 = tslib_1.__importStar(require(\"app/shared/confirm/nsp-confirm.service\"));\nconst i5 = tslib_1.__importStar(require(\"primeng/api\"));\nconst i6 = tslib_1.__importStar(require(\"app/layouts/service/customtoast.service\"));\nconst i7 = tslib_1.__importStar(require(\"app/core/util/date-utils.service\"));\nconst i8 = tslib_1.__importStar(require(\"app/core/util/export-utils.service\"));\nconst i9 = tslib_1.__importStar(require(\"@angular/common\"));\nconst i10 = tslib_1.__importStar(require(\"primeng/button\"));\nconst i11 = tslib_1.__importStar(require(\"primeng/checkbox\"));\nconst i12 = tslib_1.__importStar(require(\"primeng/tooltip\"));\nconst i13 = tslib_1.__importStar(require(\"primeng/table\"));\nconst i14 = tslib_1.__importStar(require(\"primeng/dialog\"));\nconst i15 = tslib_1.__importStar(require(\"primeng/inputtextarea\"));\nconst i16 = tslib_1.__importStar(require(\"primeng/confirmpopup\"));\nconst i17 = tslib_1.__importStar(require(\"primeng/calendar\"));\nconst i18 = tslib_1.__importStar(require(\"../../../shared/status/status.pipe\"));\nfunction PayrollBlackOutComponent_span_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 17);\n    i0.ɵɵtext(1, \"Max length of 100 characters\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PayrollBlackOutComponent_span_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 17);\n    i0.ɵɵtext(1, \"Required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PayrollBlackOutComponent_ng_template_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n      \");\n    i0.ɵɵelementStart(1, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function PayrollBlackOutComponent_ng_template_31_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.displayDialog = false);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(2, \"\\n      \");\n    i0.ɵɵelement(3, \"p-confirmPopup\", 19);\n    i0.ɵɵtext(4, \"\\n      \");\n    i0.ɵɵelementStart(5, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function PayrollBlackOutComponent_ng_template_31_Template_button_click_5_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.confirmAdd($event, \"addConfirmPopup\", ctx_r14.displayDialog));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n    \");\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"disabled\", !ctx_r2.addDateForm.valid);\n  }\n}\nfunction PayrollBlackOutComponent_ng_template_39_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"div\", 21);\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function PayrollBlackOutComponent_ng_template_39_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      const _r3 = i0.ɵɵreference(37);\n      return i0.ɵɵresetView(ctx_r15.exportCSV(_r3));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"lowercase\");\n    i0.ɵɵpipe(6, \"status\");\n    i0.ɵɵpipe(7, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n      \");\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate4(\"\\n          YEAR \", ctx_r4.currentYear, \" (Last \", i0.ɵɵpipeBind1(5, 4, i0.ɵɵpipeBind1(6, 6, ctx_r4.latestCurrentYearDate == null ? null : ctx_r4.latestCurrentYearDate.status)), \" by \", ctx_r4.latestCurrentYearDate == null ? null : ctx_r4.latestCurrentYearDate.statusBy, \" on \", i0.ɵɵpipeBind2(7, 8, ctx_r4.latestCurrentYearDate == null ? null : ctx_r4.latestCurrentYearDate.statusDt, \"dd/MM/yyyy\"), \")\\n        \");\n  }\n}\nfunction PayrollBlackOutComponent_ng_template_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"th\", 23);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"th\", 24);\n    i0.ɵɵtext(7, \"Blackout Date \");\n    i0.ɵɵelement(8, \"p-sortIcon\", 25);\n    i0.ɵɵtext(9, \" \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n          \");\n    i0.ɵɵelementStart(11, \"th\", 26);\n    i0.ɵɵtext(12, \"Remarks \");\n    i0.ɵɵelement(13, \"p-sortIcon\", 27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n          \");\n    i0.ɵɵelementStart(15, \"th\", 23);\n    i0.ɵɵtext(16, \"Validity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n      \");\n  }\n}\nfunction PayrollBlackOutComponent_ng_template_43_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n          \");\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14, \"\\n            \");\n    i0.ɵɵelementStart(15, \"p-checkbox\", 28);\n    i0.ɵɵlistener(\"ngModelChange\", function PayrollBlackOutComponent_ng_template_43_Template_p_checkbox_ngModelChange_15_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r20);\n      const data_r17 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(data_r17.validityBool = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n      \");\n  }\n  if (rf & 2) {\n    const data_r17 = ctx.$implicit;\n    const i_r18 = ctx.rowIndex;\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r18 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 6, data_r17.payrollDateInit, \"dd-MM-yyyy\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(data_r17.remarks);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", data_r17.validityBool)(\"binary\", true)(\"disabled\", ctx_r6.disablePending);\n  }\n}\nfunction PayrollBlackOutComponent_ng_template_52_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"div\", 21);\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function PayrollBlackOutComponent_ng_template_52_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext();\n      const _r7 = i0.ɵɵreference(50);\n      return i0.ɵɵresetView(ctx_r21.exportCSV(_r7));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"lowercase\");\n    i0.ɵɵpipe(6, \"status\");\n    i0.ɵɵpipe(7, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n      \");\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate4(\"\\n          YEAR \", ctx_r8.nextYear, \" (Last \", i0.ɵɵpipeBind1(5, 4, i0.ɵɵpipeBind1(6, 6, ctx_r8.latestNextYearDate == null ? null : ctx_r8.latestNextYearDate.status)), \" by \", ctx_r8.latestNextYearDate == null ? null : ctx_r8.latestNextYearDate.statusBy, \" on \", i0.ɵɵpipeBind2(7, 8, ctx_r8.latestNextYearDate == null ? null : ctx_r8.latestNextYearDate.statusDt, \"dd/MM/yyyy\"), \")\\n        \");\n  }\n}\nfunction PayrollBlackOutComponent_ng_template_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"th\", 23);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"th\", 24);\n    i0.ɵɵtext(7, \"Blackout Date \");\n    i0.ɵɵelement(8, \"p-sortIcon\", 25);\n    i0.ɵɵtext(9, \" \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n          \");\n    i0.ɵɵelementStart(11, \"th\", 26);\n    i0.ɵɵtext(12, \"Remarks \");\n    i0.ɵɵelement(13, \"p-sortIcon\", 27);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n          \");\n    i0.ɵɵelementStart(15, \"th\", 23);\n    i0.ɵɵtext(16, \"Validity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n      \");\n  }\n}\nfunction PayrollBlackOutComponent_ng_template_56_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r26 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n        \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n          \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n          \");\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14, \"\\n            \");\n    i0.ɵɵelementStart(15, \"p-checkbox\", 28);\n    i0.ɵɵlistener(\"ngModelChange\", function PayrollBlackOutComponent_ng_template_56_Template_p_checkbox_ngModelChange_15_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r26);\n      const data_r23 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(data_r23.validityBool = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n      \");\n  }\n  if (rf & 2) {\n    const data_r23 = ctx.$implicit;\n    const i_r24 = ctx.rowIndex;\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r24 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 6, data_r23.payrollDateInit, \"dd-MM-yyyy\"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(data_r23.remarks);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", data_r23.validityBool)(\"binary\", true)(\"disabled\", ctx_r10.disablePending);\n  }\n}\nfunction PayrollBlackOutComponent_div_61_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r28 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵtext(1, \"\\n  \");\n    i0.ɵɵelementStart(2, \"div\");\n    i0.ɵɵtext(3, \"\\n    \");\n    i0.ɵɵelementStart(4, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function PayrollBlackOutComponent_div_61_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r27 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r27.showAddDialog());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n    \");\n    i0.ɵɵelementStart(6, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function PayrollBlackOutComponent_div_61_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r29 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r29.reset());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n    \");\n    i0.ɵɵelement(8, \"p-confirmPopup\", 31);\n    i0.ɵɵtext(9, \"\\n    \");\n    i0.ɵɵelementStart(10, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function PayrollBlackOutComponent_div_61_Template_button_click_10_listener($event) {\n      i0.ɵɵrestoreView(_r28);\n      const ctx_r30 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r30.confirm($event, \"submitConfirmPopup\"));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n  \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n\");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function () {\n  return {\n    width: \"40%\"\n  };\n};\nconst _c1 = function () {\n  return [10, 25, 50];\n};\nclass PayrollBlackOutComponent {\n  constructor(router, formBuilder, payrollBlackOutService, nspConfirmService, messageService, toastService, dateUtilsService, exportUtilsService, localeId) {\n    this.router = router;\n    this.formBuilder = formBuilder;\n    this.payrollBlackOutService = payrollBlackOutService;\n    this.nspConfirmService = nspConfirmService;\n    this.messageService = messageService;\n    this.toastService = toastService;\n    this.dateUtilsService = dateUtilsService;\n    this.exportUtilsService = exportUtilsService;\n    this.localeId = localeId;\n    this.myNSPAY2_STATUS = nspay2_constants_1.NSPAY2_STATUS;\n    this.hasData = false;\n    this.displayDialog = false;\n    this.disablePending = false;\n    this.payrollDateList = [];\n    // Request List to be send on submission\n    this.requestList = [];\n    // List for different year\n    this.currentYearDates = [];\n    this.nextYearDates = [];\n    this.currentYearDatesForm = [];\n    this.nextYearDatesForm = [];\n    // For getting the latest status\n    this.latestCurrentYearDate = {};\n    this.latestNextYearDate = {};\n    this.addDateForm = new forms_1.FormGroup({\n      date: new forms_1.FormControl(null, forms_1.Validators.required),\n      remarks: new forms_1.FormControl(null, [forms_1.Validators.required, forms_1.Validators.maxLength(100)])\n    });\n    this.currentYear = new Date().getFullYear();\n    this.nextYear = this.currentYear + 1;\n    this.minDate = new Date();\n    this.maxDate = new Date();\n  }\n  ngOnInit() {\n    this.currentYear = new Date().getFullYear();\n    this.nextYear = this.currentYear + 1;\n    const today = new Date();\n    this.minDate = new Date();\n    this.maxDate = new Date();\n    this.minDate.setDate(today.getDate() + 1);\n    this.maxDate.setFullYear(this.nextYear, 11, 31);\n    this.payrollBlackOutService.getCurrent().subscribe(res => {\n      console.log('res.body', res.body.data);\n      this.mapResponse(res.body.data);\n      this.copyDataToForm();\n    }, error => {\n      console.log(error.message);\n    });\n  }\n  showAddDialog() {\n    this.displayDialog = true;\n  }\n  mapResponse(resBody) {\n    const data = resBody;\n    this.payrollDateList = data;\n    if (Object.keys(this.payrollDateList).length > 0) {\n      this.hasData = true;\n      // Convert to date\n      this.payrollDateList.forEach(d => {\n        d.payrollDateInit = new Date(d.payrollDate);\n        d.validityBool = d.validity === 'Y';\n        // Disable if there is at least 1 record pending approval\n        if (d.status === nspay2_constants_1.NSPAY2_STATUS.PENDING_APPROVAL) {\n          this.disablePending = true;\n        }\n      });\n      this.currentYearDates = this.payrollDateList.filter(d => d.payrollDateInit?.getFullYear() === this.currentYear);\n      if (this.currentYearDates.length > 0) {\n        this.latestCurrentYearDate = this.currentYearDates.reduce(function (b, a) {\n          return b.statusDt > a.statusDt ? b : a;\n        });\n      }\n      this.nextYearDates = this.payrollDateList.filter(d => d.payrollDateInit?.getFullYear() === this.nextYear);\n      if (this.nextYearDates.length > 0) {\n        this.latestNextYearDate = this.nextYearDates.reduce(function (b, a) {\n          return b.statusDt > a.statusDt ? b : a;\n        });\n      }\n    }\n  }\n  copyDataToForm() {\n    this.currentYearDatesForm = [];\n    this.currentYearDates.forEach(val => this.currentYearDatesForm.push(Object.assign({}, val)));\n    this.nextYearDatesForm = [];\n    this.nextYearDates.forEach(val => this.nextYearDatesForm.push(Object.assign({}, val)));\n  }\n  pushChangesToRequestList() {\n    // Push new records & record with changes to validity , to request list\n    this.currentYearDatesForm.forEach(val => {\n      // if user changed to false, original is always true\n      if (!val.validityBool) {\n        val.validity = 'N';\n        this.requestList.push(val);\n      }\n    });\n    this.nextYearDatesForm.forEach(val => {\n      if (!val.validityBool) {\n        val.validity = 'N';\n        this.requestList.push(val);\n      }\n    });\n  }\n  confirm(event, key) {\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\n      this.pushChangesToRequestList();\n      this.submitRequest();\n    });\n  }\n  confirmAdd(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\n      this.displayDialog = false;\n      this.addDate();\n    });\n  }\n  addDate() {\n    const formValue = this.addDateForm.value;\n    const newDate = formValue.date;\n    const remarks = formValue.remarks;\n    const newHolidayDate = {};\n    newHolidayDate.payrollDateInit = newDate;\n    newHolidayDate.payrollDate = (0, common_1.formatDate)(newDate, \"YYYY-MM-dd\", this.localeId);\n    newHolidayDate.remarks = remarks;\n    newHolidayDate.validity = 'Y';\n    newHolidayDate.validityBool = true;\n    if (newDate.getFullYear() === this.currentYear) {\n      this.currentYearDatesForm.push(newHolidayDate);\n      this.requestList.push(newHolidayDate);\n    } else if (newDate.getFullYear() === this.nextYear) {\n      this.nextYearDatesForm.push(newHolidayDate);\n      this.requestList.push(newHolidayDate);\n    } else {\n      this.toastService.add({\n        severity: 'error',\n        summary: 'Invalid Year',\n        detail: \"Failed to add new date as year out of range\"\n      });\n    }\n    this.addDateForm.reset();\n  }\n  submitRequest() {\n    if (this.requestList.length > 0) {\n      this.payrollBlackOutService.createUpdate(this.requestList).subscribe(res => {\n        if (res.ok) {\n          this.toastService.add({\n            severity: 'success',\n            summary: 'Success',\n            detail: \"Request has been submitted for approval\"\n          });\n          this.refreshComponent();\n        }\n      }, error => {\n        console.log(error.message);\n        this.toastService.add({\n          severity: 'error',\n          summary: 'Error',\n          detail: error.message\n        });\n      });\n    } else {\n      this.toastService.add({\n        severity: 'error',\n        summary: 'Error',\n        detail: \"No changes made\"\n      });\n    }\n  }\n  reset() {\n    this.copyDataToForm();\n  }\n  exportCSV(dataTable) {\n    const data = dataTable._value;\n    const columns = [{\n      field: 'sn',\n      header: 'SN',\n      index: 0\n    }, {\n      field: 'payrollDate',\n      header: 'Blackout Date',\n      index: 1\n    }, {\n      field: 'remarks',\n      header: 'Remarks',\n      index: 2\n    }, {\n      field: 'validity',\n      header: 'Validity',\n      index: 3\n    }];\n    const dtoList = [];\n    data.forEach((d, index) => {\n      const dto = {\n        sn: index + 1,\n        payrollDate: this.dateUtilsService.convertDateToStr(d.payrollDateInit, 'DD-MM-YYYY'),\n        remarks: d.remarks,\n        validity: d.validity\n      };\n      dtoList.push(dto);\n    });\n    this.exportUtilsService.exportCSV(dataTable, dtoList, data.length, columns, \"data_\".concat((0, common_1.formatDate)(new Date(), \"dd-MM-YYYY\", this.localeId)));\n  }\n  refreshComponent() {\n    const currentRoute = this.router.url;\n    this.router.navigateByUrl('/', {\n      skipLocationChange: true\n    }).then(() => {\n      this.router.navigate([currentRoute]);\n    });\n  }\n}\nexports.PayrollBlackOutComponent = PayrollBlackOutComponent;\nPayrollBlackOutComponent.ɵfac = function PayrollBlackOutComponent_Factory(t) {\n  return new (t || PayrollBlackOutComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.PayrollBlackOutService), i0.ɵɵdirectiveInject(i4.NspConfirmationService), i0.ɵɵdirectiveInject(i5.MessageService), i0.ɵɵdirectiveInject(i6.CustomToastService), i0.ɵɵdirectiveInject(i7.DateUtilsService), i0.ɵɵdirectiveInject(i8.ExportUtilsService), i0.ɵɵdirectiveInject(core_1.LOCALE_ID));\n};\nPayrollBlackOutComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PayrollBlackOutComponent,\n  selectors: [[\"n2-payroll-black-out\"]],\n  decls: 62,\n  vars: 26,\n  consts: [[1, \"grid\"], [\"header\", \"New Payroll Removal\", 3, \"visible\", \"draggable\", \"resizable\", \"modal\", \"visibleChange\"], [3, \"formGroup\"], [1, \"field\", \"grid\"], [1, \"col\"], [\"id\", \"inputDate\", \"formControlName\", \"date\", \"dateFormat\", \"dd-mm-yy\", \"placeholder\", \"Select a date\", \"appendTo\", \"body\", 1, \"inputfield\", \"w-full\", 3, \"readonlyInput\", \"minDate\", \"maxDate\"], [\"pInputTextarea\", \"\", \"formControlName\", \"remarks\", \"type\", \"text\", \"rows\", \"5\", 1, \"inputfield\", \"w-full\"], [\"class\", \"p-error\", 4, \"ngIf\"], [\"pTemplate\", \"footer\"], [1, \"col-6\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"paginator\", \"rows\", \"showCurrentPageReport\", \"rowsPerPageOptions\"], [\"dt\", \"\"], [\"pTemplate\", \"caption\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"dt2\", \"\"], [\"class\", \"flex justify-content-end align-items-center\", 4, \"ngIf\"], [1, \"p-error\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Cancel\", 1, \"p-button-danger\", 3, \"click\"], [\"key\", \"addConfirmPopup\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Add Date\", 3, \"disabled\", \"click\"], [1, \"flex\", \"align-items-center\"], [\"type\", \"button\", \"pButton\", \"\", \"pRipple\", \"\", \"icon\", \"pi pi-file\", \"pTooltip\", \"CSV\", 1, \"mr-2\", 3, \"click\"], [\"scope\", \"col\"], [\"scope\", \"col\", \"pSortableColumn\", \"payrollDateInit\"], [\"field\", \"payrollDateInit\"], [\"scope\", \"col\", \"pSortableColumn\", \"remarks\"], [\"field\", \"remarks\"], [3, \"ngModel\", \"binary\", \"disabled\", \"ngModelChange\"], [1, \"flex\", \"justify-content-end\", \"align-items-center\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Add Date\", 1, \"p-button-secondary\", 3, \"click\"], [\"key\", \"submitConfirmPopup\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Submit\", 3, \"click\"]],\n  template: function PayrollBlackOutComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelementStart(2, \"p-dialog\", 1);\n      i0.ɵɵlistener(\"visibleChange\", function PayrollBlackOutComponent_Template_p_dialog_visibleChange_2_listener($event) {\n        return ctx.displayDialog = $event;\n      });\n      i0.ɵɵtext(3, \"\\n    \");\n      i0.ɵɵelementStart(4, \"form\", 2);\n      i0.ɵɵtext(5, \"\\n      \");\n      i0.ɵɵelementStart(6, \"div\", 3);\n      i0.ɵɵtext(7, \"\\n        \");\n      i0.ɵɵelementStart(8, \"div\", 4);\n      i0.ɵɵtext(9, \"\\n          \");\n      i0.ɵɵelementStart(10, \"p-calendar\", 5);\n      i0.ɵɵtext(11, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(12, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(13, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(14, \"\\n\\n      \");\n      i0.ɵɵelementStart(15, \"h6\");\n      i0.ɵɵtext(16, \"Remarks\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(17, \"\\n      \");\n      i0.ɵɵelementStart(18, \"div\", 3);\n      i0.ɵɵtext(19, \"\\n        \");\n      i0.ɵɵelementStart(20, \"div\", 4);\n      i0.ɵɵtext(21, \"\\n              \");\n      i0.ɵɵelement(22, \"textarea\", 6);\n      i0.ɵɵtext(23, \"\\n          \");\n      i0.ɵɵtemplate(24, PayrollBlackOutComponent_span_24_Template, 2, 0, \"span\", 7);\n      i0.ɵɵtext(25, \"\\n          \");\n      i0.ɵɵtemplate(26, PayrollBlackOutComponent_span_26_Template, 2, 0, \"span\", 7);\n      i0.ɵɵtext(27, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(28, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(29, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(30, \"\\n\\n    \");\n      i0.ɵɵtemplate(31, PayrollBlackOutComponent_ng_template_31_Template, 7, 1, \"ng-template\", 8);\n      i0.ɵɵtext(32, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(33, \"\\n\\n  \");\n      i0.ɵɵelementStart(34, \"div\", 9);\n      i0.ɵɵtext(35, \"\\n    \");\n      i0.ɵɵelementStart(36, \"p-table\", 10, 11);\n      i0.ɵɵtext(38, \"\\n      \");\n      i0.ɵɵtemplate(39, PayrollBlackOutComponent_ng_template_39_Template, 9, 11, \"ng-template\", 12);\n      i0.ɵɵtext(40, \"\\n      \");\n      i0.ɵɵtemplate(41, PayrollBlackOutComponent_ng_template_41_Template, 19, 0, \"ng-template\", 13);\n      i0.ɵɵtext(42, \"\\n      \");\n      i0.ɵɵtemplate(43, PayrollBlackOutComponent_ng_template_43_Template, 19, 9, \"ng-template\", 14);\n      i0.ɵɵtext(44, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(45, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(46, \"\\n\\n  \");\n      i0.ɵɵelementStart(47, \"div\", 9);\n      i0.ɵɵtext(48, \"\\n    \");\n      i0.ɵɵelementStart(49, \"p-table\", 10, 15);\n      i0.ɵɵtext(51, \"\\n      \");\n      i0.ɵɵtemplate(52, PayrollBlackOutComponent_ng_template_52_Template, 9, 11, \"ng-template\", 12);\n      i0.ɵɵtext(53, \"\\n      \");\n      i0.ɵɵtemplate(54, PayrollBlackOutComponent_ng_template_54_Template, 19, 0, \"ng-template\", 13);\n      i0.ɵɵtext(55, \"\\n      \");\n      i0.ɵɵtemplate(56, PayrollBlackOutComponent_ng_template_56_Template, 19, 9, \"ng-template\", 14);\n      i0.ɵɵtext(57, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(58, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(59, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(60, \"\\n\\n\");\n      i0.ɵɵtemplate(61, PayrollBlackOutComponent_div_61_Template, 13, 0, \"div\", 16);\n    }\n    if (rf & 2) {\n      let tmp_9_0;\n      let tmp_10_0;\n      i0.ɵɵadvance(2);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(23, _c0));\n      i0.ɵɵproperty(\"visible\", ctx.displayDialog)(\"draggable\", false)(\"resizable\", false)(\"modal\", true);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"formGroup\", ctx.addDateForm);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"readonlyInput\", true)(\"minDate\", ctx.minDate)(\"maxDate\", ctx.maxDate);\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"ngIf\", (tmp_9_0 = ctx.addDateForm.get(\"remarks\")) == null ? null : tmp_9_0.hasError(\"maxlength\"));\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ((tmp_10_0 = ctx.addDateForm.get(\"remarks\")) == null ? null : tmp_10_0.hasError(\"required\")) && ((tmp_10_0 = ctx.addDateForm.get(\"remarks\")) == null ? null : tmp_10_0.dirty));\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"value\", ctx.currentYearDatesForm)(\"paginator\", true)(\"rows\", 10)(\"showCurrentPageReport\", true)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(24, _c1));\n      i0.ɵɵadvance(13);\n      i0.ɵɵproperty(\"value\", ctx.nextYearDatesForm)(\"paginator\", true)(\"rows\", 10)(\"showCurrentPageReport\", true)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(25, _c1));\n      i0.ɵɵadvance(12);\n      i0.ɵɵproperty(\"ngIf\", !ctx.disablePending);\n    }\n  },\n  dependencies: [i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.NgModel, i9.NgIf, i2.FormGroupDirective, i2.FormControlName, i5.PrimeTemplate, i10.ButtonDirective, i11.Checkbox, i12.Tooltip, i13.Table, i13.SortableColumn, i13.SortIcon, i14.Dialog, i15.InputTextarea, i16.ConfirmPopup, i17.Calendar, i9.LowerCasePipe, i9.DatePipe, i18.StatusPipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwYXlyb2xsLWJsYWNrLW91dC5jb21wb25lbnQuY3NzIn0= */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvYWRtaW5pc3RyYXRpb24vYmxhY2stb3V0LWRhdGUvcGF5cm9sbC1ibGFjay1vdXQvcGF5cm9sbC1ibGFjay1vdXQuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0EsZ0xBQWdMIiwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","PayrollBlackOutComponent","constructor","router","formBuilder","payrollBlackOutService","nspConfirmService","messageService","toastService","dateUtilsService","exportUtilsService","localeId","nspay2_constants_1","forms_1","date","required","remarks","maxLength","currentYear","Date","getFullYear","nextYear","minDate","maxDate","ngOnInit","today","setDate","getDate","setFullYear","getCurrent","subscribe","res","console","log","body","data","mapResponse","copyDataToForm","error","message","showAddDialog","displayDialog","resBody","payrollDateList","Object","keys","length","hasData","forEach","d","payrollDateInit","payrollDate","validityBool","validity","status","PENDING_APPROVAL","disablePending","currentYearDates","filter","latestCurrentYearDate","reduce","b","a","statusDt","nextYearDates","latestNextYearDate","currentYearDatesForm","val","push","assign","nextYearDatesForm","pushChangesToRequestList","requestList","confirm","event","key","onConfirmPopup","submitRequest","confirmAdd","dialog","addDate","formValue","addDateForm","value","newDate","newHolidayDate","add","severity","summary","detail","reset","createUpdate","ok","refreshComponent","exportCSV","dataTable","_value","columns","field","header","index","dtoList","dto","sn","convertDateToStr","concat","currentRoute","url","navigateByUrl","skipLocationChange","then","navigate","exports","core_1","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\administration\\black-out-date\\payroll-black-out\\payroll-black-out.component.ts","C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\administration\\black-out-date\\payroll-black-out\\payroll-black-out.component.html"],"sourcesContent":["import {Component, Inject,  LOCALE_ID, OnInit} from '@angular/core';\r\nimport {Router} from '@angular/router';\r\nimport {formatDate} from \"@angular/common\";\r\n\r\nimport {IAdmPayroll} from './payroll-black-out.model';\r\nimport {PayrollBlackOutService} from './service/payroll-black-out.service';\r\nimport {FormBuilder, FormControl, FormGroup, Validators} from '@angular/forms';\r\nimport {HttpErrorResponse, HttpResponse} from '@angular/common/http';\r\nimport {MessageService} from 'primeng/api';\r\nimport {CustomToastService} from 'app/layouts/service/customtoast.service';\r\nimport {NSPAY2_STATUS} from 'app/nspay2.constants';\r\nimport { NspConfirmationService } from 'app/shared/confirm/nsp-confirm.service';\r\nimport { DateUtilsService } from 'app/core/util/date-utils.service';\r\nimport { ExportUtilsService } from 'app/core/util/export-utils.service';\r\nimport { Table } from 'primeng/table';\r\n@Component({\r\n  selector: 'n2-payroll-black-out',\r\n  templateUrl: './payroll-black-out.component.html',\r\n  styleUrls: ['./payroll-black-out.component.css']\r\n})\r\nexport class PayrollBlackOutComponent implements OnInit {\r\n\r\n  readonly myNSPAY2_STATUS = NSPAY2_STATUS;\r\n\r\n  hasData = false;\r\n  displayDialog = false;\r\n  disablePending = false;\r\n\r\n  currentYear: number;\r\n  nextYear: number;\r\n\r\n  minDate: Date;\r\n  maxDate: Date;\r\n\r\n  payrollDateList: IAdmPayroll[] = [];\r\n\r\n  // Request List to be send on submission\r\n  requestList: IAdmPayroll[] = [];\r\n\r\n  // List for different year\r\n  currentYearDates: IAdmPayroll[] = [];\r\n  nextYearDates: IAdmPayroll[] = [];\r\n\r\n  currentYearDatesForm: IAdmPayroll[] = [];\r\n  nextYearDatesForm: IAdmPayroll[] = [];\r\n\r\n  // For getting the latest status\r\n  latestCurrentYearDate: IAdmPayroll = {};\r\n  latestNextYearDate: IAdmPayroll = {};\r\n\r\n  addDateForm: FormGroup = new FormGroup({\r\n    date: new FormControl(null, Validators.required),\r\n    remarks: new FormControl(null, [Validators.required, Validators.maxLength(100)])\r\n  });\r\n\r\n  constructor(\r\n    private router: Router,\r\n    private formBuilder: FormBuilder,\r\n    private payrollBlackOutService: PayrollBlackOutService,\r\n    private nspConfirmService: NspConfirmationService,\r\n    private messageService: MessageService,\r\n    private toastService: CustomToastService,\r\n    private dateUtilsService: DateUtilsService,\r\n    private exportUtilsService: ExportUtilsService,\r\n    @Inject(LOCALE_ID) protected localeId: string\r\n  ) {\r\n    this.currentYear = new Date().getFullYear();\r\n    this.nextYear = this.currentYear + 1;\r\n    this.minDate = new Date();\r\n    this.maxDate = new Date();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.currentYear = new Date().getFullYear();\r\n    this.nextYear = this.currentYear + 1;\r\n    const today = new Date();\r\n\r\n    this.minDate = new Date();\r\n    this.maxDate = new Date();\r\n\r\n    this.minDate.setDate(today.getDate() + 1);\r\n    this.maxDate.setFullYear(this.nextYear, 11, 31);\r\n    \r\n    this.payrollBlackOutService.getCurrent().subscribe(\r\n      (res: HttpResponse<any>) => {\r\n        console.log('res.body', res.body.data);\r\n        this.mapResponse(res.body.data);\r\n        this.copyDataToForm();\r\n\r\n      },\r\n      (error: HttpErrorResponse) => {\r\n        console.log(error.message);\r\n      }\r\n    );\r\n\r\n  }\r\n\r\n  showAddDialog(): void {\r\n    this.displayDialog = true;\r\n  }\r\n\r\n  mapResponse(resBody: any): void {\r\n    const data: IAdmPayroll[] = resBody;\r\n    this.payrollDateList = data;\r\n\r\n    if (Object.keys(this.payrollDateList).length > 0) {\r\n      this.hasData = true\r\n      \r\n      // Convert to date\r\n      this.payrollDateList.forEach(d => {\r\n        d.payrollDateInit = new Date(d.payrollDate);\r\n        d.validityBool = d.validity === 'Y';\r\n\r\n        // Disable if there is at least 1 record pending approval\r\n        if (d.status === NSPAY2_STATUS.PENDING_APPROVAL) {\r\n          this.disablePending = true;\r\n        }\r\n      });\r\n\r\n\r\n      this.currentYearDates = this.payrollDateList.filter(d => d.payrollDateInit?.getFullYear() === this.currentYear);\r\n      if (this.currentYearDates.length > 0) {\r\n        this.latestCurrentYearDate = this.currentYearDates.reduce(function (b, a) {\r\n          return b.statusDt > a.statusDt ? b : a;\r\n        });\r\n      }\r\n\r\n      this.nextYearDates = this.payrollDateList.filter(d => d.payrollDateInit?.getFullYear() === this.nextYear);\r\n      if (this.nextYearDates.length > 0) {\r\n        this.latestNextYearDate = this.nextYearDates.reduce(function (b, a) {\r\n          return b.statusDt > a.statusDt ? b : a;\r\n        });\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  copyDataToForm(): void {\r\n    this.currentYearDatesForm = [];\r\n    this.currentYearDates.forEach(val => this.currentYearDatesForm.push(Object.assign({}, val)));\r\n\r\n    this.nextYearDatesForm = [];\r\n    this.nextYearDates.forEach(val => this.nextYearDatesForm.push(Object.assign({}, val)));\r\n\r\n  }\r\n\r\n  pushChangesToRequestList(): void {\r\n    // Push new records & record with changes to validity , to request list\r\n    this.currentYearDatesForm.forEach(val => {\r\n\r\n      // if user changed to false, original is always true\r\n      if (!val.validityBool) {\r\n        val.validity = 'N'\r\n        this.requestList.push(val);\r\n      }\r\n    });\r\n\r\n    this.nextYearDatesForm.forEach(val => {\r\n      if (!val.validityBool) {\r\n        val.validity = 'N'\r\n        this.requestList.push(val);\r\n      }\r\n    });\r\n  }\r\n\r\n  confirm(event: Event, key: string ): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\r\n      this.pushChangesToRequestList();\r\n      this.submitRequest();\r\n    });\r\n  }\r\n\r\n  confirmAdd(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\r\n      this.displayDialog = false;\r\n      this.addDate();\r\n    });\r\n  }\r\n\r\n  addDate(): void {\r\n    const formValue = this.addDateForm.value;\r\n\r\n    const newDate: Date = formValue.date;\r\n    const remarks = formValue.remarks;\r\n    const newHolidayDate: IAdmPayroll = {};\r\n\r\n    newHolidayDate.payrollDateInit = newDate;\r\n    newHolidayDate.payrollDate = formatDate(newDate, \"YYYY-MM-dd\", this.localeId);\r\n    newHolidayDate.remarks = remarks;\r\n    newHolidayDate.validity = 'Y';\r\n    newHolidayDate.validityBool = true;\r\n\r\n    if (newDate.getFullYear() === this.currentYear) {\r\n      this.currentYearDatesForm.push(newHolidayDate);\r\n      this.requestList.push(newHolidayDate);\r\n    } else if (newDate.getFullYear() === this.nextYear) {\r\n      this.nextYearDatesForm.push(newHolidayDate);\r\n      this.requestList.push(newHolidayDate);\r\n    } else {\r\n      this.toastService.add({\r\n        severity: 'error',\r\n        summary: 'Invalid Year',\r\n        detail: \"Failed to add new date as year out of range\"\r\n      });\r\n    }\r\n\r\n    this.addDateForm.reset();\r\n  }\r\n\r\n  submitRequest(): void {\r\n    if (this.requestList.length > 0) {\r\n      this.payrollBlackOutService.createUpdate(this.requestList).subscribe(\r\n        (res: HttpResponse<any>) => {\r\n          if (res.ok) {\r\n            this.toastService.add({\r\n              severity: 'success',\r\n              summary: 'Success',\r\n              detail: \"Request has been submitted for approval\"\r\n            });\r\n\r\n            this.refreshComponent();\r\n          }\r\n        },\r\n        (error: HttpErrorResponse) => {\r\n          console.log(error.message);\r\n\r\n          this.toastService.add({\r\n            severity: 'error',\r\n            summary: 'Error',\r\n            detail: error.message\r\n          });\r\n        }\r\n      );\r\n    } else {\r\n      this.toastService.add({\r\n        severity: 'error',\r\n        summary: 'Error',\r\n        detail: \"No changes made\"\r\n      });\r\n    }\r\n  }\r\n\r\n  reset(): void {\r\n    this.copyDataToForm();\r\n  }\r\n\r\n  exportCSV(dataTable: Table): void {\r\n    const data = dataTable._value;\r\n    const columns =[\r\n      {field: 'sn', header: 'SN', index: 0},\r\n      {field: 'payrollDate', header: 'Blackout Date', index: 1},\r\n      {field: 'remarks', header: 'Remarks', index: 2},\r\n      {field: 'validity', header: 'Validity', index: 3}\r\n    ]\r\n\r\n    const dtoList:any[] = [];\r\n    data.forEach((d: IAdmPayroll, index: number) => {\r\n      const dto = {\r\n        sn: index + 1,\r\n        payrollDate: this.dateUtilsService.convertDateToStr(d.payrollDateInit, 'DD-MM-YYYY'),\r\n        remarks: d.remarks,\r\n        validity: d.validity\r\n      }\r\n      dtoList.push(dto);\r\n    });\r\n    this.exportUtilsService.exportCSV(dataTable, dtoList, data.length, columns,\r\n      \"data_\".concat(formatDate(new Date(),\"dd-MM-YYYY\", this.localeId)));\r\n  }\r\n\r\n  protected refreshComponent(): void {\r\n    const currentRoute = this.router.url;\r\n\r\n    this.router.navigateByUrl('/', {skipLocationChange: true}).then(() => {\r\n      this.router.navigate([currentRoute]);\r\n    });\r\n  }\r\n}\r\n","<div class=\"grid\">\r\n  <p-dialog header=\"New Payroll Removal\"\r\n          [(visible)]=\"displayDialog\"\r\n          [draggable]=\"false\"\r\n          [resizable]=\"false\"\r\n          [modal]=\"true\"\r\n          [style]=\"{width: '40%'}\">\r\n    <form [formGroup]=\"addDateForm\">\r\n      <div class=\"field grid\">\r\n        <div class=\"col\">\r\n          <p-calendar id=\"inputDate\"\r\n                      formControlName=\"date\"\r\n                      dateFormat=\"dd-mm-yy\"\r\n                      [readonlyInput]=\"true\"\r\n                      [minDate]=\"minDate\"\r\n                      [maxDate]=\"maxDate\"\r\n                      placeholder=\"Select a date\"\r\n                      appendTo=\"body\"\r\n                      class=\"inputfield w-full\">\r\n          </p-calendar>\r\n        </div>\r\n      </div>\r\n\r\n      <h6>Remarks</h6>\r\n      <div class=\"field grid\">\r\n        <div class=\"col\">\r\n              <textarea pInputTextarea\r\n                        formControlName=\"remarks\"\r\n                        class=\"inputfield w-full\"\r\n                        type=\"text\"\r\n                        rows=\"5\"></textarea>\r\n          <span *ngIf=\"addDateForm.get('remarks')?.hasError('maxlength')\" class=\"p-error\">Max length of 100 characters</span>\r\n          <span *ngIf=\"addDateForm.get('remarks')?.hasError('required') && addDateForm.get('remarks')?.dirty\" class=\"p-error\">Required</span>\r\n        </div>\r\n      </div>\r\n    </form>\r\n\r\n    <ng-template pTemplate=\"footer\">\r\n      <button pButton type=\"button\" label=\"Cancel\" (click)=\"displayDialog = false\" class=\"p-button-danger\"></button>\r\n      <p-confirmPopup key=\"addConfirmPopup\"></p-confirmPopup>\r\n      <button pButton type=\"button\" label=\"Add Date\" (click)=\"confirmAdd($event, 'addConfirmPopup', displayDialog)\" [disabled]=\"!addDateForm.valid\"></button>\r\n    </ng-template>\r\n  </p-dialog>\r\n\r\n  <div class=\"col-6\">\r\n    <p-table #dt [value]=\"currentYearDatesForm\"\r\n             styleClass=\"p-datatable-gridlines\"\r\n             [paginator]=\"true\"\r\n             [rows]=\"10\"\r\n             currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} entries\"\r\n             [showCurrentPageReport]=\"true\"\r\n             [rowsPerPageOptions]=\"[10,25,50]\">\r\n      <ng-template pTemplate=\"caption\">\r\n        <div class=\"flex align-items-center\">\r\n          <button type=\"button\" pButton pRipple icon=\"pi pi-file\" (click)=\"exportCSV(dt)\" class=\"mr-2\" pTooltip=\"CSV\"></button>\r\n          YEAR {{ currentYear }} (Last {{latestCurrentYearDate?.status | status | lowercase}} by {{latestCurrentYearDate?.statusBy}} on {{latestCurrentYearDate?.statusDt | date: 'dd/MM/yyyy'}})\r\n        </div>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"header\">\r\n        <tr>\r\n          <th scope=\"col\">SN</th>\r\n          <th scope=\"col\" pSortableColumn=\"payrollDateInit\">Blackout Date <p-sortIcon field=\"payrollDateInit\"></p-sortIcon> </th>\r\n          <th scope=\"col\" pSortableColumn=\"remarks\">Remarks <p-sortIcon field=\"remarks\"></p-sortIcon></th>\r\n          <th scope=\"col\">Validity</th>\r\n        </tr>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"body\" let-data let-i=\"rowIndex\">\r\n        <tr>\r\n          <td>{{i+1}}</td>\r\n          <td>{{data.payrollDateInit | date: 'dd-MM-yyyy'}}</td>\r\n          <td>{{data.remarks}}</td>\r\n          <td>\r\n            <p-checkbox [(ngModel)]=\"data.validityBool\" [binary]=\"true\"\r\n              [disabled]=\"disablePending\"></p-checkbox>\r\n          </td>\r\n        </tr>\r\n      </ng-template>\r\n    </p-table>\r\n  </div>\r\n\r\n  <div class=\"col-6\">\r\n    <p-table #dt2 [value]=\"nextYearDatesForm\"\r\n             styleClass=\"p-datatable-gridlines\"\r\n             [paginator]=\"true\"\r\n             [rows]=\"10\"\r\n             currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} entries\"\r\n             [showCurrentPageReport]=\"true\"\r\n             [rowsPerPageOptions]=\"[10,25,50]\">\r\n      <ng-template pTemplate=\"caption\">\r\n        <div class=\"flex align-items-center\">\r\n          <button type=\"button\" pButton pRipple icon=\"pi pi-file\" (click)=\"exportCSV(dt2)\" class=\"mr-2\" pTooltip=\"CSV\"></button>\r\n          YEAR {{ nextYear }} (Last {{latestNextYearDate?.status | status | lowercase}} by {{latestNextYearDate?.statusBy}} on {{latestNextYearDate?.statusDt | date: 'dd/MM/yyyy'}})\r\n        </div>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"header\">\r\n        <tr>\r\n          <th scope=\"col\">SN</th>\r\n          <th scope=\"col\" pSortableColumn=\"payrollDateInit\">Blackout Date <p-sortIcon field=\"payrollDateInit\"></p-sortIcon> </th>\r\n          <th scope=\"col\" pSortableColumn=\"remarks\">Remarks <p-sortIcon field=\"remarks\"></p-sortIcon></th>\r\n          <th scope=\"col\">Validity</th>\r\n        </tr>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"body\" let-data let-i=\"rowIndex\">\r\n        <tr>\r\n          <td>{{i+1}}</td>\r\n          <td>{{data.payrollDateInit | date: 'dd-MM-yyyy'}}</td>\r\n          <td>{{data.remarks}}</td>\r\n          <td>\r\n            <p-checkbox [(ngModel)]=\"data.validityBool\" [binary]=\"true\"\r\n              [disabled]=\"disablePending\"></p-checkbox>\r\n          </td>\r\n        </tr>\r\n      </ng-template>\r\n    </p-table>\r\n  </div>\r\n</div>\r\n\r\n<div *ngIf=\"!disablePending\" class=\"flex justify-content-end align-items-center\">\r\n  <div>\r\n    <button pButton type=\"button\" label=\"Add Date\" (click)=\"showAddDialog()\" class=\"p-button-secondary\"></button>\r\n    <button pButton type=\"button\" label=\"Cancel\" (click)=\"reset()\" class=\"p-button-danger\"></button>\r\n    <p-confirmPopup key=\"submitConfirmPopup\"></p-confirmPopup>\r\n    <button pButton type=\"button\" label=\"Submit\" (click)=\"confirm($event, 'submitConfirmPopup')\"></button>\r\n  </div>\r\n</div>"]},"metadata":{},"sourceType":"script","externalDependencies":[]}