{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.IcMenuService = void 0;\nconst tslib_1 = require(\"tslib\");\nconst _ = tslib_1.__importStar(require(\"lodash\"));\nconst rxjs_1 = require(\"rxjs\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"@angular/router\"));\nclass IcMenuService {\n  constructor(_router) {\n    this._router = _router;\n    this.menuItems = new rxjs_1.BehaviorSubject([]);\n    this._currentMenuItem = {};\n  }\n  /**\r\n   * Updates the routes in the menu\r\n   *\r\n   * @param {Routes} routes Type compatible with app.menu.ts\r\n   */\n  updateMenuByRoutes(routes) {\n    const convertedRoutes = this.convertRoutesToMenus(_.cloneDeep(routes));\n    this.menuItems.next(convertedRoutes);\n  }\n  convertRoutesToMenus(routes) {\n    const items = this._convertArrayToItems(routes);\n    return this._skipEmpty(items);\n  }\n  getCurrentItem() {\n    return this._currentMenuItem;\n  }\n  selectMenuItem(menuItems) {\n    const items = [];\n    menuItems.forEach(item => {\n      this._selectItem(item);\n      if (item.selected) {\n        this._currentMenuItem = item;\n      }\n      if (item.submenus && item.submenus.length > 0) {\n        item.submenus = this.selectMenuItem(item.submenus);\n      }\n      items.push(item);\n    });\n    return items;\n  }\n  _skipEmpty(items) {\n    const menu = [];\n    items.forEach(item => {\n      let menuItem;\n      if (item.skip) {\n        if (item.submenus && item.submenus.length > 0) {\n          menuItem = item;\n        }\n      } else {\n        menuItem = item;\n      }\n      if (menuItem) {\n        menu.push(menuItem);\n      }\n    });\n    // eslint-disable-next-line prefer-spread\n    return [].concat.apply([], menu);\n  }\n  _convertArrayToItems(routes, parent) {\n    const items = [];\n    routes.forEach(route => {\n      items.push(this._convertObjectToItem(route, parent));\n    });\n    return items;\n  }\n  _convertObjectToItem(object, parent) {\n    let item = {};\n    if (object.data && object.data.menu) {\n      // this is a menu object\n      item = object.data.menu;\n      item.route = object;\n      delete item.route.data.menu;\n    } else {\n      item.route = object;\n      item.skip = true;\n    }\n    // we have to collect all paths to correctly build the url then\n    if (Array.isArray(item.route.url)) {\n      item.route.paths = item.route.url;\n    } else {\n      item.route.paths = parent?.route?.paths ? parent.route.paths.slice(0) : ['/'];\n      if (item.route.url) {\n        item.route.paths.push(item.route.url);\n      }\n    }\n    if (object.submenus && object.submenus.length > 0) {\n      item.submenus = this._convertArrayToItems(object.submenus, item);\n    }\n    const prepared = this._prepareItem(item);\n    // if current item is selected or expanded - then parent is expanded too\n    if ((prepared.selected || prepared.expanded) && parent) {\n      parent.expanded = true;\n    }\n    return prepared;\n  }\n  _prepareItem(object) {\n    if (!object.skip) {\n      object.target = object.target || '';\n      object.pathMatch = object.pathMatch || 'full';\n      return this._selectItem(object);\n    }\n    return object;\n  }\n  _selectItem(object) {\n    object.selected = this._router.isActive(this._router.createUrlTree(object.route.paths), object.pathMatch === 'full');\n    return object;\n  }\n}\nexports.IcMenuService = IcMenuService;\nIcMenuService.ɵfac = function IcMenuService_Factory(t) {\n  return new (t || IcMenuService)(i0.ɵɵinject(i1.Router));\n};\nIcMenuService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: IcMenuService,\n  factory: IcMenuService.ɵfac\n});","map":{"version":3,"mappings":"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","names":["IcMenuService","constructor","_router","rxjs_1","updateMenuByRoutes","routes","convertedRoutes","convertRoutesToMenus","_","cloneDeep","menuItems","next","items","_convertArrayToItems","_skipEmpty","getCurrentItem","_currentMenuItem","selectMenuItem","forEach","item","_selectItem","selected","submenus","length","push","menu","menuItem","skip","concat","apply","parent","route","_convertObjectToItem","object","data","Array","isArray","url","paths","slice","prepared","_prepareItem","expanded","target","pathMatch","isActive","createUrlTree","exports","factory"],"sourceRoot":"","sources":["C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\layouts\\sidebar\\menu\\services\\menu-service\\menu.service.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/prefer-optional-chain */\r\n/* eslint-disable @typescript-eslint/no-unnecessary-condition */\r\n/* eslint-disable @typescript-eslint/no-unsafe-return */\r\nimport { Injectable } from '@angular/core';\r\nimport { Router, Routes } from '@angular/router';\r\nimport * as _ from 'lodash';\r\n\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Injectable()\r\nexport class IcMenuService {\r\n  menuItems = new BehaviorSubject<any[]>([]);\r\n\r\n  protected _currentMenuItem = {};\r\n\r\n  constructor(private _router: Router) {}\r\n\r\n  /**\r\n   * Updates the routes in the menu\r\n   *\r\n   * @param {Routes} routes Type compatible with app.menu.ts\r\n   */\r\n  public updateMenuByRoutes(routes: Routes): void {\r\n    const convertedRoutes = this.convertRoutesToMenus(_.cloneDeep(routes));\r\n    this.menuItems.next(convertedRoutes);\r\n  }\r\n\r\n  public convertRoutesToMenus(routes: Routes): any[] {\r\n    const items = this._convertArrayToItems(routes);\r\n    return this._skipEmpty(items);\r\n  }\r\n\r\n  public getCurrentItem(): any {\r\n    return this._currentMenuItem;\r\n  }\r\n\r\n  public selectMenuItem(menuItems: any[]): any[] {\r\n    const items: any[] = [];\r\n    menuItems.forEach(item => {\r\n      this._selectItem(item);\r\n\r\n      if (item.selected) {\r\n        this._currentMenuItem = item;\r\n      }\r\n\r\n      if (item.submenus && item.submenus.length > 0) {\r\n        item.submenus = this.selectMenuItem(item.submenus);\r\n      }\r\n      items.push(item);\r\n    });\r\n    return items;\r\n  }\r\n\r\n  protected _skipEmpty(items: any[]): any[] {\r\n    const menu: any[] = [];\r\n    items.forEach(item => {\r\n      let menuItem;\r\n      if (item.skip) {\r\n        if (item.submenus && item.submenus.length > 0) {\r\n          menuItem = item;\r\n        }\r\n      } else {\r\n        menuItem = item;\r\n      }\r\n\r\n      if (menuItem) {\r\n        menu.push(menuItem);\r\n      }\r\n    });\r\n\r\n    // eslint-disable-next-line prefer-spread\r\n    return [].concat.apply([], menu);\r\n  }\r\n\r\n  protected _convertArrayToItems(routes: any[], parent?: any): any[] {\r\n    const items: any[] = [];\r\n    routes.forEach(route => {\r\n      items.push(this._convertObjectToItem(route, parent));\r\n    });\r\n    return items;\r\n  }\r\n\r\n  protected _convertObjectToItem(object: { data: { menu: any }; submenus: string | any[] }, parent?: any): any {\r\n    let item: any = {};\r\n    if (object.data && object.data.menu) {\r\n      // this is a menu object\r\n      item = object.data.menu;\r\n      item.route = object;\r\n      delete item.route.data.menu;\r\n    } else {\r\n      item.route = object;\r\n      item.skip = true;\r\n    }\r\n\r\n    // we have to collect all paths to correctly build the url then\r\n    if (Array.isArray(item.route.url)) {\r\n      item.route.paths = item.route.url;\r\n    } else {\r\n      item.route.paths = parent?.route?.paths ? parent.route.paths.slice(0) : ['/'];\r\n      if (item.route.url) {\r\n        item.route.paths.push(item.route.url);\r\n      }\r\n    }\r\n\r\n    if (object.submenus && object.submenus.length > 0) {\r\n      item.submenus = this._convertArrayToItems(object.submenus as any, item);\r\n    }\r\n\r\n    const prepared = this._prepareItem(item);\r\n\r\n    // if current item is selected or expanded - then parent is expanded too\r\n    if ((prepared.selected || prepared.expanded) && parent) {\r\n      parent.expanded = true;\r\n    }\r\n\r\n    return prepared;\r\n  }\r\n\r\n  protected _prepareItem(object: any): any {\r\n    if (!object.skip) {\r\n      object.target = object.target || '';\r\n      object.pathMatch = object.pathMatch || 'full';\r\n      return this._selectItem(object);\r\n    }\r\n\r\n    return object;\r\n  }\r\n\r\n  protected _selectItem(object: any): any {\r\n    object.selected = this._router.isActive(this._router.createUrlTree(object.route.paths), object.pathMatch === 'full');\r\n    return object;\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}