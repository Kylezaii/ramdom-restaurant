{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.InstalmentCreateComponent = void 0;\nconst tslib_1 = require(\"tslib\");\nconst forms_1 = require(\"@angular/forms\");\nconst http_1 = require(\"@angular/common/http\");\nconst fileupload2_directive_1 = require(\"app/shared/validator/fileupload2.directive\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"@angular/forms\"));\nconst i2 = tslib_1.__importStar(require(\"@angular/router\"));\nconst i3 = tslib_1.__importStar(require(\"app/shared/confirm/nsp-confirm.service\"));\nconst i4 = tslib_1.__importStar(require(\"app/layouts/service/customtoast.service\"));\nconst i5 = tslib_1.__importStar(require(\"app/payment/instalment/service/instalment.service\"));\nconst i6 = tslib_1.__importStar(require(\"app/payment/overpayment/service/payment.service\"));\nconst i7 = tslib_1.__importStar(require(\"@angular/common\"));\nconst i8 = tslib_1.__importStar(require(\"primeng/api\"));\nconst i9 = tslib_1.__importStar(require(\"primeng/button\"));\nconst i10 = tslib_1.__importStar(require(\"primeng/tooltip\"));\nconst i11 = tslib_1.__importStar(require(\"primeng/table\"));\nconst i12 = tslib_1.__importStar(require(\"primeng/dialog\"));\nconst i13 = tslib_1.__importStar(require(\"primeng/confirmpopup\"));\nconst i14 = tslib_1.__importStar(require(\"primeng/calendar\"));\nconst i15 = tslib_1.__importStar(require(\"primeng/inputnumber\"));\nconst i16 = tslib_1.__importStar(require(\"../../../shared/component/file-upload/file-upload.component\"));\nconst i17 = tslib_1.__importStar(require(\"primeng/panel\"));\nconst i18 = tslib_1.__importStar(require(\"primeng/ripple\"));\nconst i19 = tslib_1.__importStar(require(\"../instalment-create-generate-email/instalment-create-generate-email.component\"));\nconst i20 = tslib_1.__importStar(require(\"../../../shared/pipe/default-string.pipe\"));\nconst _c0 = [\"createGenerateEmailComponent\"];\nconst _c1 = [\"approvalEmailFileUpload\"];\nconst _c2 = [\"nsmanLetterFileUpload\"];\nconst _c3 = [\"bankLetterFileUpload\"];\nfunction InstalmentCreateComponent_span_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 53);\n    i0.ɵɵtext(1, \"Required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction InstalmentCreateComponent_span_49_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 53);\n    i0.ɵɵtext(1, \"Required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction InstalmentCreateComponent_p_table_58_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"div\", 10);\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵelementStart(3, \"button\", 59);\n    i0.ɵɵlistener(\"click\", function InstalmentCreateComponent_p_table_58_ng_template_2_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.exportCSV());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"\\n            \");\n    i0.ɵɵelementStart(5, \"span\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"defaultString\");\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n        \");\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\"Estimated Plan Computed on \", i0.ɵɵpipeBind1(7, 1, i0.ɵɵpipeBind2(8, 3, ctx_r8.computedInstalmentPlan.computedDate, \"dd-MM-yyyy\")), \"\");\n  }\n}\nfunction InstalmentCreateComponent_p_table_58_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵelementStart(3, \"th\", 60);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n            \");\n    i0.ɵɵelementStart(6, \"th\", 61);\n    i0.ɵɵtext(7, \"Month\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n            \");\n    i0.ɵɵelementStart(9, \"th\", 61);\n    i0.ɵɵtext(10, \"Principal O/S\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n            \");\n    i0.ɵɵelementStart(12, \"th\", 61);\n    i0.ɵɵtext(13, \"Payment Per Month\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n            \");\n    i0.ɵɵelementStart(15, \"th\", 61);\n    i0.ɵɵtext(16, \"Interest Per Month\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n        \");\n  }\n}\nfunction InstalmentCreateComponent_p_table_58_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n            \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"defaultString\");\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n            \");\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12);\n    i0.ɵɵpipe(13, \"defaultString\");\n    i0.ɵɵpipe(14, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15, \"\\n            \");\n    i0.ɵɵelementStart(16, \"td\");\n    i0.ɵɵtext(17);\n    i0.ɵɵpipe(18, \"defaultString\");\n    i0.ɵɵpipe(19, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(20, \"\\n            \");\n    i0.ɵɵelementStart(21, \"td\");\n    i0.ɵɵtext(22);\n    i0.ɵɵpipe(23, \"defaultString\");\n    i0.ɵɵpipe(24, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(25, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(26, \"\\n        \");\n  }\n  if (rf & 2) {\n    const computedInstalmentPayment_r14 = ctx.$implicit;\n    const i_r15 = ctx.rowIndex;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r15 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 5, i0.ɵɵpipeBind2(9, 7, computedInstalmentPayment_r14 == null ? null : computedInstalmentPayment_r14.paymentMonth, \"MM-yyyy\")));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(13, 10, i0.ɵɵpipeBind3(14, 12, computedInstalmentPayment_r14 == null ? null : computedInstalmentPayment_r14.principalOSBalance, \"SGD\", \"\")));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(18, 16, i0.ɵɵpipeBind3(19, 18, computedInstalmentPayment_r14 == null ? null : computedInstalmentPayment_r14.paymentAmount, \"SGD\", \"\")));\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(23, 22, i0.ɵɵpipeBind3(24, 24, computedInstalmentPayment_r14 == null ? null : computedInstalmentPayment_r14.interestAmount, \"SGD\", \"\")));\n  }\n}\nfunction InstalmentCreateComponent_p_table_58_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵelementStart(3, \"td\", 62);\n    i0.ɵɵtext(4, \"No Computed Instalment Payments\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n        \");\n  }\n}\nconst _c4 = function () {\n  return [10, 25, 50];\n};\nfunction InstalmentCreateComponent_p_table_58_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p-table\", 54);\n    i0.ɵɵtext(1, \"\\n        \");\n    i0.ɵɵtemplate(2, InstalmentCreateComponent_p_table_58_ng_template_2_Template, 11, 6, \"ng-template\", 55);\n    i0.ɵɵtext(3, \"\\n        \");\n    i0.ɵɵtemplate(4, InstalmentCreateComponent_p_table_58_ng_template_4_Template, 19, 0, \"ng-template\", 56);\n    i0.ɵɵtext(5, \"\\n        \");\n    i0.ɵɵtemplate(6, InstalmentCreateComponent_p_table_58_ng_template_6_Template, 27, 28, \"ng-template\", 57);\n    i0.ɵɵtext(7, \"\\n\\n        \");\n    i0.ɵɵtemplate(8, InstalmentCreateComponent_p_table_58_ng_template_8_Template, 7, 0, \"ng-template\", 58);\n    i0.ɵɵtext(9, \"\\n      \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", ctx_r2.computedInstalmentPlan.instalmentComputedPaymentList)(\"paginator\", true)(\"rows\", 10)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(5, _c4))(\"showCurrentPageReport\", true);\n  }\n}\nfunction InstalmentCreateComponent_ng_template_205_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n  \");\n  }\n}\nconst _c5 = function () {\n  return {\n    \"width\": \"0%\"\n  };\n};\nconst _c6 = function () {\n  return {\n    width: \"50vw\"\n  };\n};\nconst _c7 = function () {\n  return {\n    \"960px\": \"75vw\"\n  };\n};\nclass InstalmentCreateComponent {\n  constructor(fb, route, router, nspConfirmService, toastService, instalmentService, paymentService) {\n    this.fb = fb;\n    this.route = route;\n    this.router = router;\n    this.nspConfirmService = nspConfirmService;\n    this.toastService = toastService;\n    this.instalmentService = instalmentService;\n    this.paymentService = paymentService;\n    this.previousUrl = \"\";\n    this.displayGenerateApprovalEmailDialog = {\n      display: false\n    };\n    this.disableSaveButton = true;\n    this.todayDate = new Date();\n    this.firstDayOfNextMonth = new Date(this.todayDate.getFullYear(), this.todayDate.getMonth() + 1, 1);\n    this.fileUploadFileLimit = 1;\n    this.interestRate = 5.5;\n    this.summary = {\n      nric: '',\n      name: '',\n      rank: '',\n      sex: '',\n      csn: '',\n      principalOS: 0,\n      interestOS: 0,\n      protectedPayableInd: '',\n      protectedPayableSPInd: '',\n      instalmentInd: '',\n      cabInd: ''\n    };\n    this.computeInstalmentForm = this.fb.group({\n      monthlyAmount: new forms_1.FormControl(null, [forms_1.Validators.required, forms_1.Validators.min(1)]),\n      effectiveDate: new forms_1.FormControl(this.firstDayOfNextMonth, forms_1.Validators.required),\n      compInterestRate: new forms_1.FormControl(this.interestRate, forms_1.Validators.required)\n    });\n    this.instalmentSuppDocsForm = this.fb.group({\n      approvalEmail: new forms_1.FormControl([], [fileupload2_directive_1.FileUploadValidator2.maxFileLimit(this.fileUploadFileLimit), fileupload2_directive_1.FileUploadValidator2.allowableExtension(\".pdf\")]),\n      nsManLetter: new forms_1.FormControl([], [fileupload2_directive_1.FileUploadValidator2.maxFileLimit(this.fileUploadFileLimit), fileupload2_directive_1.FileUploadValidator2.allowableExtension(\".pdf\")]),\n      bankLetter: new forms_1.FormControl([], [fileupload2_directive_1.FileUploadValidator2.maxFileLimit(this.fileUploadFileLimit), fileupload2_directive_1.FileUploadValidator2.allowableExtension(\".pdf\")])\n    });\n    this.instalmentSuppDocsSentDatesForm = this.fb.group({\n      approvalEmailSentDate: new forms_1.FormControl(null),\n      letterNSmanSentDate: new forms_1.FormControl(null),\n      letterBankSentDate: new forms_1.FormControl(null)\n    });\n    this.previousUrl = this.router.getCurrentNavigation().previousNavigation.finalUrl.toString();\n  }\n  ngOnInit() {\n    // TODO: Call parameters endpoint to retrieve prevailing interest rate\n    this.route.params.subscribe(params => {\n      const nric = params['nric'];\n      this.loadSummary(nric);\n      // Pre-populate the create form if a draft of Create Instalment exists\n      this.instalmentService.getDraftInstalmentByNSman(params['nric']).subscribe(draftInstalmentRes => {\n        if (draftInstalmentRes.body && draftInstalmentRes.body.data) {\n          this.latestDraftInstalment = draftInstalmentRes.body.data;\n          if (this.latestDraftInstalment) {\n            // Perform pre-population\n            this.computedInstalmentPlan = this.latestDraftInstalment;\n            if (this.latestDraftInstalment.instalmentComputedPaymentList?.length > 0) {\n              this.disableSaveButton = false;\n            }\n            this.computeInstalmentForm.patchValue({\n              monthlyAmount: this.latestDraftInstalment.monthlyAmount,\n              effectiveDate: new Date(this.latestDraftInstalment.effectiveDate),\n              compInterestRate: this.latestDraftInstalment.compInterestRate\n            });\n            if (this.latestDraftInstalment.approvalEmailSentDate) {\n              this.instalmentSuppDocsSentDatesForm.patchValue({\n                approvalEmailSentDate: new Date(this.latestDraftInstalment.approvalEmailSentDate)\n              });\n            }\n            if (this.latestDraftInstalment.letterNSmanSentDate) {\n              this.instalmentSuppDocsSentDatesForm.patchValue({\n                letterNSmanSentDate: new Date(this.latestDraftInstalment.letterNSmanSentDate)\n              });\n            }\n            if (this.latestDraftInstalment.letterBankSentDate) {\n              this.instalmentSuppDocsSentDatesForm.patchValue({\n                letterBankSentDate: new Date(this.latestDraftInstalment.letterBankSentDate)\n              });\n            }\n            // TODO: Left pre-population of already uploaded DMS files\n            console.log(\"draft\", this.latestDraftInstalment);\n            if (this.latestDraftInstalment.supportingDocs?.length > 0) {\n              const approvalEmailIds = this.latestDraftInstalment.supportingDocs?.filter(d => d.documentType === \"APP\").map(doc => doc.documentId);\n              this.approvalEmailFileUploadComponent.preloadFiles(approvalEmailIds);\n              const nsmanLetterIds = this.latestDraftInstalment.supportingDocs?.filter(d => d.documentType === \"NSM\").map(doc => doc.documentId);\n              this.nsmanLetterFileUploadComponent.preloadFiles(nsmanLetterIds);\n              const bankLetterIds = this.latestDraftInstalment.supportingDocs?.filter(d => d.documentType === \"BNK\").map(doc => doc.documentId);\n              this.bankLetterFileUploadComponent.preloadFiles(bankLetterIds);\n            }\n          }\n        }\n      });\n    });\n  }\n  isFormValid() {\n    return this.computeInstalmentForm.valid && !this.disableSaveButton && this.bankLetterFileUploadComponent.verifiedFiles.length > 0 && this.approvalEmailFileUploadComponent.verifiedFiles.length > 0 && this.nsmanLetterFileUploadComponent.verifiedFiles.length > 0;\n  }\n  loadSummary(nric) {\n    this.paymentService.getSummaryByNric(nric).subscribe(summaryRes => {\n      this.summary = summaryRes.body.data;\n    });\n  }\n  onSubmit(event, key, dialog) {\n    // Log\n    this.debugAllForms();\n    this.nspConfirmService.onConfirmPopup(event, key, dialog);\n  }\n  // Create instalment plan\n  onSubmitCreate(event, key) {\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\n      this.createInstalmentPlan();\n    });\n  }\n  // Generate approval email\n  onSubmitGenerateApprovalEmail(dialog) {\n    dialog.display = true;\n    this.instalmentCreateGenerateEmailComponent.generate();\n  }\n  onSave(event, key) {\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\n      this.saveDraftInstalmentPlan();\n    });\n  }\n  saveDraftInstalmentPlan() {\n    const approvalEmail = this.approvalEmailFileUploadComponent.verifiedFiles?.map(x => String(x.meta_data.id))[0];\n    const nsmanLetter = this.nsmanLetterFileUploadComponent.verifiedFiles?.map(x => String(x.meta_data.id))[0];\n    const bankLetter = this.bankLetterFileUploadComponent.verifiedFiles?.map(x => String(x.meta_data.id))[0];\n    const instalmentPlanToSave = {\n      nric: this.summary.nric,\n      monthlyAmount: this.computeInstalmentForm.get('monthlyAmount')?.value,\n      effectiveDate: this.computeInstalmentForm.get('effectiveDate')?.value,\n      computedDate: new Date(this.computedInstalmentPlan.computedDate).toISOString(),\n      compInterestRate: this.computeInstalmentForm.get('compInterestRate')?.value,\n      approvalEmailSentDate: this.instalmentSuppDocsSentDatesForm.get('approvalEmailSentDate')?.value,\n      letterNSmanSentDate: this.instalmentSuppDocsSentDatesForm.get('letterNSmanSentDate')?.value,\n      letterBankSentDate: this.instalmentSuppDocsSentDatesForm.get('letterBankSentDate')?.value,\n      instalmentComputedPaymentList: this.computedInstalmentPlan.instalmentComputedPaymentList,\n      approvalEmailDocument: approvalEmail,\n      nsManReturnLetterDocument: nsmanLetter,\n      bankReturnLetterDocument: bankLetter,\n      isEditRejected: false\n    };\n    console.log(\"instalmentPlanToSave\", instalmentPlanToSave);\n    // Call API endpoint to persist draft of Instalment Plan into database\n    this.instalmentService.saveDraftInstalmentPlan(instalmentPlanToSave).subscribe(saveDraftRes => {\n      if (saveDraftRes.body && saveDraftRes.body.data) {\n        this.toastService.success('Successfully saved draft of Instalment Plan');\n      }\n    }, error => {\n      console.log(error.message);\n      if (error.status === 404 /* HttpStatusCode.NotFound */) {\n        this.toastService.error('Error saving draft of Instalment Plan with given parameters');\n      }\n    });\n  }\n  onCompute(event, key) {\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\n      this.computeInterestPlan();\n    });\n  }\n  computeInterestPlan() {\n    const instalmentPlanToCompute = {\n      monthlyAmount: this.computeInstalmentForm.get('monthlyAmount')?.value,\n      effectiveDate: this.computeInstalmentForm.get('effectiveDate')?.value,\n      compInterestRate: this.computeInstalmentForm.get('compInterestRate')?.value,\n      nric: this.summary.nric\n    };\n    // Call API endpoint to compute an Instalment Plan\n    this.instalmentService.computePaymentPlan(instalmentPlanToCompute).subscribe(res => {\n      // Pipe response to an array of Interface model\n      this.computedInstalmentPlan = res.body.data;\n      if (this.computedInstalmentPlan.instalmentComputedPaymentList?.length > 0) {\n        this.disableSaveButton = false;\n      }\n    }, error => {\n      console.log(error.message);\n      if (error.status === 404 /* HttpStatusCode.NotFound */) {\n        this.toastService.add({\n          severity: 'error',\n          summary: 'Error',\n          detail: 'Error computing an Instalment Plan with given parameters'\n        });\n      }\n    });\n  }\n  // Create Instalment Plan\n  createInstalmentPlan() {\n    // TODO DMS integration only pass file id\n    const approvalEmail = this.approvalEmailFileUploadComponent.verifiedFiles.map(x => String(x.meta_data.id))[0];\n    const nsmanLetter = this.nsmanLetterFileUploadComponent.verifiedFiles.map(x => String(x.meta_data.id))[0];\n    const bankLetter = this.bankLetterFileUploadComponent.verifiedFiles.map(x => String(x.meta_data.id))[0];\n    const instalmentPlan = {\n      id: this.computedInstalmentPlan.id,\n      nric: this.summary.nric,\n      monthlyAmount: this.computeInstalmentForm.get('monthlyAmount')?.value,\n      effectiveDate: this.computeInstalmentForm.get('effectiveDate')?.value,\n      computedDate: new Date(this.computedInstalmentPlan.computedDate).toISOString(),\n      compInterestRate: this.computeInstalmentForm.get('compInterestRate')?.value,\n      approvalEmailSentDate: this.instalmentSuppDocsSentDatesForm.get('approvalEmailSentDate')?.value,\n      letterNSmanSentDate: this.instalmentSuppDocsSentDatesForm.get('letterNSmanSentDate')?.value,\n      letterBankSentDate: this.instalmentSuppDocsSentDatesForm.get('letterBankSentDate')?.value,\n      instalmentComputedPaymentList: this.computedInstalmentPlan.instalmentComputedPaymentList,\n      approvalEmailDocument: approvalEmail,\n      nsManReturnLetterDocument: nsmanLetter,\n      bankReturnLetterDocument: bankLetter,\n      isEditRejected: false\n    };\n    this.instalmentService.create(instalmentPlan).subscribe(res => {\n      if (res) {\n        this.toastService.success(\"Instalment created succesfully\");\n        this.router.navigate([this.previousUrl]);\n      }\n    }, error => {\n      this.toastService.error(error.error?.error_desc);\n    });\n  }\n  // Pop up the Confirmation dialog to Cancel current transaction\n  onCancel(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\n      // Define function that will be called upon confirmation of the cancellation dialog\n      // Will route back to Inbox upon cancellation in this case\n      this.router.navigate([this.previousUrl]);\n    });\n  }\n  exportCSV() {\n    // TODO: Implement export CSV function or call it from a utility class\n  }\n  debugAllForms() {\n    console.log(\"computeInstalmentForm\", this.computeInstalmentForm);\n    console.log(\"instalmentSuppDocsForm\", this.instalmentSuppDocsForm);\n    console.log(\"instalmentSuppDocsSentDatesForm\", this.instalmentSuppDocsSentDatesForm);\n  }\n}\nexports.InstalmentCreateComponent = InstalmentCreateComponent;\nInstalmentCreateComponent.ɵfac = function InstalmentCreateComponent_Factory(t) {\n  return new (t || InstalmentCreateComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.NspConfirmationService), i0.ɵɵdirectiveInject(i4.CustomToastService), i0.ɵɵdirectiveInject(i5.InstalmentService), i0.ɵɵdirectiveInject(i6.PaymentService));\n};\nInstalmentCreateComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: InstalmentCreateComponent,\n  selectors: [[\"n2-instalment-create\"]],\n  viewQuery: function InstalmentCreateComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n      i0.ɵɵviewQuery(_c1, 5);\n      i0.ɵɵviewQuery(_c2, 5);\n      i0.ɵɵviewQuery(_c3, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.instalmentCreateGenerateEmailComponent = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.approvalEmailFileUploadComponent = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.nsmanLetterFileUploadComponent = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.bankLetterFileUploadComponent = _t.first);\n    }\n  },\n  decls: 208,\n  vars: 76,\n  consts: [[1, \"grid\"], [1, \"col-6\", \"flex\"], [\"header\", \"Create Instalment\", 1, \"flex-auto\", \"flex\", \"create-instalment\"], [3, \"formGroup\"], [1, \"col-5\", \"flex\", \"align-items-center\", \"gap-2\"], [1, \"flex-shrink-0\"], [\"formControlName\", \"monthlyAmount\", \"id\", \"monthlyAmount\", \"currency\", \"SGD\", 3, \"inputStyle\", \"minFractionDigits\", \"maxFractionDigits\", \"max\"], [1, \"col-3\", \"flex\", \"align-items-center\", \"gap-2\"], [\"formControlName\", \"effectiveDate\", \"id\", \"effectiveDate\", \"view\", \"month\", \"dateFormat\", \"mm-yy\", 1, \"computationCalendar\", 3, \"inputStyle\", \"minDate\"], [1, \"col-4\", \"flex\", \"align-items-center\", \"gap-2\", \"justify-content-between\"], [1, \"flex\", \"align-items-center\", \"gap-2\"], [\"formControlName\", \"compInterestRate\", \"id\", \"compInterestRate\", \"currency\", \"SGD\", 3, \"inputStyle\", \"disabled\", \"minFractionDigits\", \"maxFractionDigits\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Compute\", 1, \"flex-shrink-0\", 3, \"disabled\", \"click\"], [1, \"col-5\", \"flex\", \"justify-content-end\"], [\"class\", \"p-error\", 4, \"ngIf\"], [1, \"col-3\", \"flex\", \"justify-content-end\"], [\"key\", \"computeInterest\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"paginator\", \"rows\", \"rowsPerPageOptions\", \"showCurrentPageReport\", 4, \"ngIf\"], [1, \"col-6\"], [1, \"flex\", \"flex-column\", \"gap-2\"], [\"header\", \"Personal Particulars\"], [1, \"particulars\"], [\"header\", \"Supporting Documents\"], [1, \"flex\", \"gap-4\"], [1, \"flex\", \"flex-column\", \"justify-content-around\", \"gap-2\"], [1, \"flex-auto\", \"flex\", \"flex-column\", \"justify-content-around\", \"gap-2\"], [\"formControlName\", \"approvalEmail\", \"id\", \"approvalEmail\", 3, \"contentHeight\", \"externalFileLimit\"], [\"approvalEmailFileUpload\", \"\"], [\"formControlName\", \"nsManLetter\", \"id\", \"nsManLetter\", 3, \"contentHeight\", \"externalFileLimit\"], [\"nsmanLetterFileUpload\", \"\"], [\"formControlName\", \"bankLetter\", \"id\", \"bankLetter\", 3, \"contentHeight\", \"externalFileLimit\"], [\"bankLetterFileUpload\", \"\"], [\"key\", \"generateNSmanLetter\"], [\"key\", \"generateBankLetter\"], [1, \"flex\", \"justify-content-between\"], [1, \"flex\", \"gap-2\"], [1, \"flex\", \"flex-column\", \"gap-1\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Generate Approval Email\", 3, \"click\"], [\"placeholder\", \"Select sent date\", \"appendTo\", \"body\", \"formControlName\", \"approvalEmailSentDate\", \"dateFormat\", \"dd-mm-yy\", 1, \"flex\", \"nsManLetterCalendar\", 3, \"inputStyle\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Generate Letter for NSman\", 3, \"click\"], [\"placeholder\", \"Select sent date\", \"appendTo\", \"body\", \"formControlName\", \"letterNSmanSentDate\", \"dateFormat\", \"dd-mm-yy\", 1, \"flex\", \"nsManLetterCalendar\", 3, \"inputStyle\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Generate Letter for Bank\", 3, \"click\"], [\"placeholder\", \"Select sent date\", \"appendTo\", \"body\", \"formControlName\", \"letterBankSentDate\", \"dateFormat\", \"dd-mm-yy\", 1, \"flex\", \"nsManLetterCalendar\", 3, \"inputStyle\"], [1, \"flex\", \"align-items-start\", \"justify-content-end\", \"gap-2\"], [\"key\", \"createInstalmentCancel\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Cancel\", 1, \"p-button-danger\", 3, \"click\"], [\"key\", \"createInstalmentSave\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Save\", 1, \"p-button-outlined\", 3, \"disabled\", \"click\"], [\"key\", \"createInstalmentSubmit\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Submit\", 3, \"disabled\", \"click\"], [\"header\", \"Approval Email\", 3, \"visible\", \"breakpoints\", \"draggable\", \"resizable\", \"modal\", \"visibleChange\"], [\"createGenerateEmailComponent\", \"\"], [\"pTemplate\", \"footer\"], [1, \"p-error\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"paginator\", \"rows\", \"rowsPerPageOptions\", \"showCurrentPageReport\"], [\"pTemplate\", \"caption\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"emptymessage\"], [\"type\", \"button\", \"pButton\", \"\", \"pRipple\", \"\", \"icon\", \"pi pi-file\", \"pTooltip\", \"Export as CSV\", \"tooltipPosition\", \"bottom\", 3, \"click\"], [\"scope\", \"col\", 2, \"width\", \"10%\"], [\"scope\", \"col\"], [\"colspan\", \"5\"]],\n  template: function InstalmentCreateComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelementStart(2, \"div\", 1);\n      i0.ɵɵtext(3, \"\\n    \");\n      i0.ɵɵelementStart(4, \"p-panel\", 2);\n      i0.ɵɵtext(5, \"\\n      \");\n      i0.ɵɵelementStart(6, \"form\", 3);\n      i0.ɵɵtext(7, \"\\n        \");\n      i0.ɵɵelementStart(8, \"div\", 0);\n      i0.ɵɵtext(9, \"\\n          \");\n      i0.ɵɵelementStart(10, \"div\", 4);\n      i0.ɵɵtext(11, \"\\n            \");\n      i0.ɵɵelementStart(12, \"span\", 5);\n      i0.ɵɵtext(13, \"Monthly Instalment Amount\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(14, \"\\n            \");\n      i0.ɵɵelement(15, \"p-inputNumber\", 6);\n      i0.ɵɵtext(16, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(17, \"\\n          \");\n      i0.ɵɵelementStart(18, \"div\", 7);\n      i0.ɵɵtext(19, \"\\n            \");\n      i0.ɵɵelementStart(20, \"span\", 5);\n      i0.ɵɵtext(21, \"First Month\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(22, \"\\n            \");\n      i0.ɵɵelement(23, \"p-calendar\", 8);\n      i0.ɵɵtext(24, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(25, \"\\n          \");\n      i0.ɵɵelementStart(26, \"div\", 9);\n      i0.ɵɵtext(27, \"\\n            \");\n      i0.ɵɵelementStart(28, \"div\", 10);\n      i0.ɵɵtext(29, \"\\n              \");\n      i0.ɵɵelementStart(30, \"span\", 5);\n      i0.ɵɵtext(31, \"Interest Rate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(32, \"\\n              \");\n      i0.ɵɵelement(33, \"p-inputNumber\", 11);\n      i0.ɵɵtext(34, \"\\n            \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(35, \"\\n            \");\n      i0.ɵɵelementStart(36, \"button\", 12);\n      i0.ɵɵlistener(\"click\", function InstalmentCreateComponent_Template_button_click_36_listener($event) {\n        return ctx.onCompute($event, \"computeInterest\");\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(37, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(38, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(39, \"\\n        \");\n      i0.ɵɵelementStart(40, \"div\", 0);\n      i0.ɵɵtext(41, \"\\n          \");\n      i0.ɵɵelementStart(42, \"div\", 13);\n      i0.ɵɵtext(43, \"\\n              \");\n      i0.ɵɵtemplate(44, InstalmentCreateComponent_span_44_Template, 2, 0, \"span\", 14);\n      i0.ɵɵtext(45, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(46, \"\\n          \");\n      i0.ɵɵelementStart(47, \"div\", 15);\n      i0.ɵɵtext(48, \"\\n            \");\n      i0.ɵɵtemplate(49, InstalmentCreateComponent_span_49_Template, 2, 0, \"span\", 14);\n      i0.ɵɵtext(50, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(51, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(52, \"\\n        \");\n      i0.ɵɵelement(53, \"p-confirmPopup\", 16);\n      i0.ɵɵtext(54, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(55, \"\\n      \");\n      i0.ɵɵelement(56, \"br\");\n      i0.ɵɵtext(57, \"\\n      \");\n      i0.ɵɵtemplate(58, InstalmentCreateComponent_p_table_58_Template, 10, 6, \"p-table\", 17);\n      i0.ɵɵtext(59, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(60, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(61, \"\\n  \");\n      i0.ɵɵelementStart(62, \"div\", 18);\n      i0.ɵɵtext(63, \"\\n    \");\n      i0.ɵɵelementStart(64, \"div\", 19);\n      i0.ɵɵtext(65, \"\\n      \");\n      i0.ɵɵelementStart(66, \"p-panel\", 20);\n      i0.ɵɵtext(67, \"\\n        \");\n      i0.ɵɵelementStart(68, \"div\", 21);\n      i0.ɵɵtext(69, \"\\n          \");\n      i0.ɵɵelementStart(70, \"h5\");\n      i0.ɵɵtext(71);\n      i0.ɵɵpipe(72, \"defaultString\");\n      i0.ɵɵpipe(73, \"defaultString\");\n      i0.ɵɵpipe(74, \"defaultString\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(75, \"\\n          \");\n      i0.ɵɵelementStart(76, \"span\");\n      i0.ɵɵtext(77, \"NSman (M)\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(78, \"\\n          \");\n      i0.ɵɵelementStart(79, \"span\");\n      i0.ɵɵtext(80, \"CAB:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(81, \"span\");\n      i0.ɵɵtext(82);\n      i0.ɵɵpipe(83, \"defaultString\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(84, \"\\n          \");\n      i0.ɵɵelementStart(85, \"span\");\n      i0.ɵɵtext(86, \"Protected Payable:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(87, \"span\");\n      i0.ɵɵtext(88);\n      i0.ɵɵpipe(89, \"defaultString\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(90, \"\\n          \");\n      i0.ɵɵelement(91, \"br\");\n      i0.ɵɵtext(92, \"\\n          \");\n      i0.ɵɵelementStart(93, \"span\");\n      i0.ɵɵtext(94, \"Outstanding Principal:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(95, \"span\");\n      i0.ɵɵtext(96);\n      i0.ɵɵpipe(97, \"defaultString\");\n      i0.ɵɵpipe(98, \"currency\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(99, \"\\n          \");\n      i0.ɵɵelementStart(100, \"span\");\n      i0.ɵɵtext(101, \"Outstanding Interest:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(102, \"span\");\n      i0.ɵɵtext(103);\n      i0.ɵɵpipe(104, \"defaultString\");\n      i0.ɵɵpipe(105, \"currency\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(106, \"\\n          \");\n      i0.ɵɵelementStart(107, \"span\");\n      i0.ɵɵtext(108, \"Instalment:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(109, \"span\");\n      i0.ɵɵtext(110);\n      i0.ɵɵpipe(111, \"defaultString\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(112, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(113, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(114, \"\\n      \");\n      i0.ɵɵelementStart(115, \"p-panel\", 22);\n      i0.ɵɵtext(116, \"\\n        \");\n      i0.ɵɵelementStart(117, \"form\", 3);\n      i0.ɵɵtext(118, \"\\n          \");\n      i0.ɵɵelementStart(119, \"div\", 23);\n      i0.ɵɵtext(120, \"\\n            \");\n      i0.ɵɵelementStart(121, \"div\", 24);\n      i0.ɵɵtext(122, \"\\n              \");\n      i0.ɵɵelementStart(123, \"span\");\n      i0.ɵɵtext(124, \"Approval Email\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(125, \"\\n              \");\n      i0.ɵɵelementStart(126, \"span\");\n      i0.ɵɵtext(127, \"Return Letter from Bank\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(128, \"\\n              \");\n      i0.ɵɵelementStart(129, \"span\");\n      i0.ɵɵtext(130, \"Return Letter from NSman\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(131, \"\\n            \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(132, \"\\n            \");\n      i0.ɵɵelementStart(133, \"div\", 25);\n      i0.ɵɵtext(134, \"\\n              \");\n      i0.ɵɵelement(135, \"n2-file-upload\", 26, 27);\n      i0.ɵɵtext(137, \"\\n              \");\n      i0.ɵɵelement(138, \"n2-file-upload\", 28, 29);\n      i0.ɵɵtext(140, \"\\n              \");\n      i0.ɵɵelement(141, \"n2-file-upload\", 30, 31);\n      i0.ɵɵtext(143, \"\\n            \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(144, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(145, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(146, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(147, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(148, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(149, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(150, \"\\n\\n\");\n      i0.ɵɵelementStart(151, \"form\", 3);\n      i0.ɵɵtext(152, \"\\n  \");\n      i0.ɵɵelement(153, \"p-confirmPopup\", 32);\n      i0.ɵɵtext(154, \"\\n  \");\n      i0.ɵɵelement(155, \"p-confirmPopup\", 33);\n      i0.ɵɵtext(156, \"\\n  \");\n      i0.ɵɵelementStart(157, \"div\", 34);\n      i0.ɵɵtext(158, \"\\n    \");\n      i0.ɵɵelementStart(159, \"div\", 35);\n      i0.ɵɵtext(160, \"\\n      \");\n      i0.ɵɵelementStart(161, \"div\", 36);\n      i0.ɵɵtext(162, \"\\n        \");\n      i0.ɵɵelementStart(163, \"button\", 37);\n      i0.ɵɵlistener(\"click\", function InstalmentCreateComponent_Template_button_click_163_listener() {\n        return ctx.onSubmitGenerateApprovalEmail(ctx.displayGenerateApprovalEmailDialog);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(164, \"\\n        \");\n      i0.ɵɵelement(165, \"p-calendar\", 38);\n      i0.ɵɵtext(166, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(167, \"\\n      \");\n      i0.ɵɵelementStart(168, \"div\", 36);\n      i0.ɵɵtext(169, \"\\n        \");\n      i0.ɵɵelementStart(170, \"button\", 39);\n      i0.ɵɵlistener(\"click\", function InstalmentCreateComponent_Template_button_click_170_listener($event) {\n        return ctx.onSubmit($event, \"generateNSmanLetter\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(171, \"\\n        \");\n      i0.ɵɵelement(172, \"p-calendar\", 40);\n      i0.ɵɵtext(173, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(174, \"\\n      \");\n      i0.ɵɵelementStart(175, \"div\", 36);\n      i0.ɵɵtext(176, \"\\n        \");\n      i0.ɵɵelementStart(177, \"button\", 41);\n      i0.ɵɵlistener(\"click\", function InstalmentCreateComponent_Template_button_click_177_listener($event) {\n        return ctx.onSubmit($event, \"generateBankLetter\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(178, \"\\n        \");\n      i0.ɵɵelement(179, \"p-calendar\", 42);\n      i0.ɵɵtext(180, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(181, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(182, \"\\n    \");\n      i0.ɵɵelementStart(183, \"div\", 43);\n      i0.ɵɵtext(184, \"\\n      \");\n      i0.ɵɵelement(185, \"p-confirmPopup\", 44);\n      i0.ɵɵtext(186, \"\\n      \");\n      i0.ɵɵelementStart(187, \"button\", 45);\n      i0.ɵɵlistener(\"click\", function InstalmentCreateComponent_Template_button_click_187_listener($event) {\n        return ctx.onCancel($event, \"createInstalmentCancel\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(188, \"\\n\\n      \");\n      i0.ɵɵelement(189, \"p-confirmPopup\", 46);\n      i0.ɵɵtext(190, \"\\n      \");\n      i0.ɵɵelementStart(191, \"button\", 47);\n      i0.ɵɵlistener(\"click\", function InstalmentCreateComponent_Template_button_click_191_listener($event) {\n        return ctx.onSave($event, \"createInstalmentSave\");\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(192, \"\\n\\n      \");\n      i0.ɵɵelement(193, \"p-confirmPopup\", 48);\n      i0.ɵɵtext(194, \"\\n      \");\n      i0.ɵɵelementStart(195, \"button\", 49);\n      i0.ɵɵlistener(\"click\", function InstalmentCreateComponent_Template_button_click_195_listener($event) {\n        return ctx.onSubmitCreate($event, \"createInstalmentSubmit\");\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(196, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(197, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(198, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(199, \"\\n\\n\");\n      i0.ɵɵelementStart(200, \"p-dialog\", 50);\n      i0.ɵɵlistener(\"visibleChange\", function InstalmentCreateComponent_Template_p_dialog_visibleChange_200_listener($event) {\n        return ctx.displayGenerateApprovalEmailDialog.display = $event;\n      });\n      i0.ɵɵtext(201, \"\\n\\n  \");\n      i0.ɵɵelement(202, \"n2-instalment-create-generate-email\", null, 51);\n      i0.ɵɵtext(204, \"\\n  \");\n      i0.ɵɵtemplate(205, InstalmentCreateComponent_ng_template_205_Template, 1, 0, \"ng-template\", 52);\n      i0.ɵɵtext(206, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(207, \"\\n\");\n    }\n    if (rf & 2) {\n      let tmp_12_0;\n      let tmp_13_0;\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"formGroup\", ctx.computeInstalmentForm);\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"inputStyle\", i0.ɵɵpureFunction0(68, _c5))(\"minFractionDigits\", 2)(\"maxFractionDigits\", 2)(\"max\", 1000);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"inputStyle\", i0.ɵɵpureFunction0(69, _c5))(\"minDate\", ctx.firstDayOfNextMonth);\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"inputStyle\", i0.ɵɵpureFunction0(70, _c5))(\"disabled\", true)(\"minFractionDigits\", 2)(\"maxFractionDigits\", 2);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"disabled\", !ctx.computeInstalmentForm.valid);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngIf\", (ctx.computeInstalmentForm == null ? null : (tmp_12_0 = ctx.computeInstalmentForm.get(\"monthlyAmount\")) == null ? null : tmp_12_0.hasError(\"required\")) && (ctx.computeInstalmentForm == null ? null : (tmp_12_0 = ctx.computeInstalmentForm.get(\"monthlyAmount\")) == null ? null : tmp_12_0.dirty));\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngIf\", (ctx.computeInstalmentForm == null ? null : (tmp_13_0 = ctx.computeInstalmentForm.get(\"effectiveDate\")) == null ? null : tmp_13_0.hasError(\"required\")) && (ctx.computeInstalmentForm == null ? null : (tmp_13_0 = ctx.computeInstalmentForm.get(\"effectiveDate\")) == null ? null : tmp_13_0.dirty));\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"ngIf\", ctx.computedInstalmentPlan);\n      i0.ɵɵadvance(13);\n      i0.ɵɵtextInterpolate3(\"\", i0.ɵɵpipeBind1(72, 44, ctx.summary == null ? null : ctx.summary.nric), \"   \", i0.ɵɵpipeBind1(73, 46, ctx.summary == null ? null : ctx.summary.rank), \"   \", i0.ɵɵpipeBind1(74, 48, ctx.summary == null ? null : ctx.summary.name), \"\");\n      i0.ɵɵadvance(11);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(83, 50, ctx.summary == null ? null : ctx.summary.cabInd));\n      i0.ɵɵadvance(6);\n      i0.ɵɵtextInterpolate2(\"\", (ctx.summary == null ? null : ctx.summary.protectedPayableInd) === \"Y\" ? \"Yes\" : i0.ɵɵpipeBind1(89, 52, \"No\"), \" \", (ctx.summary == null ? null : ctx.summary.protectedPayableSPInd) === \"Y\" ? \"(Service Pay)\" : \"\", \"\");\n      i0.ɵɵadvance(8);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(97, 54, i0.ɵɵpipeBind3(98, 56, ctx.summary == null ? null : ctx.summary.principalOS, \"SGD\", \"\")));\n      i0.ɵɵadvance(7);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(104, 60, i0.ɵɵpipeBind3(105, 62, ctx.summary == null ? null : ctx.summary.interestOS, \"SGD\", \"\")));\n      i0.ɵɵadvance(7);\n      i0.ɵɵtextInterpolate(ctx.summary.instalmentInd === \"Y\" ? \"Yes\" : i0.ɵɵpipeBind1(111, 66, \"No\"));\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"formGroup\", ctx.instalmentSuppDocsForm);\n      i0.ɵɵadvance(18);\n      i0.ɵɵproperty(\"contentHeight\", \"100px\")(\"externalFileLimit\", ctx.fileUploadFileLimit);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"contentHeight\", \"100px\")(\"externalFileLimit\", ctx.fileUploadFileLimit);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"contentHeight\", \"100px\")(\"externalFileLimit\", ctx.fileUploadFileLimit);\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"formGroup\", ctx.instalmentSuppDocsSentDatesForm);\n      i0.ɵɵadvance(14);\n      i0.ɵɵproperty(\"inputStyle\", i0.ɵɵpureFunction0(71, _c5));\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"inputStyle\", i0.ɵɵpureFunction0(72, _c5));\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"inputStyle\", i0.ɵɵpureFunction0(73, _c5));\n      i0.ɵɵadvance(12);\n      i0.ɵɵproperty(\"disabled\", ctx.disableSaveButton);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", !ctx.isFormValid());\n      i0.ɵɵadvance(5);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(74, _c6));\n      i0.ɵɵproperty(\"visible\", ctx.displayGenerateApprovalEmailDialog.display)(\"breakpoints\", i0.ɵɵpureFunction0(75, _c7))(\"draggable\", false)(\"resizable\", false)(\"modal\", true);\n    }\n  },\n  dependencies: [i7.NgIf, i1.ɵNgNoValidate, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i8.PrimeTemplate, i9.ButtonDirective, i10.Tooltip, i11.Table, i12.Dialog, i13.ConfirmPopup, i14.Calendar, i15.InputNumber, i16.FileUploadComponent, i17.Panel, i18.Ripple, i19.InstalmentCreateGenerateEmailComponent, i7.CurrencyPipe, i7.DatePipe, i20.DefaultStringPipe],\n  styles: [\".create-instalment > .p-panel.p-component {\\n  display: flex;\\n  flex-direction: column;\\n  flex: auto;\\n}\\n\\n  .create-instalment > .p-panel.p-component > .p-toggleable-content {\\n  display: flex;\\n  flex: auto;\\n}\\n\\n  .create-instalment > .p-panel.p-component > .p-toggleable-content > .p-panel-content {\\n  flex: auto;\\n}\\n\\n\\n\\n  .nsManLetterCalendar > .p-calendar {\\n  flex: auto;\\n}\\n\\n\\n.particulars[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .particulars[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  display: inline !important;\\n  padding: 16px;\\n}\\n\\n[_nghost-%COMP%]     .computationCalendar > .p-calendar > .p-datepicker-monthpicker {\\n  width: 25rem;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluc3RhbG1lbnQtY3JlYXRlLmNvbXBvbmVudC5zY3NzIiwiLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxccHJvamVjdHMlMjAyXFxuc3BheWlpYXBwXFxzcmNcXG1haW5cXHdlYmFwcFxcYXBwXFxwYXltZW50XFxpbnN0YWxtZW50XFxpbnN0YWxtZW50LWNyZWF0ZVxcaW5zdGFsbWVudC1jcmVhdGUuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O2dGQUFBO0FBR0E7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxVQUFBO0FDQ0Y7O0FERUE7RUFDRSxhQUFBO0VBQ0EsVUFBQTtBQ0NGOztBREVBO0VBQ0UsVUFBQTtBQ0NGOztBRENBOztnRkFBQTtBQUtBOzttRkFBQTtBQUdBO0VBQ0UsVUFBQTtBQ0FGOztBREVBOzttRkFBQTtBQUtBO0VBQ0UsMEJBQUE7RUFDQSxhQUFBO0FDREY7O0FESUE7RUFDRSxZQUFBO0FDREYiLCJmaWxlIjoiaW5zdGFsbWVudC1jcmVhdGUuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuQ3VzdG9tIFByaW1lTkcgUC1wYW5lbCBDU1MgLSBNYWtlIGNvbnRlbnQgcGFuZWwgZ3JvdyB0byBjb250YWluaW5nIHBhcmVudCBoZWlnaHRcclxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXHJcbjo6bmctZGVlcCAuY3JlYXRlLWluc3RhbG1lbnQgPiAucC1wYW5lbC5wLWNvbXBvbmVudCB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gIGZsZXg6IGF1dG87XHJcbn1cclxuXHJcbjo6bmctZGVlcCAuY3JlYXRlLWluc3RhbG1lbnQgPiAucC1wYW5lbC5wLWNvbXBvbmVudCA+IC5wLXRvZ2dsZWFibGUtY29udGVudCB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4OiBhdXRvO1xyXG59XHJcblxyXG46Om5nLWRlZXAgLmNyZWF0ZS1pbnN0YWxtZW50ID4gLnAtcGFuZWwucC1jb21wb25lbnQgPiAucC10b2dnbGVhYmxlLWNvbnRlbnQgPiAucC1wYW5lbC1jb250ZW50IHtcclxuICBmbGV4OiBhdXRvO1xyXG59XHJcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5DdXN0b20gUHJpbWVORyBQLXBhbmVsIENTUyAtIE1ha2UgY29udGVudCBwYW5lbCBncm93IHRvIGNvbnRhaW5pbmcgcGFyZW50IGhlaWdodFxyXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cclxuXHJcblxyXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuQ3VzdG9tIFByaW1lTkcgUC1jYWxlbmRhciBDU1MgLSBNYWtlIENhbGVuZGFyIGlucHV0IGdyb3cgdG8gY29udGFpbmluZyBwYXJlbnQgd2lkdGhcclxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXHJcbjo6bmctZGVlcCAubnNNYW5MZXR0ZXJDYWxlbmRhciA+IC5wLWNhbGVuZGFyIHtcclxuICBmbGV4OiBhdXRvO1xyXG59XHJcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5DdXN0b20gUHJpbWVORyBQLWNhbGVuZGFyIENTUyAtIE1ha2UgQ2FsZW5kYXIgaW5wdXQgZ3JvdyB0byBjb250YWluaW5nIHBhcmVudCB3aWR0aFxyXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cclxuXHJcblxyXG4ucGFydGljdWxhcnMgaDUsIC5wYXJ0aWN1bGFycyBzcGFuIHtcclxuICBkaXNwbGF5OiBpbmxpbmUgIWltcG9ydGFudDtcclxuICBwYWRkaW5nOiAxNnB4O1xyXG59XHJcblxyXG46aG9zdCA6Om5nLWRlZXAgLmNvbXB1dGF0aW9uQ2FsZW5kYXIgPiAucC1jYWxlbmRhciA+IC5wLWRhdGVwaWNrZXItbW9udGhwaWNrZXJ7XHJcbiAgd2lkdGg6IDI1cmVtO1xyXG59XHJcbiIsIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuQ3VzdG9tIFByaW1lTkcgUC1wYW5lbCBDU1MgLSBNYWtlIGNvbnRlbnQgcGFuZWwgZ3JvdyB0byBjb250YWluaW5nIHBhcmVudCBoZWlnaHRcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuOjpuZy1kZWVwIC5jcmVhdGUtaW5zdGFsbWVudCA+IC5wLXBhbmVsLnAtY29tcG9uZW50IHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgZmxleDogYXV0bztcbn1cblxuOjpuZy1kZWVwIC5jcmVhdGUtaW5zdGFsbWVudCA+IC5wLXBhbmVsLnAtY29tcG9uZW50ID4gLnAtdG9nZ2xlYWJsZS1jb250ZW50IHtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxleDogYXV0bztcbn1cblxuOjpuZy1kZWVwIC5jcmVhdGUtaW5zdGFsbWVudCA+IC5wLXBhbmVsLnAtY29tcG9uZW50ID4gLnAtdG9nZ2xlYWJsZS1jb250ZW50ID4gLnAtcGFuZWwtY29udGVudCB7XG4gIGZsZXg6IGF1dG87XG59XG5cbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuQ3VzdG9tIFByaW1lTkcgUC1wYW5lbCBDU1MgLSBNYWtlIGNvbnRlbnQgcGFuZWwgZ3JvdyB0byBjb250YWluaW5nIHBhcmVudCBoZWlnaHRcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5DdXN0b20gUHJpbWVORyBQLWNhbGVuZGFyIENTUyAtIE1ha2UgQ2FsZW5kYXIgaW5wdXQgZ3JvdyB0byBjb250YWluaW5nIHBhcmVudCB3aWR0aFxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG46Om5nLWRlZXAgLm5zTWFuTGV0dGVyQ2FsZW5kYXIgPiAucC1jYWxlbmRhciB7XG4gIGZsZXg6IGF1dG87XG59XG5cbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuQ3VzdG9tIFByaW1lTkcgUC1jYWxlbmRhciBDU1MgLSBNYWtlIENhbGVuZGFyIGlucHV0IGdyb3cgdG8gY29udGFpbmluZyBwYXJlbnQgd2lkdGhcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuLnBhcnRpY3VsYXJzIGg1LCAucGFydGljdWxhcnMgc3BhbiB7XG4gIGRpc3BsYXk6IGlubGluZSAhaW1wb3J0YW50O1xuICBwYWRkaW5nOiAxNnB4O1xufVxuXG46aG9zdCA6Om5nLWRlZXAgLmNvbXB1dGF0aW9uQ2FsZW5kYXIgPiAucC1jYWxlbmRhciA+IC5wLWRhdGVwaWNrZXItbW9udGhwaWNrZXIge1xuICB3aWR0aDogMjVyZW07XG59Il19 */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvcGF5bWVudC9pbnN0YWxtZW50L2luc3RhbG1lbnQtY3JlYXRlL2luc3RhbG1lbnQtY3JlYXRlLmNvbXBvbmVudC5zY3NzIiwid2VicGFjazovLy4vLi4vLi4vcHJvamVjdHMlMjAyL25zcGF5aWlhcHAvc3JjL21haW4vd2ViYXBwL2FwcC9wYXltZW50L2luc3RhbG1lbnQvaW5zdGFsbWVudC1jcmVhdGUvaW5zdGFsbWVudC1jcmVhdGUuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O2dGQUFBO0FBR0E7RUFDRSxhQUFBO0VBQ0Esc0JBQUE7RUFDQSxVQUFBO0FDQ0Y7O0FERUE7RUFDRSxhQUFBO0VBQ0EsVUFBQTtBQ0NGOztBREVBO0VBQ0UsVUFBQTtBQ0NGOztBRENBOztnRkFBQTtBQUtBOzttRkFBQTtBQUdBO0VBQ0UsVUFBQTtBQ0FGOztBREVBOzttRkFBQTtBQUtBO0VBQ0UsMEJBQUE7RUFDQSxhQUFBO0FDREY7O0FESUE7RUFDRSxZQUFBO0FDREY7QURDQSxvbEtBQW9sSyIsInNvdXJjZXNDb250ZW50IjpbIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5DdXN0b20gUHJpbWVORyBQLXBhbmVsIENTUyAtIE1ha2UgY29udGVudCBwYW5lbCBncm93IHRvIGNvbnRhaW5pbmcgcGFyZW50IGhlaWdodFxyXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cclxuOjpuZy1kZWVwIC5jcmVhdGUtaW5zdGFsbWVudCA+IC5wLXBhbmVsLnAtY29tcG9uZW50IHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgZmxleDogYXV0bztcclxufVxyXG5cclxuOjpuZy1kZWVwIC5jcmVhdGUtaW5zdGFsbWVudCA+IC5wLXBhbmVsLnAtY29tcG9uZW50ID4gLnAtdG9nZ2xlYWJsZS1jb250ZW50IHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXg6IGF1dG87XHJcbn1cclxuXHJcbjo6bmctZGVlcCAuY3JlYXRlLWluc3RhbG1lbnQgPiAucC1wYW5lbC5wLWNvbXBvbmVudCA+IC5wLXRvZ2dsZWFibGUtY29udGVudCA+IC5wLXBhbmVsLWNvbnRlbnQge1xyXG4gIGZsZXg6IGF1dG87XHJcbn1cclxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbkN1c3RvbSBQcmltZU5HIFAtcGFuZWwgQ1NTIC0gTWFrZSBjb250ZW50IHBhbmVsIGdyb3cgdG8gY29udGFpbmluZyBwYXJlbnQgaGVpZ2h0XHJcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xyXG5cclxuXHJcbi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5DdXN0b20gUHJpbWVORyBQLWNhbGVuZGFyIENTUyAtIE1ha2UgQ2FsZW5kYXIgaW5wdXQgZ3JvdyB0byBjb250YWluaW5nIHBhcmVudCB3aWR0aFxyXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cclxuOjpuZy1kZWVwIC5uc01hbkxldHRlckNhbGVuZGFyID4gLnAtY2FsZW5kYXIge1xyXG4gIGZsZXg6IGF1dG87XHJcbn1cclxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbkN1c3RvbSBQcmltZU5HIFAtY2FsZW5kYXIgQ1NTIC0gTWFrZSBDYWxlbmRhciBpbnB1dCBncm93IHRvIGNvbnRhaW5pbmcgcGFyZW50IHdpZHRoXHJcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xyXG5cclxuXHJcbi5wYXJ0aWN1bGFycyBoNSwgLnBhcnRpY3VsYXJzIHNwYW4ge1xyXG4gIGRpc3BsYXk6IGlubGluZSAhaW1wb3J0YW50O1xyXG4gIHBhZGRpbmc6IDE2cHg7XHJcbn1cclxuXHJcbjpob3N0IDo6bmctZGVlcCAuY29tcHV0YXRpb25DYWxlbmRhciA+IC5wLWNhbGVuZGFyID4gLnAtZGF0ZXBpY2tlci1tb250aHBpY2tlcntcclxuICB3aWR0aDogMjVyZW07XHJcbn1cclxuIiwiLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5DdXN0b20gUHJpbWVORyBQLXBhbmVsIENTUyAtIE1ha2UgY29udGVudCBwYW5lbCBncm93IHRvIGNvbnRhaW5pbmcgcGFyZW50IGhlaWdodFxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG46Om5nLWRlZXAgLmNyZWF0ZS1pbnN0YWxtZW50ID4gLnAtcGFuZWwucC1jb21wb25lbnQge1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICBmbGV4OiBhdXRvO1xufVxuXG46Om5nLWRlZXAgLmNyZWF0ZS1pbnN0YWxtZW50ID4gLnAtcGFuZWwucC1jb21wb25lbnQgPiAucC10b2dnbGVhYmxlLWNvbnRlbnQge1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4OiBhdXRvO1xufVxuXG46Om5nLWRlZXAgLmNyZWF0ZS1pbnN0YWxtZW50ID4gLnAtcGFuZWwucC1jb21wb25lbnQgPiAucC10b2dnbGVhYmxlLWNvbnRlbnQgPiAucC1wYW5lbC1jb250ZW50IHtcbiAgZmxleDogYXV0bztcbn1cblxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5DdXN0b20gUHJpbWVORyBQLXBhbmVsIENTUyAtIE1ha2UgY29udGVudCBwYW5lbCBncm93IHRvIGNvbnRhaW5pbmcgcGFyZW50IGhlaWdodFxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG4vKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbkN1c3RvbSBQcmltZU5HIFAtY2FsZW5kYXIgQ1NTIC0gTWFrZSBDYWxlbmRhciBpbnB1dCBncm93IHRvIGNvbnRhaW5pbmcgcGFyZW50IHdpZHRoXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cbjo6bmctZGVlcCAubnNNYW5MZXR0ZXJDYWxlbmRhciA+IC5wLWNhbGVuZGFyIHtcbiAgZmxleDogYXV0bztcbn1cblxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5DdXN0b20gUHJpbWVORyBQLWNhbGVuZGFyIENTUyAtIE1ha2UgQ2FsZW5kYXIgaW5wdXQgZ3JvdyB0byBjb250YWluaW5nIHBhcmVudCB3aWR0aFxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG4ucGFydGljdWxhcnMgaDUsIC5wYXJ0aWN1bGFycyBzcGFuIHtcbiAgZGlzcGxheTogaW5saW5lICFpbXBvcnRhbnQ7XG4gIHBhZGRpbmc6IDE2cHg7XG59XG5cbjpob3N0IDo6bmctZGVlcCAuY29tcHV0YXRpb25DYWxlbmRhciA+IC5wLWNhbGVuZGFyID4gLnAtZGF0ZXBpY2tlci1tb250aHBpY2tlciB7XG4gIHdpZHRoOiAyNXJlbTtcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","InstalmentCreateComponent","constructor","fb","route","router","nspConfirmService","toastService","instalmentService","paymentService","display","Date","todayDate","getFullYear","getMonth","nric","name","rank","sex","csn","principalOS","interestOS","protectedPayableInd","protectedPayableSPInd","instalmentInd","cabInd","group","monthlyAmount","forms_1","required","min","effectiveDate","firstDayOfNextMonth","compInterestRate","interestRate","approvalEmail","fileupload2_directive_1","maxFileLimit","fileUploadFileLimit","allowableExtension","nsManLetter","bankLetter","approvalEmailSentDate","letterNSmanSentDate","letterBankSentDate","previousUrl","getCurrentNavigation","previousNavigation","finalUrl","toString","ngOnInit","params","subscribe","loadSummary","getDraftInstalmentByNSman","draftInstalmentRes","body","data","latestDraftInstalment","computedInstalmentPlan","instalmentComputedPaymentList","length","disableSaveButton","computeInstalmentForm","patchValue","instalmentSuppDocsSentDatesForm","console","log","supportingDocs","approvalEmailIds","filter","d","documentType","map","doc","documentId","approvalEmailFileUploadComponent","preloadFiles","nsmanLetterIds","nsmanLetterFileUploadComponent","bankLetterIds","bankLetterFileUploadComponent","isFormValid","valid","verifiedFiles","getSummaryByNric","summaryRes","summary","onSubmit","event","key","dialog","debugAllForms","onConfirmPopup","onSubmitCreate","createInstalmentPlan","onSubmitGenerateApprovalEmail","instalmentCreateGenerateEmailComponent","generate","onSave","saveDraftInstalmentPlan","x","String","meta_data","id","nsmanLetter","instalmentPlanToSave","get","value","computedDate","toISOString","approvalEmailDocument","nsManReturnLetterDocument","bankReturnLetterDocument","isEditRejected","saveDraftRes","success","error","message","status","onCompute","computeInterestPlan","instalmentPlanToCompute","computePaymentPlan","res","add","severity","detail","instalmentPlan","create","navigate","error_desc","onCancel","exportCSV","instalmentSuppDocsForm","exports","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\payment\\instalment\\instalment-create\\instalment-create.component.ts","C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\payment\\instalment\\instalment-create\\instalment-create.component.html"],"sourcesContent":["import {Component, OnInit, ViewChild} from '@angular/core';\r\nimport {NspConfirmationService} from 'app/shared/confirm/nsp-confirm.service';\r\nimport {CustomToastService} from 'app/layouts/service/customtoast.service';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {FormBuilder, FormControl, FormGroup, Validators} from '@angular/forms';\r\nimport {HttpErrorResponse, HttpResponse, HttpStatusCode} from '@angular/common/http';\r\nimport {InstalmentService} from 'app/payment/instalment/service/instalment.service';\r\nimport {IOPSummary} from \"app/payment/overpayment/overpayment-info/overpayment-info.model\";\r\nimport {PaymentService} from \"app/payment/overpayment/service/payment.service\";\r\nimport {IInstalmentPlan} from \"app/payment/instalment/model/instalment-plan.model\";\r\nimport {InstalmentCreateGenerateEmailComponent} from '../instalment-create-generate-email/instalment-create-generate-email.component';\r\nimport {FileUploadValidator2} from 'app/shared/validator/fileupload2.directive';\r\nimport {FileUploadComponent} from 'app/shared/component/file-upload/file-upload.component';\r\n\r\n@Component({\r\n  selector: 'n2-instalment-create',\r\n  templateUrl: './instalment-create.component.html',\r\n  styleUrls: ['./instalment-create.component.scss']\r\n})\r\nexport class InstalmentCreateComponent implements OnInit {\r\n\r\n  previousUrl = \"\";\r\n\r\n  displayGenerateApprovalEmailDialog: any = {display: false};\r\n  disableSaveButton = true;\r\n  computedInstalmentPlan: IInstalmentPlan;\r\n  todayDate: Date = new Date;\r\n  firstDayOfNextMonth: Date = new Date(this.todayDate.getFullYear(), this.todayDate.getMonth()+1, 1);\r\n  fileUploadFileLimit = 1;\r\n\r\n  interestRate = 5.5;\r\n\r\n  summary: IOPSummary = {\r\n    nric: '',\r\n    name: '',\r\n    rank: '',\r\n    sex: '',\r\n    csn: '',\r\n    principalOS: 0,\r\n    interestOS: 0,\r\n    protectedPayableInd: '',\r\n    protectedPayableSPInd: '',\r\n    instalmentInd: '',\r\n    cabInd: ''\r\n  };\r\n\r\n  latestDraftInstalment: IInstalmentPlan;\r\n\r\n  computeInstalmentForm: FormGroup = this.fb.group({\r\n    monthlyAmount: new FormControl(null, [Validators.required, Validators.min(1)]),\r\n    effectiveDate: new FormControl(this.firstDayOfNextMonth, Validators.required),\r\n    compInterestRate: new FormControl(this.interestRate, Validators.required)\r\n  });\r\n\r\n  instalmentSuppDocsForm: FormGroup = this.fb.group({\r\n    approvalEmail: new FormControl([], [FileUploadValidator2.maxFileLimit(this.fileUploadFileLimit), FileUploadValidator2.allowableExtension(\".pdf\")]),\r\n    nsManLetter: new FormControl([], [FileUploadValidator2.maxFileLimit(this.fileUploadFileLimit), FileUploadValidator2.allowableExtension(\".pdf\")]),\r\n    bankLetter: new FormControl([], [FileUploadValidator2.maxFileLimit(this.fileUploadFileLimit), FileUploadValidator2.allowableExtension(\".pdf\")])\r\n  });\r\n\r\n  instalmentSuppDocsSentDatesForm: FormGroup = this.fb.group({\r\n    approvalEmailSentDate: new FormControl(null),\r\n    letterNSmanSentDate: new FormControl(null),\r\n    letterBankSentDate: new FormControl(null)\r\n  });\r\n\r\n  @ViewChild('createGenerateEmailComponent')\r\n  private instalmentCreateGenerateEmailComponent: InstalmentCreateGenerateEmailComponent;\r\n\r\n  @ViewChild('approvalEmailFileUpload')\r\n  private approvalEmailFileUploadComponent: FileUploadComponent;\r\n\r\n  @ViewChild('nsmanLetterFileUpload')\r\n  private nsmanLetterFileUploadComponent: FileUploadComponent;\r\n\r\n  @ViewChild('bankLetterFileUpload')\r\n  private bankLetterFileUploadComponent: FileUploadComponent;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private nspConfirmService: NspConfirmationService,\r\n    private toastService: CustomToastService,\r\n    private instalmentService: InstalmentService,\r\n    private paymentService: PaymentService\r\n  ) {\r\n    this.previousUrl = this.router.getCurrentNavigation().previousNavigation.finalUrl.toString();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    // TODO: Call parameters endpoint to retrieve prevailing interest rate\r\n\r\n    this.route.params.subscribe(params => {\r\n      const nric = params['nric'];\r\n      this.loadSummary(nric);\r\n\r\n      // Pre-populate the create form if a draft of Create Instalment exists\r\n      this.instalmentService.getDraftInstalmentByNSman(params['nric']).subscribe((draftInstalmentRes: HttpResponse<any>) => {\r\n        if (draftInstalmentRes.body && draftInstalmentRes.body.data) {\r\n          this.latestDraftInstalment = draftInstalmentRes.body.data;\r\n          if (this.latestDraftInstalment) {\r\n            // Perform pre-population\r\n            this.computedInstalmentPlan = this.latestDraftInstalment;\r\n            if(this.latestDraftInstalment.instalmentComputedPaymentList?.length > 0){\r\n              this.disableSaveButton = false;\r\n            }\r\n            this.computeInstalmentForm.patchValue({\r\n              monthlyAmount: this.latestDraftInstalment.monthlyAmount,\r\n              effectiveDate: new Date(this.latestDraftInstalment.effectiveDate),\r\n              compInterestRate: this.latestDraftInstalment.compInterestRate\r\n            });\r\n            if(this.latestDraftInstalment.approvalEmailSentDate) {\r\n              this.instalmentSuppDocsSentDatesForm.patchValue({\r\n                approvalEmailSentDate: new Date(this.latestDraftInstalment.approvalEmailSentDate)\r\n              });\r\n            }\r\n            if(this.latestDraftInstalment.letterNSmanSentDate) {\r\n              this.instalmentSuppDocsSentDatesForm.patchValue({\r\n                letterNSmanSentDate: new Date(this.latestDraftInstalment.letterNSmanSentDate),\r\n              });\r\n            }\r\n            if(this.latestDraftInstalment.letterBankSentDate) {\r\n              this.instalmentSuppDocsSentDatesForm.patchValue({\r\n                letterBankSentDate: new Date(this.latestDraftInstalment.letterBankSentDate),\r\n              });\r\n            }\r\n            // TODO: Left pre-population of already uploaded DMS files\r\n            console.log(\"draft\", this.latestDraftInstalment);\r\n            if(this.latestDraftInstalment.supportingDocs?.length > 0) {\r\n              const approvalEmailIds = this.latestDraftInstalment.supportingDocs?.filter(d => d.documentType === \"APP\").map(doc => doc.documentId);\r\n              this.approvalEmailFileUploadComponent.preloadFiles(approvalEmailIds);\r\n\r\n              const nsmanLetterIds = this.latestDraftInstalment.supportingDocs?.filter(d => d.documentType === \"NSM\").map(doc => doc.documentId);\r\n              this.nsmanLetterFileUploadComponent.preloadFiles(nsmanLetterIds);\r\n\r\n              const bankLetterIds = this.latestDraftInstalment.supportingDocs?.filter(d => d.documentType === \"BNK\").map(doc => doc.documentId);\r\n              this.bankLetterFileUploadComponent.preloadFiles(bankLetterIds);\r\n            }\r\n          }\r\n        }\r\n      })\r\n    });\r\n\r\n  }\r\n\r\n  isFormValid(): boolean {\r\n    return this.computeInstalmentForm.valid && !this.disableSaveButton\r\n      && this.bankLetterFileUploadComponent.verifiedFiles.length > 0\r\n      && this.approvalEmailFileUploadComponent.verifiedFiles.length > 0\r\n      && this.nsmanLetterFileUploadComponent.verifiedFiles.length > 0\r\n  }\r\n\r\n  loadSummary(nric: string): void {\r\n    this.paymentService.getSummaryByNric(nric).subscribe(\r\n      (summaryRes: HttpResponse<any>) => {\r\n        this.summary = summaryRes.body.data;\r\n      }\r\n    );\r\n  }\r\n\r\n  onSubmit(event: Event, key: string, dialog: any): void {\r\n\r\n    // Log\r\n    this.debugAllForms();\r\n\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog);\r\n  }\r\n\r\n\r\n  // Create instalment plan\r\n  onSubmitCreate(event: Event, key: string) : void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\r\n      this.createInstalmentPlan();\r\n    })\r\n  }\r\n\r\n  // Generate approval email\r\n  onSubmitGenerateApprovalEmail(dialog: any): void {\r\n    dialog.display = true;\r\n    this.instalmentCreateGenerateEmailComponent.generate();\r\n  }\r\n\r\n  onSave(event: Event, key: string): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\r\n      this.saveDraftInstalmentPlan();\r\n    })\r\n  }\r\n\r\n  saveDraftInstalmentPlan(): void {\r\n    const approvalEmail: string = this.approvalEmailFileUploadComponent.verifiedFiles?.map(x=>\r\n      String(x.meta_data.id)\r\n    )[0];\r\n    const nsmanLetter: string = this.nsmanLetterFileUploadComponent.verifiedFiles?.map(x=>\r\n      String(x.meta_data.id)\r\n    )[0];\r\n    const bankLetter: string = this.bankLetterFileUploadComponent.verifiedFiles?.map(x=>\r\n      String(x.meta_data.id)\r\n    )[0];\r\n\r\n    const instalmentPlanToSave: IInstalmentPlan = {\r\n      nric: this.summary.nric,\r\n      monthlyAmount: this.computeInstalmentForm.get('monthlyAmount')?.value,\r\n      effectiveDate: this.computeInstalmentForm.get('effectiveDate')?.value,\r\n      computedDate: new Date(this.computedInstalmentPlan.computedDate).toISOString(),\r\n      compInterestRate: this.computeInstalmentForm.get('compInterestRate')?.value,\r\n      approvalEmailSentDate: this.instalmentSuppDocsSentDatesForm.get('approvalEmailSentDate')?.value,\r\n      letterNSmanSentDate: this.instalmentSuppDocsSentDatesForm.get('letterNSmanSentDate')?.value,\r\n      letterBankSentDate: this.instalmentSuppDocsSentDatesForm.get('letterBankSentDate')?.value,\r\n      instalmentComputedPaymentList: this.computedInstalmentPlan.instalmentComputedPaymentList,\r\n      approvalEmailDocument: approvalEmail,\r\n      nsManReturnLetterDocument: nsmanLetter,\r\n      bankReturnLetterDocument: bankLetter,\r\n      isEditRejected: false\r\n    }\r\n\r\n    console.log(\"instalmentPlanToSave\", instalmentPlanToSave);\r\n\r\n    // Call API endpoint to persist draft of Instalment Plan into database\r\n    this.instalmentService.saveDraftInstalmentPlan(instalmentPlanToSave).subscribe(\r\n      (saveDraftRes: HttpResponse<any>) => {\r\n        if (saveDraftRes.body && saveDraftRes.body.data) {\r\n          this.toastService.success('Successfully saved draft of Instalment Plan');\r\n        }\r\n      },\r\n      (error: HttpErrorResponse) => {\r\n        console.log(error.message);\r\n        if (error.status === HttpStatusCode.NotFound) {\r\n          this.toastService.error('Error saving draft of Instalment Plan with given parameters');\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  onCompute(event: Event, key: string): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, null, () => {\r\n      this.computeInterestPlan();\r\n    });\r\n  }\r\n\r\n  computeInterestPlan(): void {\r\n    const instalmentPlanToCompute: IInstalmentPlan = {\r\n      monthlyAmount: this.computeInstalmentForm.get('monthlyAmount')?.value,\r\n      effectiveDate: this.computeInstalmentForm.get('effectiveDate')?.value,\r\n      compInterestRate: this.computeInstalmentForm.get('compInterestRate')?.value,\r\n      nric: this.summary.nric,\r\n    };\r\n\r\n    // Call API endpoint to compute an Instalment Plan\r\n    this.instalmentService.computePaymentPlan(instalmentPlanToCompute).subscribe(\r\n      (res: HttpResponse<any>) => {\r\n        // Pipe response to an array of Interface model\r\n        this.computedInstalmentPlan = res.body.data;\r\n        if(this.computedInstalmentPlan.instalmentComputedPaymentList?.length > 0){\r\n          this.disableSaveButton = false;\r\n        }\r\n      },\r\n      (error: HttpErrorResponse) => {\r\n        console.log(error.message);\r\n        if (error.status === HttpStatusCode.NotFound) {\r\n          this.toastService.add({\r\n            severity: 'error',\r\n            summary: 'Error',\r\n            detail: 'Error computing an Instalment Plan with given parameters'\r\n          });\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n\r\n  // Create Instalment Plan\r\n  createInstalmentPlan() : void {\r\n    // TODO DMS integration only pass file id\r\n    const approvalEmail: string = this.approvalEmailFileUploadComponent.verifiedFiles.map(x=>\r\n      String(x.meta_data.id)\r\n    )[0];\r\n    const nsmanLetter: string = this.nsmanLetterFileUploadComponent.verifiedFiles.map(x=>\r\n      String(x.meta_data.id)\r\n    )[0];\r\n    const bankLetter: string = this.bankLetterFileUploadComponent.verifiedFiles.map(x=>\r\n      String(x.meta_data.id)\r\n    )[0];\r\n\r\n    const instalmentPlan: IInstalmentPlan = {\r\n      id: this.computedInstalmentPlan.id,\r\n      nric: this.summary.nric,\r\n      monthlyAmount: this.computeInstalmentForm.get('monthlyAmount')?.value,\r\n      effectiveDate: this.computeInstalmentForm.get('effectiveDate')?.value,\r\n      computedDate: new Date(this.computedInstalmentPlan.computedDate).toISOString(),\r\n      compInterestRate: this.computeInstalmentForm.get('compInterestRate')?.value,\r\n      approvalEmailSentDate: this.instalmentSuppDocsSentDatesForm.get('approvalEmailSentDate')?.value,\r\n      letterNSmanSentDate: this.instalmentSuppDocsSentDatesForm.get('letterNSmanSentDate')?.value,\r\n      letterBankSentDate: this.instalmentSuppDocsSentDatesForm.get('letterBankSentDate')?.value,\r\n      instalmentComputedPaymentList: this.computedInstalmentPlan.instalmentComputedPaymentList,\r\n      approvalEmailDocument: approvalEmail,\r\n      nsManReturnLetterDocument: nsmanLetter,\r\n      bankReturnLetterDocument: bankLetter,\r\n      isEditRejected: false\r\n    }\r\n\r\n    this.instalmentService.create(instalmentPlan).subscribe(\r\n      res => {\r\n        if(res){\r\n          this.toastService.success(\"Instalment created succesfully\");\r\n          this.router.navigate([this.previousUrl]);\r\n        }\r\n      },\r\n      error => {\r\n        this.toastService.error(error.error?.error_desc)\r\n      }\r\n    );\r\n  }\r\n\r\n  // Pop up the Confirmation dialog to Cancel current transaction\r\n  onCancel(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\r\n      // Define function that will be called upon confirmation of the cancellation dialog\r\n      // Will route back to Inbox upon cancellation in this case\r\n      this.router.navigate([this.previousUrl]);\r\n    });\r\n  }\r\n\r\n  exportCSV(): void {\r\n    // TODO: Implement export CSV function or call it from a utility class\r\n  }\r\n\r\n  private debugAllForms(): void {\r\n    console.log(\"computeInstalmentForm\", this.computeInstalmentForm);\r\n    console.log(\"instalmentSuppDocsForm\", this.instalmentSuppDocsForm);\r\n    console.log(\"instalmentSuppDocsSentDatesForm\", this.instalmentSuppDocsSentDatesForm);\r\n  }\r\n}\r\n","<div class='grid'>\r\n  <div class='col-6 flex'>\r\n    <p-panel class='flex-auto flex create-instalment' header='Create Instalment'>\r\n      <form [formGroup]='computeInstalmentForm'>\r\n        <div class='grid'>\r\n          <div class='col-5 flex align-items-center gap-2'>\r\n            <span class='flex-shrink-0'>Monthly Instalment Amount</span>\r\n            <p-inputNumber [inputStyle]=\"{'width': '0%'}\" formControlName='monthlyAmount'\r\n                           id='monthlyAmount'\r\n                           currency='SGD' [minFractionDigits]='2' [maxFractionDigits]='2' [max]='1000'></p-inputNumber>\r\n          </div>\r\n          <div class='col-3 flex align-items-center gap-2'>\r\n            <span class='flex-shrink-0'>First Month</span>\r\n            <p-calendar class='computationCalendar' [inputStyle]=\"{'width': '0%'}\" formControlName='effectiveDate'\r\n                        id = 'effectiveDate' view='month'\r\n                        [minDate]=\"firstDayOfNextMonth\" dateFormat='mm-yy'></p-calendar>\r\n          </div>\r\n          <div class='col-4 flex align-items-center gap-2 justify-content-between'>\r\n            <div class='flex align-items-center gap-2'>\r\n              <span class='flex-shrink-0'>Interest Rate</span>\r\n              <p-inputNumber [inputStyle]=\"{'width': '0%'}\" formControlName='compInterestRate' id='compInterestRate'\r\n                             [disabled]='true'\r\n                             currency='SGD' [minFractionDigits]='2' [maxFractionDigits]='2'></p-inputNumber>\r\n            </div>\r\n            <button [disabled]='!computeInstalmentForm.valid' class='flex-shrink-0' type='button' pButton\r\n                    label='Compute'\r\n                    (click)=\"onCompute($event,'computeInterest')\"></button>\r\n          </div>\r\n        </div>\r\n        <div class='grid'>\r\n          <div class='col-5 flex justify-content-end'>\r\n              <span *ngIf=\"(computeInstalmentForm?.get('monthlyAmount')?.hasError('required')\r\n              && computeInstalmentForm?.get('monthlyAmount')?.dirty)\" class='p-error'>Required</span>\r\n          </div>\r\n          <div class='col-3 flex justify-content-end'>\r\n            <span *ngIf=\"(computeInstalmentForm?.get('effectiveDate')?.hasError('required')\r\n              && computeInstalmentForm?.get('effectiveDate')?.dirty)\" class='p-error'>Required</span>\r\n          </div>\r\n        </div>\r\n        <p-confirmPopup key='computeInterest'></p-confirmPopup>\r\n      </form>\r\n      <br>\r\n      <p-table *ngIf='computedInstalmentPlan'\r\n               [value]='computedInstalmentPlan.instalmentComputedPaymentList!' styleClass='p-datatable-gridlines'\r\n               [paginator]='true'\r\n               [rows]='10'\r\n               currentPageReportTemplate='Showing {first} to {last} of {totalRecords} entries'\r\n               [rowsPerPageOptions]='[10,25,50]' [showCurrentPageReport]='true'>\r\n        <ng-template pTemplate='caption'>\r\n          <div class='flex align-items-center gap-2'>\r\n            <button type='button' pButton pRipple icon='pi pi-file' (click)='exportCSV()' pTooltip='Export as CSV'\r\n                    tooltipPosition='bottom'></button>\r\n            <span>Estimated Plan Computed on {{computedInstalmentPlan.computedDate | date:'dd-MM-yyyy' | defaultString}}</span>\r\n          </div>\r\n        </ng-template>\r\n        <ng-template pTemplate='header'>\r\n          <tr>\r\n            <th scope=\"col\" style='width: 10%'>SN</th>\r\n            <th scope=\"col\">Month</th>\r\n            <th scope=\"col\">Principal O/S</th>\r\n            <th scope=\"col\">Payment Per Month</th>\r\n            <th scope=\"col\">Interest Per Month</th>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate='body' let-computedInstalmentPayment let-i='rowIndex'>\r\n          <tr>\r\n            <td>{{i + 1}}</td>\r\n            <td>{{computedInstalmentPayment?.paymentMonth | date:'MM-yyyy' | defaultString}}</td>\r\n            <td>{{computedInstalmentPayment?.principalOSBalance | currency:'SGD':'' | defaultString}}</td>\r\n            <td>{{computedInstalmentPayment?.paymentAmount | currency:'SGD':'' | defaultString}}</td>\r\n            <td>{{computedInstalmentPayment?.interestAmount | currency:'SGD':'' | defaultString}}</td>\r\n          </tr>\r\n        </ng-template>\r\n\r\n        <ng-template pTemplate='emptymessage'>\r\n          <tr>\r\n            <td colspan='5'>No Computed Instalment Payments</td>\r\n          </tr>\r\n        </ng-template>\r\n      </p-table>\r\n    </p-panel>\r\n  </div>\r\n  <div class='col-6'>\r\n    <div class='flex flex-column gap-2'>\r\n      <p-panel header='Personal Particulars'>\r\n        <div class='particulars'>\r\n          <h5>{{summary?.nric | defaultString}}   {{summary?.rank | defaultString}}   {{summary?.name | defaultString}}</h5>\r\n          <span>NSman (M)</span>\r\n          <span>CAB:</span><span>{{summary?.cabInd | defaultString}}</span>\r\n          <span>Protected Payable:</span><span>{{summary?.protectedPayableInd === 'Y' ? 'Yes' : 'No' | defaultString}} {{summary?.protectedPayableSPInd === 'Y' ? '(Service Pay)' : ''}}</span>\r\n          <br/>\r\n          <span>Outstanding Principal:</span><span>{{summary?.principalOS | currency:'SGD':'' | defaultString}}</span>\r\n          <span>Outstanding Interest:</span><span>{{summary?.interestOS | currency:'SGD':'' | defaultString}}</span>\r\n          <span>Instalment:</span><span>{{summary.instalmentInd === 'Y' ? 'Yes' : 'No' | defaultString}}</span>\r\n        </div>\r\n      </p-panel>\r\n      <p-panel header='Supporting Documents'>\r\n        <form [formGroup]=\"instalmentSuppDocsForm\">\r\n          <div class='flex gap-4'>\r\n            <div class='flex flex-column justify-content-around gap-2'>\r\n              <span>Approval Email</span>\r\n              <span>Return Letter from Bank</span>\r\n              <span>Return Letter from NSman</span>\r\n            </div>\r\n            <div class='flex-auto flex flex-column justify-content-around gap-2'>\r\n              <n2-file-upload [contentHeight]=\"'100px'\" #approvalEmailFileUpload formControlName='approvalEmail' id='approvalEmail' [externalFileLimit]=\"fileUploadFileLimit\"></n2-file-upload>\r\n              <n2-file-upload [contentHeight]=\"'100px'\" #nsmanLetterFileUpload formControlName='nsManLetter' id='nsManLetter' [externalFileLimit]=\"fileUploadFileLimit\"></n2-file-upload>\r\n              <n2-file-upload [contentHeight]=\"'100px'\" #bankLetterFileUpload formControlName='bankLetter' id='bankLetter' [externalFileLimit]=\"fileUploadFileLimit\"></n2-file-upload>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </p-panel>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<form [formGroup]='instalmentSuppDocsSentDatesForm'>\r\n  <p-confirmPopup key='generateNSmanLetter'></p-confirmPopup>\r\n  <p-confirmPopup key='generateBankLetter'></p-confirmPopup>\r\n  <div class='flex justify-content-between'>\r\n    <div class='flex gap-2'>\r\n      <div class='flex flex-column gap-1'>\r\n        <button type='button' pButton label='Generate Approval Email'\r\n                (click)=\"onSubmitGenerateApprovalEmail(displayGenerateApprovalEmailDialog)\"></button>\r\n        <p-calendar class='flex nsManLetterCalendar' placeholder='Select sent date' [inputStyle]=\"{'width': '0%'}\"\r\n                    appendTo='body' formControlName='approvalEmailSentDate'\r\n                    dateFormat='dd-mm-yy'></p-calendar>\r\n      </div>\r\n      <div class='flex flex-column gap-1'>\r\n        <button type='button' pButton label='Generate Letter for NSman'\r\n                (click)=\"onSubmit($event,'generateNSmanLetter', null)\"></button>\r\n        <p-calendar class='flex nsManLetterCalendar' placeholder='Select sent date' [inputStyle]=\"{'width': '0%'}\"\r\n                    appendTo='body' formControlName='letterNSmanSentDate'\r\n                    dateFormat='dd-mm-yy'></p-calendar>\r\n      </div>\r\n      <div class='flex flex-column gap-1'>\r\n        <button type='button' pButton label='Generate Letter for Bank'\r\n                (click)=\"onSubmit($event,'generateBankLetter', null)\"></button>\r\n        <p-calendar class='flex nsManLetterCalendar' placeholder='Select sent date' [inputStyle]=\"{'width': '0%'}\"\r\n                    appendTo='body' formControlName='letterBankSentDate'\r\n                    dateFormat='dd-mm-yy'></p-calendar>\r\n      </div>\r\n    </div>\r\n    <div class='flex align-items-start justify-content-end gap-2'>\r\n      <p-confirmPopup key='createInstalmentCancel'></p-confirmPopup>\r\n      <button class='p-button-danger' type='button' pButton label='Cancel'\r\n              (click)=\"onCancel($event,'createInstalmentCancel', null)\"></button>\r\n\r\n      <p-confirmPopup key='createInstalmentSave'></p-confirmPopup>\r\n      <button class='p-button-outlined' type='button' pButton label='Save' [disabled]=\"disableSaveButton\"\r\n              (click)=\"onSave($event,'createInstalmentSave')\"></button>\r\n\r\n      <p-confirmPopup key='createInstalmentSubmit'></p-confirmPopup>\r\n      <button type='button' pButton label='Submit'\r\n              [disabled]=\"!isFormValid()\"\r\n              (click)=\"onSubmitCreate($event,'createInstalmentSubmit')\"></button>\r\n    </div>\r\n  </div>\r\n</form>\r\n\r\n<p-dialog header='Approval Email' [(visible)]='displayGenerateApprovalEmailDialog.display'\r\n          [breakpoints]=\"{'960px': '75vw'}\"\r\n          [style]=\"{width: '50vw'}\" [draggable]='false' [resizable]='false' [modal]='true'>\r\n\r\n  <n2-instalment-create-generate-email #createGenerateEmailComponent></n2-instalment-create-generate-email>\r\n  <ng-template pTemplate='footer'>\r\n  </ng-template>\r\n</p-dialog>\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}