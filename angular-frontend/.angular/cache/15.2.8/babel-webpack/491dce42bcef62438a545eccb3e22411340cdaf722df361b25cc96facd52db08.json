{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ApproveAnnualWriteOffComponent = void 0;\nconst tslib_1 = require(\"tslib\");\nconst view_annual_write_off_data_model_1 = require(\"app/payment/annual-write-off/model/view-annual-write-off-data.model\");\nconst forms_1 = require(\"@angular/forms\");\nconst fileupload2_directive_1 = require(\"app/shared/validator/fileupload2.directive\");\nconst nspapp_constants_1 = require(\"app/shared/constants/nspapp.constants\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"app/payment/annual-write-off/service/annual-write-off.service\"));\nconst i2 = tslib_1.__importStar(require(\"app/payment/annual-write-off/service/write-off.service\"));\nconst i3 = tslib_1.__importStar(require(\"app/shared/confirm/nsp-confirm.service\"));\nconst i4 = tslib_1.__importStar(require(\"app/layouts/service/customtoast.service\"));\nconst i5 = tslib_1.__importStar(require(\"@angular/forms\"));\nconst i6 = tslib_1.__importStar(require(\"@angular/router\"));\nconst i7 = tslib_1.__importStar(require(\"app/shared/service/file-upload.service\"));\nconst i8 = tslib_1.__importStar(require(\"primeng/dialog\"));\nconst i9 = tslib_1.__importStar(require(\"primeng/api\"));\nconst i10 = tslib_1.__importStar(require(\"@angular/common\"));\nconst i11 = tslib_1.__importStar(require(\"primeng/button\"));\nconst i12 = tslib_1.__importStar(require(\"primeng/tooltip\"));\nconst i13 = tslib_1.__importStar(require(\"primeng/table\"));\nconst i14 = tslib_1.__importStar(require(\"primeng/confirmpopup\"));\nconst i15 = tslib_1.__importStar(require(\"../../../shared/component/file-upload/file-upload.component\"));\nconst i16 = tslib_1.__importStar(require(\"app/shared/component/rejection-reason/rejection-reason.component\"));\nconst i17 = tslib_1.__importStar(require(\"primeng/panel\"));\nconst i18 = tslib_1.__importStar(require(\"primeng/ripple\"));\nconst _c0 = [\"sourceFile\"];\nconst _c1 = [\"rejectionReasonDialog\"];\nfunction ApproveAnnualWriteOffComponent_p_table_22_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"div\", 1);\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵelementStart(3, \"div\", 32);\n    i0.ɵɵtext(4, \"\\n              \");\n    i0.ɵɵelementStart(5, \"button\", 33);\n    i0.ɵɵlistener(\"click\", function ApproveAnnualWriteOffComponent_p_table_22_ng_template_2_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.exportCSV());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n            \");\n    i0.ɵɵelementStart(8, \"div\", 34);\n    i0.ɵɵtext(9, \"Write-Off List\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n        \");\n  }\n}\nfunction ApproveAnnualWriteOffComponent_p_table_22_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵelementStart(3, \"th\", 35);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n            \");\n    i0.ɵɵelementStart(6, \"th\", 36);\n    i0.ɵɵtext(7, \"Overpayment ID\\n              \");\n    i0.ɵɵelementStart(8, \"p-sortIcon\", 37);\n    i0.ɵɵtext(9, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n            \");\n    i0.ɵɵelementStart(12, \"th\", 38);\n    i0.ɵɵtext(13, \"Overpayment Period\\n              \");\n    i0.ɵɵelement(14, \"p-sortIcon\", 39);\n    i0.ɵɵtext(15, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(16, \"\\n            \");\n    i0.ɵɵelementStart(17, \"th\", 40);\n    i0.ɵɵtext(18, \"NRIC\\n              \");\n    i0.ɵɵelement(19, \"p-sortIcon\", 41);\n    i0.ɵɵtext(20, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(21, \"\\n            \");\n    i0.ɵɵelementStart(22, \"th\", 42);\n    i0.ɵɵtext(23, \"Amount to Write-Off\\n              \");\n    i0.ɵɵelement(24, \"p-sortIcon\", 43);\n    i0.ɵɵtext(25, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(26, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(27, \"\\n        \");\n  }\n}\nfunction ApproveAnnualWriteOffComponent_p_table_22_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n            \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n            \");\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n            \");\n    i0.ɵɵelementStart(12, \"td\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n            \");\n    i0.ɵɵelementStart(15, \"td\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(18, \"\\n        \");\n  }\n  if (rf & 2) {\n    const writeOffRecord_r14 = ctx.$implicit;\n    const i_r15 = ctx.rowIndex;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r15 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(writeOffRecord_r14 == null ? null : writeOffRecord_r14.overpayment == null ? null : writeOffRecord_r14.overpayment.id);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", writeOffRecord_r14 == null ? null : writeOffRecord_r14.overpayment == null ? null : writeOffRecord_r14.overpayment.trgStart, \" - \", writeOffRecord_r14 == null ? null : writeOffRecord_r14.overpayment == null ? null : writeOffRecord_r14.overpayment.trgEnd, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(writeOffRecord_r14 == null ? null : writeOffRecord_r14.nric);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(writeOffRecord_r14 == null ? null : writeOffRecord_r14.amountToWriteoff);\n  }\n}\nfunction ApproveAnnualWriteOffComponent_p_table_22_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n            \");\n    i0.ɵɵelementStart(3, \"td\", 44);\n    i0.ɵɵtext(4, \"No Annual Write-off records found.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n        \");\n  }\n}\nconst _c2 = function () {\n  return [10, 25, 50];\n};\nfunction ApproveAnnualWriteOffComponent_p_table_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p-table\", 29);\n    i0.ɵɵtext(1, \"\\n        \");\n    i0.ɵɵtemplate(2, ApproveAnnualWriteOffComponent_p_table_22_ng_template_2_Template, 12, 0, \"ng-template\", 30);\n    i0.ɵɵtext(3, \"\\n        \");\n    i0.ɵɵtemplate(4, ApproveAnnualWriteOffComponent_p_table_22_ng_template_4_Template, 28, 0, \"ng-template\", 17);\n    i0.ɵɵtext(5, \"\\n\\n        \");\n    i0.ɵɵtemplate(6, ApproveAnnualWriteOffComponent_p_table_22_ng_template_6_Template, 19, 6, \"ng-template\", 18);\n    i0.ɵɵtext(7, \"\\n\\n        \");\n    i0.ɵɵtemplate(8, ApproveAnnualWriteOffComponent_p_table_22_ng_template_8_Template, 7, 0, \"ng-template\", 31);\n    i0.ɵɵtext(9, \"\\n      \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", ctx_r0.annualWriteOffDataArray.pendingWriteOffs)(\"paginator\", true)(\"rows\", 10)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(5, _c2))(\"showCurrentPageReport\", true);\n  }\n}\nfunction ApproveAnnualWriteOffComponent_div_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"\\n                \");\n    i0.ɵɵelementStart(2, \"div\");\n    i0.ɵɵtext(3, \"\\n                  Please upload file for verification.\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"\\n                \");\n    i0.ɵɵelementStart(5, \"div\");\n    i0.ɵɵtext(6, \"\\n                  File verification is required for approval.\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n              \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ApproveAnnualWriteOffComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"\\n                  File verified.\\n              \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ApproveAnnualWriteOffComponent_ng_template_68_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n              \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementStart(3, \"th\", 35);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n                \");\n    i0.ɵɵelementStart(6, \"th\", 45);\n    i0.ɵɵtext(7, \"Filename\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(9, \"\\n            \");\n  }\n}\nfunction ApproveAnnualWriteOffComponent_ng_template_70_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n              \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n                \");\n    i0.ɵɵelementStart(6, \"td\")(7, \"a\", 46);\n    i0.ɵɵlistener(\"click\", function ApproveAnnualWriteOffComponent_ng_template_70_Template_a_click_7_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r19);\n      const record_r16 = restoredCtx.$implicit;\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.downloadFromDMS(record_r16.documentId));\n    });\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(9, \"\\n              \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n            \");\n  }\n  if (rf & 2) {\n    const record_r16 = ctx.$implicit;\n    const i_r17 = ctx.rowIndex;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r17 + 1);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(record_r16.filename);\n  }\n}\nconst _c3 = function () {\n  return {\n    \"margin-left\": \".5em\"\n  };\n};\nfunction ApproveAnnualWriteOffComponent_ng_template_104_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r21 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n    \");\n    i0.ɵɵelementStart(1, \"button\", 47);\n    i0.ɵɵlistener(\"click\", function ApproveAnnualWriteOffComponent_ng_template_104_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.displayRejectionReasonDialog.display = false);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(2, \"\\n    \");\n    i0.ɵɵelementStart(3, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function ApproveAnnualWriteOffComponent_ng_template_104_Template_button_click_3_listener($event) {\n      i0.ɵɵrestoreView(_r21);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.onSubmitRejection($event, \"annualWriteoffRejectConfirmation\", ctx_r22.displayRejectionReasonDialog));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"\\n  \");\n  }\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n    const _r6 = i0.ɵɵreference(102);\n    i0.ɵɵadvance(1);\n    i0.ɵɵstyleMap(i0.ɵɵpureFunction0(5, _c3));\n    i0.ɵɵadvance(2);\n    i0.ɵɵstyleMap(i0.ɵɵpureFunction0(6, _c3));\n    i0.ɵɵproperty(\"disabled\", !_r6.rejectionReasonForm.valid);\n  }\n}\nconst _c4 = function () {\n  return {\n    \"justify-content\": \"end\"\n  };\n};\nconst _c5 = function () {\n  return {\n    \"margin-left\": \".5em\",\n    \"margin-bottom\": \".5em\"\n  };\n};\nconst _c6 = function () {\n  return {\n    width: \"50vw\"\n  };\n};\nconst _c7 = function () {\n  return {\n    \"960px\": \"75vw\"\n  };\n};\nclass ApproveAnnualWriteOffComponent {\n  constructor(annualWriteOffService, writeOffService, nspConfirmService, toastService, fb, router, route, fileUploadService) {\n    this.annualWriteOffService = annualWriteOffService;\n    this.writeOffService = writeOffService;\n    this.nspConfirmService = nspConfirmService;\n    this.toastService = toastService;\n    this.fb = fb;\n    this.router = router;\n    this.route = route;\n    this.fileUploadService = fileUploadService;\n    this.sourceFileVerified = false;\n    this.displayRejectionReasonDialog = {\n      display: false\n    };\n    // Enumeration object for decoding common NSPAY2.0 statuses\n    this.n2StatusEnum = nspapp_constants_1.Ns2Status;\n    this.approveAnnualWriteoffUploadsForm = this.fb.group({\n      sourceFile: new forms_1.FormControl([], [fileupload2_directive_1.FileUploadValidator2.maxFileLimit(1), fileupload2_directive_1.FileUploadValidator2.allowableExtension(\".txt,.csv\")])\n    });\n    this.fileUploadFileLimit = 1;\n  }\n  ngOnInit() {\n    this.annualWriteOffDataArray = new view_annual_write_off_data_model_1.ViewAnnualWriteOffData();\n    this.route.params.subscribe(params => {\n      const annualWriteOffRecordId = params['annualWriteOffId'];\n      this.load(annualWriteOffRecordId);\n    });\n  }\n  load(annualWriteOffRecordId) {\n    this.annualWriteOffService.getById(annualWriteOffRecordId).subscribe(res => {\n      // Pipe response to an array of Interface model\n      this.annualWriteOffDataArray.annualWriteoff = res.body?.data;\n      if (res.body?.data === null || this.n2StatusEnum[this.annualWriteOffDataArray.annualWriteoff.status] !== nspapp_constants_1.Ns2Status.PENDING_APPROVAL) {\n        this.toastService.info(\"Annual Writeoff record is not Pending Approval\");\n        this.router.navigate(['/inbox']);\n      }\n      console.log(\"annual\", this.annualWriteOffDataArray.annualWriteoff);\n      console.log(\"pending\", this.annualWriteOffDataArray.pendingWriteOffs);\n    }, error => {\n      this.toastService.error(error.message);\n    });\n  }\n  loadWriteOffs() {\n    // TODO update with overpay details\n    this.writeOffService.getPendingApprovalWriteOffs(this.annualWriteOffDataArray.annualWriteoff?.id).subscribe(res => {\n      // console.log(this.route);\n      // Pipe response to an array of Interface model\n      this.annualWriteOffDataArray.pendingWriteOffs = res.body?.data?.content;\n      console.log(this.annualWriteOffDataArray);\n    }, error => {\n      this.toastService.error(error.message);\n    });\n  }\n  onSubmit(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog);\n  }\n  onSubmitVerificationFile(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\n      const request = {\n        fileTxnId: this.sourceFileUploadComponent.verifiedFiles.map(x => String(x.meta_data.id))[0]\n      };\n      console.log(request);\n      this.annualWriteOffService.verifySource(this.annualWriteOffDataArray.annualWriteoff?.id, request).subscribe(res => {\n        const verified = res.body?.data;\n        if (verified) {\n          this.sourceFileVerified = true;\n          this.sourceFileUploadComponent.disableButton = true;\n          this.loadWriteOffs();\n        } else {\n          this.toastService.error(\"Failed to verify source file\");\n        }\n      });\n    });\n  }\n  onSubmitApprove(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\n      // Call the service to approve the record\n      this.annualWriteOffService.approveAnnualWriteoff(this.annualWriteOffDataArray.annualWriteoff).subscribe(res => {\n        if (res) {\n          if (res.ok) {\n            this.toastService.success(res.body.success_message);\n            this.router.navigate(['/inbox']);\n          }\n        }\n      });\n    });\n  }\n  onSubmitRejection(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\n      // Call the service to reject the record\n      this.annualWriteOffDataArray.annualWriteoff.reason = this.rejectionReasonComponent.rejectionReason;\n      this.annualWriteOffService.rejectAnnualWriteoff(this.annualWriteOffDataArray.annualWriteoff).subscribe(res => {\n        if (res) {\n          if (res.ok) {\n            this.toastService.success(res.body.success_message);\n            this.router.navigate(['/inbox']);\n          }\n        }\n      });\n    });\n  }\n  // Pop up the Confirmation dialog to Cancel current transaction\n  onCancel(event, key, dialog) {\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\n      // Define function that will be called upon confirmation of the cancellation dialog\n      // Will route back to Inbox upon cancellation in this case\n      this.router.navigate(['/inbox']);\n    });\n  }\n  onOpen(dialog) {\n    console.log('Opening dialog now');\n    dialog.display = true;\n  }\n  exportCSV() {\n    // TODO: Implement export CSV function or call it from a utility class\n  }\n  downloadFromDMS(fileId) {\n    if (fileId) {\n      this.fileUploadService.downloadTxnId(fileId).subscribe(res => {\n        if (res) {\n          const data = res;\n          const contentDispositionHeader = data.headers.get('content-disposition');\n          const fileName = contentDispositionHeader.split(';')[1].trim().split('=')[1].replace(/\"/g, '');\n          const blob = new Blob([data.body], {\n            type: data.headers.get('content-type')\n          });\n          const anchor = document.createElement(\"a\");\n          anchor.href = URL.createObjectURL(blob);\n          anchor.download = fileName;\n          anchor.click();\n        }\n      }, error => {\n        this.toastService.error(error.error?.error_desc);\n      });\n      screenTop;\n    }\n  }\n}\nexports.ApproveAnnualWriteOffComponent = ApproveAnnualWriteOffComponent;\nApproveAnnualWriteOffComponent.ɵfac = function ApproveAnnualWriteOffComponent_Factory(t) {\n  return new (t || ApproveAnnualWriteOffComponent)(i0.ɵɵdirectiveInject(i1.AnnualWriteOffService), i0.ɵɵdirectiveInject(i2.WriteOffService), i0.ɵɵdirectiveInject(i3.NspConfirmationService), i0.ɵɵdirectiveInject(i4.CustomToastService), i0.ɵɵdirectiveInject(i5.FormBuilder), i0.ɵɵdirectiveInject(i6.Router), i0.ɵɵdirectiveInject(i6.ActivatedRoute), i0.ɵɵdirectiveInject(i7.FileUploadService));\n};\nApproveAnnualWriteOffComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ApproveAnnualWriteOffComponent,\n  selectors: [[\"n2-approve-annual-write-off\"]],\n  viewQuery: function ApproveAnnualWriteOffComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 7);\n      i0.ɵɵviewQuery(_c1, 7);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sourceFileUploadComponent = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.rejectionReasonComponent = _t.first);\n    }\n  },\n  decls: 109,\n  vars: 44,\n  consts: [[3, \"formGroup\"], [1, \"grid\"], [1, \"col-8\"], [\"header\", \"Annual Write-Off\"], [1, \"col-4\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"paginator\", \"rows\", \"rowsPerPageOptions\", \"showCurrentPageReport\", 4, \"ngIf\"], [\"header\", \"Verify Source File\"], [\"formControlName\", \"sourceFile\", \"id\", \"sourceFile\", 3, \"externalFileLimit\", \"contentHeight\"], [\"sourceFile\", \"\"], [1, \"col-9\"], [4, \"ngIf\"], [1, \"col-3\"], [1, \"flex\"], [\"pButton\", \"\", \"label\", \"Submit\", 3, \"disabled\", \"click\"], [\"key\", \"annualWriteOffFileVerifyUpload\"], [\"header\", \"Supporting Document\"], [\"styleClass\", \"p-datatable-gridlines\", 3, \"value\", \"paginator\", \"rows\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [1, \"col-12\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Cancel\", 1, \"p-button-danger\", 3, \"click\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Reject\", 1, \"p-button-outlined\", 3, \"click\"], [\"type\", \"button\", \"pButton\", \"\", \"label\", \"Approve\", 3, \"disabled\", \"click\"], [\"key\", \"annualWriteOffCancel\"], [\"key\", \"annualWriteOffApprove\"], [\"header\", \"Reject Annual Writeoff\", 3, \"visible\", \"breakpoints\", \"draggable\", \"resizable\", \"modal\", \"visibleChange\"], [\"rejectionReasonDialog\", \"\"], [\"pTemplate\", \"footer\"], [\"key\", \"annualWriteoffRejectConfirmation\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"value\", \"paginator\", \"rows\", \"rowsPerPageOptions\", \"showCurrentPageReport\"], [\"pTemplate\", \"caption\"], [\"pTemplate\", \"emptymessage\"], [1, \"col-1\", \"nsp-align-left\", \"flex\", \"justify-content-start\", \"align-items-center\"], [\"type\", \"button\", \"pButton\", \"\", \"pRipple\", \"\", \"icon\", \"pi pi-file-o\", \"pTooltip\", \"Export as CSV\", \"tooltipPosition\", \"bottom\", 3, \"click\"], [1, \"col-6\", \"nsp-align-left\", \"flex\", \"justify-content-start\", \"align-items-center\"], [\"scope\", \"col\", 1, \"snHeader\"], [\"scope\", \"col\", \"pSortableColumn\", \"overpaymentId\", 1, \"overpaymentIdHeader\"], [\"field\", \"overpaymentId\"], [\"scope\", \"col\", \"pSortableColumn\", \"overpaymentPeriod\", 1, \"overpaymentPeriodHeader\"], [\"field\", \"overpaymentPeriod\"], [\"scope\", \"col\", \"pSortableColumn\", \"nric\", 1, \"nricHeader\"], [\"field\", \"nric\"], [\"scope\", \"col\", \"pSortableColumn\", \"amountToWriteOff\"], [\"field\", \"amountToWriteOff\"], [\"colspan\", \"5\"], [\"scope\", \"col\"], [\"href\", \"javascript:void(0)\", 3, \"click\"], [\"pButton\", \"\", \"label\", \"Cancel\", 1, \"p-button-danger\", 3, \"click\"]],\n  template: function ApproveAnnualWriteOffComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"form\", 0);\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelementStart(2, \"div\", 1);\n      i0.ɵɵtext(3, \"\\n    \");\n      i0.ɵɵtext(4, \"\\n    \");\n      i0.ɵɵelementStart(5, \"div\", 2);\n      i0.ɵɵtext(6, \"\\n      \");\n      i0.ɵɵelementStart(7, \"p-panel\", 3);\n      i0.ɵɵtext(8, \"\\n        \");\n      i0.ɵɵelementStart(9, \"div\", 1);\n      i0.ɵɵtext(10, \"\\n          \");\n      i0.ɵɵelementStart(11, \"div\", 4);\n      i0.ɵɵtext(12);\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(13, \"\\n          \");\n      i0.ɵɵelementStart(14, \"div\", 2);\n      i0.ɵɵtext(15);\n      i0.ɵɵpipe(16, \"currency\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(17, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(18, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(19, \"\\n\\n      \");\n      i0.ɵɵelement(20, \"br\");\n      i0.ɵɵtext(21, \"\\n      \");\n      i0.ɵɵtemplate(22, ApproveAnnualWriteOffComponent_p_table_22_Template, 10, 6, \"p-table\", 5);\n      i0.ɵɵtext(23, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(24, \"\\n\\n    \");\n      i0.ɵɵelementStart(25, \"div\", 4);\n      i0.ɵɵtext(26, \"\\n      \");\n      i0.ɵɵtext(27, \"\\n      \");\n      i0.ɵɵelementStart(28, \"div\");\n      i0.ɵɵtext(29, \"\\n        \");\n      i0.ɵɵelementStart(30, \"p-panel\", 6);\n      i0.ɵɵtext(31, \"\\n          \");\n      i0.ɵɵelement(32, \"n2-file-upload\", 7, 8);\n      i0.ɵɵtext(34, \"\\n          \");\n      i0.ɵɵelement(35, \"br\");\n      i0.ɵɵtext(36, \"\\n          \");\n      i0.ɵɵelementStart(37, \"div\", 1);\n      i0.ɵɵtext(38, \"\\n            \");\n      i0.ɵɵelementStart(39, \"div\", 9);\n      i0.ɵɵtext(40, \"\\n              \");\n      i0.ɵɵtemplate(41, ApproveAnnualWriteOffComponent_div_41_Template, 8, 0, \"div\", 10);\n      i0.ɵɵtext(42, \"\\n              \");\n      i0.ɵɵtemplate(43, ApproveAnnualWriteOffComponent_div_43_Template, 2, 0, \"div\", 10);\n      i0.ɵɵtext(44, \"\\n            \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(45, \"\\n            \");\n      i0.ɵɵelementStart(46, \"div\", 11);\n      i0.ɵɵtext(47, \"\\n              \");\n      i0.ɵɵelementStart(48, \"div\", 12);\n      i0.ɵɵtext(49, \"\\n                \");\n      i0.ɵɵelementStart(50, \"button\", 13);\n      i0.ɵɵlistener(\"click\", function ApproveAnnualWriteOffComponent_Template_button_click_50_listener($event) {\n        return ctx.onSubmitVerificationFile($event, \"annualWriteOffFileVerifyUpload\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(51, \"\\n                \");\n      i0.ɵɵelement(52, \"p-confirmPopup\", 14);\n      i0.ɵɵtext(53, \"\\n              \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(54, \"\\n            \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(55, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(56, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(57, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(58, \"\\n      \");\n      i0.ɵɵelement(59, \"br\");\n      i0.ɵɵtext(60, \"\\n      \");\n      i0.ɵɵtext(61, \"\\n      \");\n      i0.ɵɵelementStart(62, \"div\");\n      i0.ɵɵtext(63, \"\\n        \");\n      i0.ɵɵelementStart(64, \"p-panel\", 15);\n      i0.ɵɵtext(65, \"\\n          \");\n      i0.ɵɵelementStart(66, \"p-table\", 16);\n      i0.ɵɵtext(67, \"\\n            \");\n      i0.ɵɵtemplate(68, ApproveAnnualWriteOffComponent_ng_template_68_Template, 10, 0, \"ng-template\", 17);\n      i0.ɵɵtext(69, \"\\n            \");\n      i0.ɵɵtemplate(70, ApproveAnnualWriteOffComponent_ng_template_70_Template, 11, 2, \"ng-template\", 18);\n      i0.ɵɵtext(71, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(72, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(73, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(74, \"\\n      \");\n      i0.ɵɵelement(75, \"br\");\n      i0.ɵɵtext(76, \"\\n      \");\n      i0.ɵɵelementStart(77, \"div\", 1);\n      i0.ɵɵtext(78, \"\\n        \");\n      i0.ɵɵelementStart(79, \"div\", 19);\n      i0.ɵɵtext(80, \"\\n          \");\n      i0.ɵɵelementStart(81, \"div\", 12);\n      i0.ɵɵtext(82, \"\\n            \");\n      i0.ɵɵelementStart(83, \"button\", 20);\n      i0.ɵɵlistener(\"click\", function ApproveAnnualWriteOffComponent_Template_button_click_83_listener($event) {\n        return ctx.onCancel($event, \"annualWriteOffCancel\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(84, \"\\n            \");\n      i0.ɵɵelementStart(85, \"button\", 21);\n      i0.ɵɵlistener(\"click\", function ApproveAnnualWriteOffComponent_Template_button_click_85_listener() {\n        return ctx.onOpen(ctx.displayRejectionReasonDialog);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(86, \"\\n            \");\n      i0.ɵɵelementStart(87, \"button\", 22);\n      i0.ɵɵlistener(\"click\", function ApproveAnnualWriteOffComponent_Template_button_click_87_listener($event) {\n        return ctx.onSubmitApprove($event, \"annualWriteOffApprove\", null);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(88, \"\\n            \");\n      i0.ɵɵelement(89, \"p-confirmPopup\", 23);\n      i0.ɵɵtext(90, \"\\n            \");\n      i0.ɵɵelement(91, \"p-confirmPopup\", 24);\n      i0.ɵɵtext(92, \"\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(93, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(94, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(95, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(96, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(97, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(98, \"\\n\");\n      i0.ɵɵelementStart(99, \"p-dialog\", 25);\n      i0.ɵɵlistener(\"visibleChange\", function ApproveAnnualWriteOffComponent_Template_p_dialog_visibleChange_99_listener($event) {\n        return ctx.displayRejectionReasonDialog.display = $event;\n      });\n      i0.ɵɵtext(100, \"\\n\\n  \");\n      i0.ɵɵelement(101, \"n2-rejection-reason\", null, 26);\n      i0.ɵɵtext(103, \"\\n\\n  \");\n      i0.ɵɵtemplate(104, ApproveAnnualWriteOffComponent_ng_template_104_Template, 5, 7, \"ng-template\", 27);\n      i0.ɵɵtext(105, \"\\n  \");\n      i0.ɵɵelement(106, \"p-confirmPopup\", 28);\n      i0.ɵɵtext(107, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(108, \"\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"formGroup\", ctx.approveAnnualWriteoffUploadsForm);\n      i0.ɵɵadvance(12);\n      i0.ɵɵtextInterpolate1(\"\\n            Total no. of record: \", ctx.annualWriteOffDataArray == null ? null : ctx.annualWriteOffDataArray.annualWriteoff == null ? null : ctx.annualWriteOffDataArray.annualWriteoff.totalCount, \"\\n          \");\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate1(\"\\n            Total Amount: \", i0.ɵɵpipeBind3(16, 32, ctx.annualWriteOffDataArray == null ? null : ctx.annualWriteOffDataArray.annualWriteoff == null ? null : ctx.annualWriteOffDataArray.annualWriteoff.totalAmountToWriteoff, \"SGD\", \"symbol-narrow\"), \"\\n          \");\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngIf\", ctx.sourceFileVerified);\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"externalFileLimit\", ctx.fileUploadFileLimit)(\"contentHeight\", \"150px\");\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"ngIf\", !ctx.sourceFileVerified);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.sourceFileVerified);\n      i0.ɵɵadvance(5);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(36, _c4));\n      i0.ɵɵadvance(2);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(37, _c5));\n      i0.ɵɵproperty(\"disabled\", ctx.sourceFileUploadComponent.verifiedFiles.length === 0 || ctx.sourceFileVerified);\n      i0.ɵɵadvance(16);\n      i0.ɵɵproperty(\"value\", ctx.annualWriteOffDataArray.annualWriteoff == null ? null : ctx.annualWriteOffDataArray.annualWriteoff.supportingDocs)(\"paginator\", true)(\"rows\", 5);\n      i0.ɵɵadvance(15);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(38, _c4));\n      i0.ɵɵadvance(2);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(39, _c3));\n      i0.ɵɵadvance(2);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(40, _c3));\n      i0.ɵɵadvance(2);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(41, _c3));\n      i0.ɵɵproperty(\"disabled\", !ctx.sourceFileVerified);\n      i0.ɵɵadvance(12);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(42, _c6));\n      i0.ɵɵproperty(\"visible\", ctx.displayRejectionReasonDialog.display)(\"breakpoints\", i0.ɵɵpureFunction0(43, _c7))(\"draggable\", false)(\"resizable\", false)(\"modal\", true);\n    }\n  },\n  dependencies: [i8.Dialog, i9.PrimeTemplate, i5.ɵNgNoValidate, i5.NgControlStatus, i5.NgControlStatusGroup, i10.NgIf, i5.FormGroupDirective, i5.FormControlName, i11.ButtonDirective, i12.Tooltip, i13.Table, i13.SortableColumn, i13.SortIcon, i14.ConfirmPopup, i15.FileUploadComponent, i16.RejectionReasonComponent, i17.Panel, i18.Ripple, i10.CurrencyPipe],\n  styles: [\"[_nghost-%COMP%]     .p-dialog-mask {\\n  background-color: rgba(0, 0, 0, 0.4);\\n}\\n\\n.snHeader[_ngcontent-%COMP%] {\\n  width: 4rem;\\n}\\n\\n.overpaymentIdHeader[_ngcontent-%COMP%] {\\n  width: 12rem;\\n}\\n\\n.nricHeader[_ngcontent-%COMP%] {\\n  width: 8rem;\\n}\\n\\n.flagHeader[_ngcontent-%COMP%] {\\n  width: 6rem;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcHJvdmUtYW5udWFsLXdyaXRlLW9mZi5jb21wb25lbnQuc2NzcyIsIi4uXFwuLlxcLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxcLi5cXHByb2plY3RzJTIwMlxcbnNwYXlpaWFwcFxcc3JjXFxtYWluXFx3ZWJhcHBcXGFwcFxccGF5bWVudFxcYW5udWFsLXdyaXRlLW9mZlxcYXBwcm92ZS1hbm51YWwtd3JpdGUtb2ZmXFxhcHByb3ZlLWFubnVhbC13cml0ZS1vZmYuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OzRFQUFBO0FBSUE7RUFDSSxvQ0FBQTtBQ0FKOztBREdBO0VBQ0ksV0FBQTtBQ0FKOztBREdBO0VBQ0ksWUFBQTtBQ0FKOztBREdBO0VBQ0ksV0FBQTtBQ0FKOztBREdBO0VBQ0ksV0FBQTtBQ0FKIiwiZmlsZSI6ImFwcHJvdmUtYW5udWFsLXdyaXRlLW9mZi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbk92ZXJyaWRlIERpYWxvZyBtYXNrIENTUyAtIENoYW5nZSBmcm9tIFRyYW5zcGFyZW50IGJhY2sgdG8gYmxhY2tcclxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi9cclxuXHJcbjpob3N0IDo6bmctZGVlcCAucC1kaWFsb2ctbWFzayB7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwNjtcclxufVxyXG5cclxuLnNuSGVhZGVyIHtcclxuICAgIHdpZHRoOiA0cmVtO1xyXG59XHJcblxyXG4ub3ZlcnBheW1lbnRJZEhlYWRlciB7XHJcbiAgICB3aWR0aDogMTJyZW07XHJcbn1cclxuXHJcbi5ucmljSGVhZGVyIHtcclxuICAgIHdpZHRoOiA4cmVtO1xyXG59XHJcblxyXG4uZmxhZ0hlYWRlciB7XHJcbiAgICB3aWR0aDogNnJlbTtcclxufSIsIi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5PdmVycmlkZSBEaWFsb2cgbWFzayBDU1MgLSBDaGFuZ2UgZnJvbSBUcmFuc3BhcmVudCBiYWNrIHRvIGJsYWNrXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xuOmhvc3QgOjpuZy1kZWVwIC5wLWRpYWxvZy1tYXNrIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjQpO1xufVxuXG4uc25IZWFkZXIge1xuICB3aWR0aDogNHJlbTtcbn1cblxuLm92ZXJwYXltZW50SWRIZWFkZXIge1xuICB3aWR0aDogMTJyZW07XG59XG5cbi5ucmljSGVhZGVyIHtcbiAgd2lkdGg6IDhyZW07XG59XG5cbi5mbGFnSGVhZGVyIHtcbiAgd2lkdGg6IDZyZW07XG59Il19 */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvcGF5bWVudC9hbm51YWwtd3JpdGUtb2ZmL2FwcHJvdmUtYW5udWFsLXdyaXRlLW9mZi9hcHByb3ZlLWFubnVhbC13cml0ZS1vZmYuY29tcG9uZW50LnNjc3MiLCJ3ZWJwYWNrOi8vLi8uLi8uLi9wcm9qZWN0cyUyMDIvbnNwYXlpaWFwcC9zcmMvbWFpbi93ZWJhcHAvYXBwL3BheW1lbnQvYW5udWFsLXdyaXRlLW9mZi9hcHByb3ZlLWFubnVhbC13cml0ZS1vZmYvYXBwcm92ZS1hbm51YWwtd3JpdGUtb2ZmLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs0RUFBQTtBQUlBO0VBQ0ksb0NBQUE7QUNBSjs7QURHQTtFQUNJLFdBQUE7QUNBSjs7QURHQTtFQUNJLFlBQUE7QUNBSjs7QURHQTtFQUNJLFdBQUE7QUNBSjs7QURHQTtFQUNJLFdBQUE7QUNBSjtBRENBLDQ0REFBNDREIiwic291cmNlc0NvbnRlbnQiOlsiLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuT3ZlcnJpZGUgRGlhbG9nIG1hc2sgQ1NTIC0gQ2hhbmdlIGZyb20gVHJhbnNwYXJlbnQgYmFjayB0byBibGFja1xyXG49PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqL1xyXG5cclxuOmhvc3QgOjpuZy1kZWVwIC5wLWRpYWxvZy1tYXNrIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDA2O1xyXG59XHJcblxyXG4uc25IZWFkZXIge1xyXG4gICAgd2lkdGg6IDRyZW07XHJcbn1cclxuXHJcbi5vdmVycGF5bWVudElkSGVhZGVyIHtcclxuICAgIHdpZHRoOiAxMnJlbTtcclxufVxyXG5cclxuLm5yaWNIZWFkZXIge1xyXG4gICAgd2lkdGg6IDhyZW07XHJcbn1cclxuXHJcbi5mbGFnSGVhZGVyIHtcclxuICAgIHdpZHRoOiA2cmVtO1xyXG59IiwiLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbk92ZXJyaWRlIERpYWxvZyBtYXNrIENTUyAtIENoYW5nZSBmcm9tIFRyYW5zcGFyZW50IGJhY2sgdG8gYmxhY2tcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovXG46aG9zdCA6Om5nLWRlZXAgLnAtZGlhbG9nLW1hc2sge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuNCk7XG59XG5cbi5zbkhlYWRlciB7XG4gIHdpZHRoOiA0cmVtO1xufVxuXG4ub3ZlcnBheW1lbnRJZEhlYWRlciB7XG4gIHdpZHRoOiAxMnJlbTtcbn1cblxuLm5yaWNIZWFkZXIge1xuICB3aWR0aDogOHJlbTtcbn1cblxuLmZsYWdIZWFkZXIge1xuICB3aWR0aDogNnJlbTtcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":";;;;;;;AAIA;AAIA;AAEA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;ICSUA;IAAAA,8BAAkB;IAChBA;IAAAA,+BAAgF;IAC9EA;IAAAA,kCACiC;IADyBA;MAAAA;MAAA;MAAA,OAASA,kCAAW;IAAA,EAAC;IAC9CA,iBAAS;IAC5CA;IAAAA,iBAAM;IACNA;IAAAA,+BAAgF;IAAAA,8BAAc;IAAAA,iBAAM;IACtGA;IAAAA,iBAAM;IACRA;;;;;IAEEA;IAAAA,0BAAI;IACFA;IAAAA,8BAAiC;IAAAA,kBAAE;IAAAA,iBAAK;IACxCA;IAAAA,8BAA4E;IAAAA,8CAC1E;IAAAA,sCACwB;IACxBA;IAAAA,iBAAa;IACfA;IAAAA,iBAAK;IACLA;IAAAA,+BAAoF;IAAAA,mDAClF;IAAAA,kCACyC;IAC3CA;IAAAA,iBAAK;IACLA;IAAAA,+BAA0D;IAAAA,qCACxD;IAAAA,kCAAsC;IACxCA;IAAAA,iBAAK;IACLA;IAAAA,+BAAmD;IAAAA,oDACjD;IAAAA,kCAAkD;IACpDA;IAAAA,iBAAK;IACPA;IAAAA,iBAAK;IACPA;;;;;IAGEA;IAAAA,0BAAI;IACFA;IAAAA,0BAAI;IAAAA,YAAW;IAAAA,iBAAK;IACpBA;IAAAA,0BAAI;IAAAA,YAAoC;IAAAA,iBAAK;IAC7CA;IAAAA,0BAAI;IAAAA,aAAqF;IAAAA,iBAAK;IAC9FA;IAAAA,2BAAI;IAAAA,aAAyB;IAAAA,iBAAK;IAClCA;IAAAA,2BAAI;IAAAA,aAAqC;IAAAA,iBAAK;IAChDA;IAAAA,iBAAK;IACPA;;;;;IANQA,eAAW;IAAXA,+BAAW;IACXA,eAAoC;IAApCA,2IAAoC;IACpCA,eAAqF;IAArFA,4RAAqF;IACrFA,eAAyB;IAAzBA,iFAAyB;IACzBA,eAAqC;IAArCA,6FAAqC;;;;;IAK3CA;IAAAA,0BAAI;IACFA;IAAAA,8BAAgB;IAAAA,kDAAkC;IAAAA,iBAAK;IACzDA;IAAAA,iBAAK;IACPA;;;;;;;;IAhDFA,mCAGyF;IACvFA;IAAAA,4GAQc;IACdA;IAAAA,4GAmBc;IAEdA;IAAAA,4GAQc;IAEdA;IAAAA,2GAIc;IAChBA;IAAAA,iBAAU;;;;IAjD0BA,uEAAkD;;;;;IA6D9EA,2BAAiC;IAC/BA;IAAAA,2BAAK;IACHA,0FACF;IAAAA,iBAAM;IACNA;IAAAA,2BAAK;IACHA,iGACF;IAAAA,iBAAM;IACRA;IAAAA,iBAAM;;;;;IACNA,2BAAgC;IAC5BA,kEACJ;IAAAA,iBAAM;;;;;IAoBNA;IAAAA,0BAAI;IACFA;IAAAA,8BAAiC;IAAAA,kBAAE;IAAAA,iBAAK;IACxCA;IAAAA,8BAAgB;IAAAA,wBAAQ;IAAAA,iBAAK;IAC/BA;IAAAA,iBAAK;IACPA;;;;;;IAEEA;IAAAA,0BAAI;IACFA;IAAAA,0BAAI;IAAAA,YAAO;IAAAA,iBAAK;IAChBA;IAAAA,0BAAI;IAA6BA;MAAA;MAAA;MAAA;MAAA,OAASA,6DAAkC;IAAA,EAAC;IAACA,YAAmB;IAAAA,iBAAI;IACvGA;IAAAA,iBAAK;IACPA;;;;;IAHQA,eAAO;IAAPA,+BAAO;IACmEA,eAAmB;IAAnBA,yCAAmB;;;;;;;;;;;IAkC7GA;IAAAA,kCAE0C;IADlCA;MAAAA;MAAA;MAAA,OAASA,8DAAqC,KAAK;IAAA,EAAC;IAClBA,iBAAS;IACnDA;IAAAA,kCAE0C;IADlCA;MAAAA;MAAA;MAAA,OAASA,iDAA0B,kCAAkC,uCAA+B;IAAA,EAAC;IACnEA,iBAAS;IACrDA;;;;;IAJUA,eAAiC;IAAjCA,yCAAiC;IAGjCA,eAAiC;IAAjCA,yCAAiC;IAFVA,yDAA6D;;;;;;;;;;;;;;;;;;;;;;;;ADzIhG,MAKaC,8BAA8B;EAoBzCC,YACUC,qBAA4C,EAC5CC,eAAgC,EAChCC,iBAAyC,EACzCC,YAAgC,EAChCC,EAAe,EACfC,MAAc,EACdC,KAAqB,EACrBC,iBAAoC;IAPpC,0BAAqB,GAArBP,qBAAqB;IACrB,oBAAe,GAAfC,eAAe;IACf,sBAAiB,GAAjBC,iBAAiB;IACjB,iBAAY,GAAZC,YAAY;IACZ,OAAE,GAAFC,EAAE;IACF,WAAM,GAANC,MAAM;IACN,UAAK,GAALC,KAAK;IACL,sBAAiB,GAAjBC,iBAAiB;IA1B3B,uBAAkB,GAAG,KAAK;IAC1B,iCAA4B,GAAQ;MAACC,OAAO,EAAE;IAAK,CAAC;IAEpD;IACA,iBAAY,GAAiCC,4BAAS;IAEtD,qCAAgC,GAAc,IAAI,CAACL,EAAE,CAACM,KAAK,CAAC;MAC1DC,UAAU,EAAE,IAAIC,mBAAW,CAAC,EAAE,EAAE,CAACC,4CAAoB,CAACC,YAAY,CAAC,CAAC,CAAC,EAAED,4CAAoB,CAACE,kBAAkB,CAAC,WAAW,CAAC,CAAC;KAC7H,CAAC;IAEF,wBAAmB,GAAG,CAAC;EAkBvB;EAEAC,QAAQ;IACN,IAAI,CAACC,uBAAuB,GAAG,IAAIC,yDAAsB;IACzD,IAAI,CAACZ,KAAK,CAACa,MAAM,CAACC,SAAS,CAACD,MAAM,IAAG;MACnC,MAAME,sBAAsB,GAAGF,MAAM,CAAC,kBAAkB,CAAC;MACzD,IAAI,CAACG,IAAI,CAACD,sBAAsB,CAAC;IACnC,CAAC,CAAC;EACJ;EAEAC,IAAI,CAACD,sBAA8B;IACjC,IAAI,CAACrB,qBAAqB,CAACuB,OAAO,CAACF,sBAAsB,CAAC,CAACD,SAAS,CACjEI,GAAsB,IAAI;MACzB;MACA,IAAI,CAACP,uBAAuB,CAACQ,cAAc,GAAGD,GAAG,CAACE,IAAI,EAAEC,IAAI;MAC5D,IAAIH,GAAG,CAACE,IAAI,EAAEC,IAAI,KAAK,IAAI,IAAI,IAAI,CAACC,YAAY,CAAC,IAAI,CAACX,uBAAuB,CAACQ,cAAc,CAACI,MAAM,CAAC,KAAKpB,4BAAS,CAACqB,gBAAgB,EAAE;QACnI,IAAI,CAAC3B,YAAY,CAAC4B,IAAI,CAAC,gDAAgD,CAAC;QACxE,IAAI,CAAC1B,MAAM,CAAC2B,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;;MAElCC,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAACjB,uBAAuB,CAACQ,cAAc,CAAC;MAClEQ,OAAO,CAACC,GAAG,CAAC,SAAS,EAAE,IAAI,CAACjB,uBAAuB,CAACkB,gBAAgB,CAAC;IAEvE,CAAC,EACAC,KAAwB,IAAI;MAC3B,IAAI,CAACjC,YAAY,CAACiC,KAAK,CAACA,KAAK,CAACC,OAAO,CAAC;IACxC,CAAC,CACF;EACH;EAEAC,aAAa;IACX;IACA,IAAI,CAACrC,eAAe,CAACsC,2BAA2B,CAAC,IAAI,CAACtB,uBAAuB,CAACQ,cAAc,EAAEe,EAAE,CAAC,CAACpB,SAAS,CACxGI,GAAsB,IAAI;MACzB;MACA;MACA,IAAI,CAACP,uBAAuB,CAACkB,gBAAgB,GAAGX,GAAG,CAACE,IAAI,EAAEC,IAAI,EAAEc,OAAO;MACvER,OAAO,CAACC,GAAG,CAAC,IAAI,CAACjB,uBAAuB,CAAC;IAC3C,CAAC,EACAmB,KAAwB,IAAI;MAC3B,IAAI,CAACjC,YAAY,CAACiC,KAAK,CAACA,KAAK,CAACC,OAAO,CAAC;IACxC,CAAC,CACF;EAEH;EAEAK,QAAQ,CAACC,KAAY,EAAEC,GAAW,EAAEC,MAAW;IAC7C,IAAI,CAAC3C,iBAAiB,CAAC4C,cAAc,CAACH,KAAK,EAAEC,GAAG,EAAEC,MAAM,CAAC;EAC3D;EAEAE,wBAAwB,CAACJ,KAAY,EAAEC,GAAW,EAAEC,MAAW;IAC7D,IAAI,CAAC3C,iBAAiB,CAAC4C,cAAc,CAACH,KAAK,EAAEC,GAAG,EAAEC,MAAM,EAAE,MAAK;MAC7D,MAAMG,OAAO,GAAG;QACdC,SAAS,EAAE,IAAI,CAACC,yBAAyB,CAACC,aAAa,CAACC,GAAG,CAACC,CAAC,IAAIC,MAAM,CAACD,CAAC,CAACE,SAAS,CAACf,EAAE,CAAC,CAAC,CAAC,CAAC;OAC3F;MAEDP,OAAO,CAACC,GAAG,CAACc,OAAO,CAAC;MACpB,IAAI,CAAChD,qBAAqB,CAACwD,YAAY,CAAC,IAAI,CAACvC,uBAAuB,CAACQ,cAAc,EAAEe,EAAE,EAAEQ,OAAO,CAAC,CAAC5B,SAAS,CACzGI,GAAG,IAAG;QACJ,MAAMiC,QAAQ,GAAGjC,GAAG,CAACE,IAAI,EAAEC,IAAI;QAC/B,IAAI8B,QAAQ,EAAE;UACZ,IAAI,CAACC,kBAAkB,GAAG,IAAI;UAC9B,IAAI,CAACR,yBAAyB,CAACS,aAAa,GAAG,IAAI;UACnD,IAAI,CAACrB,aAAa,EAAE;SACrB,MAAM;UACL,IAAI,CAACnC,YAAY,CAACiC,KAAK,CAAC,8BAA8B,CAAC;;MAE3D,CAAC,CACF;IACH,CAAC,CAAC;EACJ;EAEAwB,eAAe,CAACjB,KAAY,EAAEC,GAAW,EAAEC,MAAW;IACpD,IAAI,CAAC3C,iBAAiB,CAAC4C,cAAc,CAACH,KAAK,EAAEC,GAAG,EAAEC,MAAM,EAAE,MAAK;MAC7D;MACA,IAAI,CAAC7C,qBAAqB,CAAC6D,qBAAqB,CAAC,IAAI,CAAC5C,uBAAuB,CAACQ,cAAc,CAAC,CAACL,SAAS,CAACI,GAAG,IAAG;QAC5G,IAAIA,GAAG,EAAE;UACP,IAAIA,GAAG,CAACsC,EAAE,EAAE;YACV,IAAI,CAAC3D,YAAY,CAAC4D,OAAO,CAACvC,GAAG,CAACE,IAAI,CAACsC,eAAe,CAAC;YACnD,IAAI,CAAC3D,MAAM,CAAC2B,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;;;MAGtC,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEAiC,iBAAiB,CAACtB,KAAY,EAAEC,GAAW,EAAEC,MAAW;IACtD,IAAI,CAAC3C,iBAAiB,CAAC4C,cAAc,CAACH,KAAK,EAAEC,GAAG,EAAEC,MAAM,EAAE,MAAK;MAC7D;MACA,IAAI,CAAC5B,uBAAuB,CAACQ,cAAc,CAACyC,MAAM,GAAG,IAAI,CAACC,wBAAwB,CAACC,eAAe;MAClG,IAAI,CAACpE,qBAAqB,CAACqE,oBAAoB,CAAC,IAAI,CAACpD,uBAAuB,CAACQ,cAAc,CAAC,CAACL,SAAS,CAACI,GAAG,IAAG;QAC3G,IAAIA,GAAG,EAAE;UACP,IAAIA,GAAG,CAACsC,EAAE,EAAE;YACV,IAAI,CAAC3D,YAAY,CAAC4D,OAAO,CAACvC,GAAG,CAACE,IAAI,CAACsC,eAAe,CAAC;YACnD,IAAI,CAAC3D,MAAM,CAAC2B,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;;;MAGtC,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEA;EACAsC,QAAQ,CAAC3B,KAAY,EAAEC,GAAW,EAAEC,MAAW;IAC7C,IAAI,CAAC3C,iBAAiB,CAAC4C,cAAc,CAACH,KAAK,EAAEC,GAAG,EAC9CC,MAAM,EAAE,MAAK;MACX;MACA;MACA,IAAI,CAACxC,MAAM,CAAC2B,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;IAClC,CAAC,CAAC;EACN;EAEAuC,MAAM,CAAC1B,MAAW;IAChBZ,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;IACjCW,MAAM,CAACrC,OAAO,GAAG,IAAI;EACvB;EAEAgE,SAAS;IACP;EAAA;EAGFC,eAAe,CAACC,MAAc;IAC5B,IAAIA,MAAM,EAAE;MACV,IAAI,CAACnE,iBAAiB,CAACoE,aAAa,CAACD,MAAM,CAAC,CAACtD,SAAS,CACpDI,GAAG,IAAG;QACJ,IAAIA,GAAG,EAAE;UACP,MAAMG,IAAI,GAAGH,GAAG;UAChB,MAAMoD,wBAAwB,GAAWjD,IAAI,CAACkD,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;UAChF,MAAMC,QAAQ,GAAGH,wBAAwB,CAACI,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAACC,IAAI,EAAE,CAACD,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAACE,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;UAC9F,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACzD,IAAI,CAACD,IAAI,CAAC,EAAE;YAAC2D,IAAI,EAAE1D,IAAI,CAACkD,OAAO,CAACC,GAAG,CAAC,cAAc;UAAC,CAAC,CAAC;UAC5E,MAAMQ,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;UAC1CF,MAAM,CAACG,IAAI,GAAGC,GAAG,CAACC,eAAe,CAACR,IAAI,CAAC;UACvCG,MAAM,CAACM,QAAQ,GAAGb,QAAQ;UAC1BO,MAAM,CAACO,KAAK,EAAE;;MAElB,CAAC,EACDzD,KAAK,IAAG;QACN,IAAI,CAACjC,YAAY,CAACiC,KAAK,CAACA,KAAK,CAACA,KAAK,EAAE0D,UAAU,CAAC;MAClD,CAAC,CACF;MACDC,SAAS;;EAEb;;AA/KFC;;mBAKalG,8BAA8B;AAAA;;QAA9BA,8BAA8B;EAAAmG;EAAAC;IAAA;;;;;;;;;;;;;;;MCpB3CrG,+BAAqD;MACnDA;MAAAA,8BAAkB;MAChBA;MACAA;MAAAA,8BAAmB;MACjBA;MAAAA,kCAAmC;MACjCA;MAAAA,8BAAkB;MAChBA;MAAAA,+BAAmB;MACjBA,aACF;MAAAA,iBAAM;MACNA;MAAAA,+BAAmB;MACjBA,aACF;;MAAAA,iBAAM;MACRA;MAAAA,iBAAM;MACRA;MAAAA,iBAAU;MAEVA;MAAAA,sBAAI;MACJA;MAAAA,0FAiDU;MACZA;MAAAA,iBAAM;MAENA;MAAAA,+BAAmB;MACjBA;MACAA;MAAAA,4BAAK;MACHA;MAAAA,mCAAqC;MACnCA;MAAAA,wCACuF;MACvFA;MAAAA,sBAAI;MACJA;MAAAA,+BAAkB;MAChBA;MAAAA,+BAAmB;MACjBA;MAAAA,kFAOM;MACNA;MAAAA,kFAEM;MACRA;MAAAA,iBAAM;MACNA;MAAAA,gCAAmB;MACjBA;MAAAA,gCAAuD;MACrDA;MAAAA,mCAEoE;MAD5DA;QAAA,OAASsG,qCAAiC,gCAAgC,EAAE,IAAI,CAAC;MAAA,EAAC;MACtBtG,iBAAS;MAC7EA;MAAAA,sCAAsE;MACxEA;MAAAA,iBAAM;MACRA;MAAAA,iBAAM;MACRA;MAAAA,iBAAM;MACRA;MAAAA,iBAAU;MACZA;MAAAA,iBAAM;MACNA;MAAAA,sBAAI;MACJA;MACAA;MAAAA,4BAAK;MACHA;MAAAA,oCAAsC;MACpCA;MAAAA,oCACmE;MACjEA;MAAAA,mGAKc;MACdA;MAAAA,mGAKc;MAChBA;MAAAA,iBAAU;MACZA;MAAAA,iBAAU;MACZA;MAAAA,iBAAM;MACNA;MAAAA,sBAAI;MACJA;MAAAA,+BAAkB;MAChBA;MAAAA,gCAAoB;MAClBA;MAAAA,gCAAuD;MACrDA;MAAAA,mCAE0C;MADlCA;QAAA,OAASsG,qBAAiB,sBAAsB,EAAE,IAAI,CAAC;MAAA,EAAC;MACtBtG,iBAAS;MACnDA;MAAAA,mCAE0C;MADlCA;QAAA,OAASsG,4CAAoC;MAAA,EAAC;MACZtG,iBAAS;MACnDA;MAAAA,mCAE0C;MADlCA;QAAA,OAASsG,4BAAwB,uBAAuB,EAAE,IAAI,CAAC;MAAA,EAAC;MAC9BtG,iBAAS;MACnDA;MAAAA,sCAA4D;MAC5DA;MAAAA,sCAA6D;MAC/DA;MAAAA,iBAAM;MACRA;MAAAA,iBAAM;MACRA;MAAAA,iBAAM;MACRA;MAAAA,iBAAM;MACRA;MAAAA,iBAAM;MACRA;MAAAA,iBAAO;MACPA;MAAAA,qCAE2F;MAFjDA;QAAA;MAAA,EAAkD;MAI1FA;MAAAA,kDAAkE;MAElEA;MAAAA,oGAOc;MACdA;MAAAA,uCAAwE;MAC1EA;MAAAA,iBAAW;MACXA;;;MA9JMA,gEAA8C;MAOxCA,gBACF;MADEA,4OACF;MAEEA,eACF;MADEA,gSACF;MAKMA,eAAwB;MAAxBA,6CAAwB;MAyD5BA,gBAAyC;MAAzCA,2DAAyC;MAIjCA,eAAyB;MAAzBA,8CAAyB;MAQzBA,eAAwB;MAAxBA,6CAAwB;MAKZA,eAAoC;MAApCA,0CAAoC;MAG5CA,eAA2D;MAA3DA,0CAA2D;MAFpCA,6GAAuF;MAanHA,gBAAgE;MAAhEA,6IAAgE;MAoBvDA,gBAAoC;MAApCA,0CAAoC;MAG5CA,eAAiC;MAAjCA,0CAAiC;MAGjCA,eAAiC;MAAjCA,0CAAiC;MAGjCA,eAAiC;MAAjCA,0CAAiC;MAFKA,kDAAgC;MAahFA,gBAAyB;MAAzBA,0CAAyB;MAFOA,kEAAkD","names":["i0","ApproveAnnualWriteOffComponent","constructor","annualWriteOffService","writeOffService","nspConfirmService","toastService","fb","router","route","fileUploadService","display","nspapp_constants_1","group","sourceFile","forms_1","fileupload2_directive_1","maxFileLimit","allowableExtension","ngOnInit","annualWriteOffDataArray","view_annual_write_off_data_model_1","params","subscribe","annualWriteOffRecordId","load","getById","res","annualWriteoff","body","data","n2StatusEnum","status","PENDING_APPROVAL","info","navigate","console","log","pendingWriteOffs","error","message","loadWriteOffs","getPendingApprovalWriteOffs","id","content","onSubmit","event","key","dialog","onConfirmPopup","onSubmitVerificationFile","request","fileTxnId","sourceFileUploadComponent","verifiedFiles","map","x","String","meta_data","verifySource","verified","sourceFileVerified","disableButton","onSubmitApprove","approveAnnualWriteoff","ok","success","success_message","onSubmitRejection","reason","rejectionReasonComponent","rejectionReason","rejectAnnualWriteoff","onCancel","onOpen","exportCSV","downloadFromDMS","fileId","downloadTxnId","contentDispositionHeader","headers","get","fileName","split","trim","replace","blob","Blob","type","anchor","document","createElement","href","URL","createObjectURL","download","click","error_desc","screenTop","exports","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\payment\\annual-write-off\\approve-annual-write-off\\approve-annual-write-off.component.ts","C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\payment\\annual-write-off\\approve-annual-write-off\\approve-annual-write-off.component.html"],"sourcesContent":["import {HttpErrorResponse, HttpResponse} from '@angular/common/http';\r\nimport {Component, OnInit, ViewChild} from '@angular/core';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {CustomToastService} from 'app/layouts/service/customtoast.service';\r\nimport {IViewAnnualWriteOffData,ViewAnnualWriteOffData} from 'app/payment/annual-write-off/model/view-annual-write-off-data.model';\r\nimport {NspConfirmationService} from 'app/shared/confirm/nsp-confirm.service';\r\nimport {WriteOffService} from 'app/payment/annual-write-off/service/write-off.service';\r\nimport {AnnualWriteOffService} from 'app/payment/annual-write-off/service/annual-write-off.service';\r\nimport {FormBuilder, FormControl, FormGroup} from '@angular/forms';\r\nimport {RejectionReasonComponent} from 'app/shared/component/rejection-reason/rejection-reason.component';\r\nimport {FileUploadValidator2} from 'app/shared/validator/fileupload2.directive';\r\nimport {FileUploadComponent} from 'app/shared/component/file-upload/file-upload.component';\r\nimport {Ns2Status} from 'app/shared/constants/nspapp.constants';\r\nimport {FileUploadService} from 'app/shared/service/file-upload.service';\r\n\r\n@Component({\r\n  selector: 'n2-approve-annual-write-off',\r\n  templateUrl: './approve-annual-write-off.component.html',\r\n  styleUrls: ['./approve-annual-write-off.component.scss']\r\n})\r\nexport class ApproveAnnualWriteOffComponent implements OnInit {\r\n  annualWriteOffDataArray: IViewAnnualWriteOffData;\r\n  sourceFileVerified = false;\r\n  displayRejectionReasonDialog: any = {display: false};\r\n\r\n  // Enumeration object for decoding common NSPAY2.0 statuses\r\n  n2StatusEnum: { [key: string]: Ns2Status } = Ns2Status\r\n\r\n  approveAnnualWriteoffUploadsForm: FormGroup = this.fb.group({\r\n    sourceFile: new FormControl([], [FileUploadValidator2.maxFileLimit(1), FileUploadValidator2.allowableExtension(\".txt,.csv\")])\r\n  });\r\n\r\n  fileUploadFileLimit = 1;\r\n\r\n  @ViewChild('sourceFile', {static: true})\r\n  sourceFileUploadComponent!: FileUploadComponent;\r\n\r\n  @ViewChild('rejectionReasonDialog', {static: true})\r\n  private rejectionReasonComponent!: RejectionReasonComponent;\r\n\r\n  constructor(\r\n    private annualWriteOffService: AnnualWriteOffService,\r\n    private writeOffService: WriteOffService,\r\n    private nspConfirmService: NspConfirmationService,\r\n    private toastService: CustomToastService,\r\n    private fb: FormBuilder,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    private fileUploadService: FileUploadService\r\n  ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.annualWriteOffDataArray = new ViewAnnualWriteOffData;\r\n    this.route.params.subscribe(params => {\r\n      const annualWriteOffRecordId = params['annualWriteOffId'];\r\n      this.load(annualWriteOffRecordId);\r\n    });\r\n  }\r\n\r\n  load(annualWriteOffRecordId: string): void {\r\n    this.annualWriteOffService.getById(annualWriteOffRecordId).subscribe(\r\n      (res: HttpResponse<any>) => {\r\n        // Pipe response to an array of Interface model\r\n        this.annualWriteOffDataArray.annualWriteoff = res.body?.data;\r\n        if (res.body?.data === null || this.n2StatusEnum[this.annualWriteOffDataArray.annualWriteoff.status] !== Ns2Status.PENDING_APPROVAL) {\r\n          this.toastService.info(\"Annual Writeoff record is not Pending Approval\")\r\n          this.router.navigate(['/inbox']);\r\n        }\r\n        console.log(\"annual\", this.annualWriteOffDataArray.annualWriteoff);\r\n        console.log(\"pending\", this.annualWriteOffDataArray.pendingWriteOffs);\r\n\r\n      },\r\n      (error: HttpErrorResponse) => {\r\n        this.toastService.error(error.message);\r\n      }\r\n    );\r\n  }\r\n\r\n  loadWriteOffs(): void {\r\n    // TODO update with overpay details\r\n    this.writeOffService.getPendingApprovalWriteOffs(this.annualWriteOffDataArray.annualWriteoff?.id).subscribe(\r\n      (res: HttpResponse<any>) => {\r\n        // console.log(this.route);\r\n        // Pipe response to an array of Interface model\r\n        this.annualWriteOffDataArray.pendingWriteOffs = res.body?.data?.content;\r\n        console.log(this.annualWriteOffDataArray);\r\n      },\r\n      (error: HttpErrorResponse) => {\r\n        this.toastService.error(error.message);\r\n      }\r\n    );\r\n\r\n  }\r\n\r\n  onSubmit(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog);\r\n  }\r\n\r\n  onSubmitVerificationFile(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\r\n      const request = {\r\n        fileTxnId: this.sourceFileUploadComponent.verifiedFiles.map(x => String(x.meta_data.id))[0]\r\n      }\r\n\r\n      console.log(request);\r\n      this.annualWriteOffService.verifySource(this.annualWriteOffDataArray.annualWriteoff?.id, request).subscribe(\r\n        res => {\r\n          const verified = res.body?.data;\r\n          if (verified) {\r\n            this.sourceFileVerified = true;\r\n            this.sourceFileUploadComponent.disableButton = true;\r\n            this.loadWriteOffs();\r\n          } else {\r\n            this.toastService.error(\"Failed to verify source file\");\r\n          }\r\n        }\r\n      );\r\n    });\r\n  }\r\n\r\n  onSubmitApprove(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\r\n      // Call the service to approve the record\r\n      this.annualWriteOffService.approveAnnualWriteoff(this.annualWriteOffDataArray.annualWriteoff).subscribe(res => {\r\n        if (res) {\r\n          if (res.ok) {\r\n            this.toastService.success(res.body.success_message);\r\n            this.router.navigate(['/inbox']);\r\n          }\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  onSubmitRejection(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key, dialog, () => {\r\n      // Call the service to reject the record\r\n      this.annualWriteOffDataArray.annualWriteoff.reason = this.rejectionReasonComponent.rejectionReason;\r\n      this.annualWriteOffService.rejectAnnualWriteoff(this.annualWriteOffDataArray.annualWriteoff).subscribe(res => {\r\n        if (res) {\r\n          if (res.ok) {\r\n            this.toastService.success(res.body.success_message);\r\n            this.router.navigate(['/inbox']);\r\n          }\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  // Pop up the Confirmation dialog to Cancel current transaction\r\n  onCancel(event: Event, key: string, dialog: any): void {\r\n    this.nspConfirmService.onConfirmPopup(event, key,\r\n      dialog, () => {\r\n        // Define function that will be called upon confirmation of the cancellation dialog\r\n        // Will route back to Inbox upon cancellation in this case\r\n        this.router.navigate(['/inbox']);\r\n      });\r\n  }\r\n\r\n  onOpen(dialog: any): void {\r\n    console.log('Opening dialog now');\r\n    dialog.display = true;\r\n  }\r\n\r\n  exportCSV(): void {\r\n    // TODO: Implement export CSV function or call it from a utility class\r\n  }\r\n\r\n  downloadFromDMS(fileId: string): void {\r\n    if (fileId) {\r\n      this.fileUploadService.downloadTxnId(fileId).subscribe(\r\n        res => {\r\n          if (res) {\r\n            const data = res;\r\n            const contentDispositionHeader: string = data.headers.get('content-disposition');\r\n            const fileName = contentDispositionHeader.split(';')[1].trim().split('=')[1].replace(/\"/g, '');\r\n            const blob = new Blob([data.body], {type: data.headers.get('content-type')});\r\n            const anchor = document.createElement(\"a\");\r\n            anchor.href = URL.createObjectURL(blob);\r\n            anchor.download = fileName;\r\n            anchor.click();\r\n          }\r\n        },\r\n        error => {\r\n          this.toastService.error(error.error?.error_desc);\r\n        }\r\n      );\r\n      screenTop\r\n    }\r\n  }\r\n}\r\n","<form [formGroup]='approveAnnualWriteoffUploadsForm'>\r\n  <div class='grid'>\r\n    <!--  Placeholder for the annual write off file record    -->\r\n    <div class='col-8'>\r\n      <p-panel header='Annual Write-Off'>\r\n        <div class='grid'>\r\n          <div class='col-4'>\r\n            Total no. of record: {{annualWriteOffDataArray?.annualWriteoff?.totalCount}}\r\n          </div>\r\n          <div class='col-8'>\r\n            Total Amount: {{annualWriteOffDataArray?.annualWriteoff?.totalAmountToWriteoff | currency:'SGD':'symbol-narrow'}}\r\n          </div>\r\n        </div>\r\n      </p-panel>\r\n\r\n      <br>\r\n      <p-table *ngIf='sourceFileVerified' [value]='annualWriteOffDataArray.pendingWriteOffs'\r\n               styleClass='p-datatable-gridlines' [paginator]='true' [rows]='10' [rowsPerPageOptions]='[10,25,50]'\r\n               [showCurrentPageReport]='true'\r\n               currentPageReportTemplate='Showing {first} to {last} of {totalRecords} entries'>\r\n        <ng-template pTemplate='caption'>\r\n          <div class='grid'>\r\n            <div class='col-1 nsp-align-left flex justify-content-start align-items-center'>\r\n              <button type='button' pButton pRipple icon='pi pi-file-o' (click)='exportCSV()' pTooltip='Export as CSV'\r\n                      tooltipPosition='bottom'></button>\r\n            </div>\r\n            <div class='col-6 nsp-align-left flex justify-content-start align-items-center'>Write-Off List</div>\r\n          </div>\r\n        </ng-template>\r\n        <ng-template pTemplate='header'>\r\n          <tr>\r\n            <th scope=\"col\" class='snHeader'>SN</th>\r\n            <th scope=\"col\" class='overpaymentIdHeader' pSortableColumn='overpaymentId'>Overpayment ID\r\n              <p-sortIcon\r\n                field='overpaymentId'>\r\n              </p-sortIcon>\r\n            </th>\r\n            <th scope=\"col\" class='overpaymentPeriodHeader' pSortableColumn='overpaymentPeriod'>Overpayment Period\r\n              <p-sortIcon\r\n                field='overpaymentPeriod'></p-sortIcon>\r\n            </th>\r\n            <th scope=\"col\" class='nricHeader' pSortableColumn='nric'>NRIC\r\n              <p-sortIcon field='nric'></p-sortIcon>\r\n            </th>\r\n            <th scope=\"col\" pSortableColumn='amountToWriteOff'>Amount to Write-Off\r\n              <p-sortIcon field='amountToWriteOff'></p-sortIcon>\r\n            </th>\r\n          </tr>\r\n        </ng-template>\r\n\r\n        <ng-template pTemplate='body' let-writeOffRecord let-i='rowIndex'>\r\n          <tr>\r\n            <td>{{ i + 1 }}</td>\r\n            <td>{{ writeOffRecord?.overpayment?.id}}</td>\r\n            <td>{{ writeOffRecord?.overpayment?.trgStart}} - {{ writeOffRecord?.overpayment?.trgEnd}}</td>\r\n            <td>{{ writeOffRecord?.nric}}</td>\r\n            <td>{{ writeOffRecord?.amountToWriteoff}}</td>\r\n          </tr>\r\n        </ng-template>\r\n\r\n        <ng-template pTemplate='emptymessage'>\r\n          <tr>\r\n            <td colspan='5'>No Annual Write-off records found.</td>\r\n          </tr>\r\n        </ng-template>\r\n      </p-table>\r\n    </div>\r\n\r\n    <div class='col-4'>\r\n      <!--    Panel for File verification panel    -->\r\n      <div>\r\n        <p-panel header='Verify Source File'>\r\n          <n2-file-upload formControlName='sourceFile' id='sourceFile' #sourceFile\r\n            [externalFileLimit]=\"fileUploadFileLimit\" [contentHeight]=\"'150px'\"></n2-file-upload>\r\n          <br>\r\n          <div class='grid'>\r\n            <div class='col-9'>\r\n              <div *ngIf='!sourceFileVerified'>\r\n                <div>\r\n                  Please upload file for verification.\r\n                </div>\r\n                <div>\r\n                  File verification is required for approval.\r\n                </div>\r\n              </div>\r\n              <div *ngIf='sourceFileVerified'>\r\n                  File verified.\r\n              </div>\r\n            </div>\r\n            <div class='col-3'>\r\n              <div class='flex' [style]=\"{'justify-content': 'end'}\">\r\n                <button pButton label='Submit' [disabled]='sourceFileUploadComponent.verifiedFiles.length === 0 || sourceFileVerified'\r\n                        (click)=\"onSubmitVerificationFile($event, 'annualWriteOffFileVerifyUpload', null)\"\r\n                        [style]=\"{'margin-left': '.5em' , 'margin-bottom': '.5em'}\"></button>\r\n                <p-confirmPopup key='annualWriteOffFileVerifyUpload'></p-confirmPopup>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </p-panel>\r\n      </div>\r\n      <br>\r\n      <!--    Panel for Supporting document    -->\r\n      <div>\r\n        <p-panel header='Supporting Document'>\r\n          <p-table [value]='annualWriteOffDataArray.annualWriteoff?.supportingDocs'\r\n            styleClass='p-datatable-gridlines' [paginator]='true' [rows]='5'>\r\n            <ng-template pTemplate='header'>\r\n              <tr>\r\n                <th scope=\"col\" class='snHeader'>SN</th>\r\n                <th scope=\"col\">Filename</th>\r\n              </tr>\r\n            </ng-template>\r\n            <ng-template pTemplate='body' let-record let-i='rowIndex'>\r\n              <tr>\r\n                <td>{{i+1}}</td>\r\n                <td><a href=\"javascript:void(0)\" (click)=\"downloadFromDMS(record.documentId)\">{{record.filename}}</a></td>\r\n              </tr>\r\n            </ng-template>\r\n          </p-table>\r\n        </p-panel>\r\n      </div>\r\n      <br>\r\n      <div class='grid'>\r\n        <div class='col-12'>\r\n          <div class='flex' [style]=\"{'justify-content': 'end'}\">\r\n            <button class='p-button-danger' type='button' pButton label='Cancel'\r\n                    (click)=\"onCancel($event, 'annualWriteOffCancel', null)\"\r\n                    [style]=\"{'margin-left': '.5em'}\"></button>\r\n            <button class='p-button-outlined' type='button' pButton label='Reject'\r\n                    (click)='onOpen(displayRejectionReasonDialog)'\r\n                    [style]=\"{'margin-left': '.5em'}\"></button>\r\n            <button type='button' pButton label='Approve' [disabled]='!sourceFileVerified'\r\n                    (click)=\"onSubmitApprove($event, 'annualWriteOffApprove', null)\"\r\n                    [style]=\"{'margin-left': '.5em'}\"></button>\r\n            <p-confirmPopup key='annualWriteOffCancel'></p-confirmPopup>\r\n            <p-confirmPopup key='annualWriteOffApprove'></p-confirmPopup>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</form>\r\n<p-dialog header='Reject Annual Writeoff' [(visible)]='displayRejectionReasonDialog.display'\r\n          [breakpoints]=\"{'960px': '75vw'}\"\r\n          [style]=\"{width: '50vw'}\" [draggable]='false' [resizable]='false' [modal]='true'>\r\n\r\n  <n2-rejection-reason #rejectionReasonDialog></n2-rejection-reason>\r\n\r\n  <ng-template pTemplate='footer'>\r\n    <button pButton class='p-button-danger' label='Cancel'\r\n            (click)='displayRejectionReasonDialog.display=false'\r\n            [style]=\"{'margin-left': '.5em'}\"></button>\r\n    <button pButton label='Submit' [disabled]='!rejectionReasonDialog.rejectionReasonForm.valid'\r\n            (click)=\"onSubmitRejection($event, 'annualWriteoffRejectConfirmation', displayRejectionReasonDialog)\"\r\n            [style]=\"{'margin-left': '.5em'}\"></button>\r\n  </ng-template>\r\n  <p-confirmPopup key='annualWriteoffRejectConfirmation'></p-confirmPopup>\r\n</p-dialog>\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}