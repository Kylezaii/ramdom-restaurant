{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AuditsComponent = void 0;\nconst tslib_1 = require(\"tslib\");\nconst rxjs_1 = require(\"rxjs\");\nconst dayjs_1 = tslib_1.__importDefault(require(\"dayjs\"));\nconst input_constants_1 = require(\"app/config/input.constants\");\nconst pagination_constants_1 = require(\"app/config/pagination.constants\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"./audits.service\"));\nconst i2 = tslib_1.__importStar(require(\"@angular/router\"));\nconst i3 = tslib_1.__importStar(require(\"@angular/forms\"));\nconst i4 = tslib_1.__importStar(require(\"@angular/common\"));\nconst i5 = tslib_1.__importStar(require(\"@ng-bootstrap/ng-bootstrap\"));\nconst i6 = tslib_1.__importStar(require(\"@fortawesome/angular-fontawesome\"));\nconst i7 = tslib_1.__importStar(require(\"../../shared/language/translate.directive\"));\nconst i8 = tslib_1.__importStar(require(\"../../shared/alert/alert-error.component\"));\nconst i9 = tslib_1.__importStar(require(\"../../shared/sort/sort-by.directive\"));\nconst i10 = tslib_1.__importStar(require(\"../../shared/sort/sort.directive\"));\nconst i11 = tslib_1.__importStar(require(\"../../shared/pagination/item-count.component\"));\nfunction AuditsComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"span\", 15);\n    i0.ɵɵtext(3, \"No audit found\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"\\n  \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AuditsComponent_div_37_tr_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtext(1, \"\\n          \");\n    i0.ɵɵelementStart(2, \"th\", 27)(3, \"span\", 21);\n    i0.ɵɵtext(4, \"Date\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(5, \"\\n          \");\n    i0.ɵɵelementStart(6, \"th\", 27)(7, \"span\", 24);\n    i0.ɵɵtext(8, \"User\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementStart(10, \"th\", 27)(11, \"span\", 26);\n    i0.ɵɵtext(12, \"State\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(13, \"\\n          \");\n    i0.ɵɵelementStart(14, \"th\", 27)(15, \"span\", 28);\n    i0.ɵɵtext(16, \"Extra data\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(17, \"\\n        \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AuditsComponent_div_37_tr_42_span_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const audit_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(audit_r5.data.messageValue);\n  }\n}\nfunction AuditsComponent_div_37_tr_42_span_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34)(1, \"span\", 35);\n    i0.ɵɵtext(2, \"Remote Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const audit_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", audit_r5.data.messageKey, \"\");\n  }\n}\nfunction AuditsComponent_div_37_tr_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵtext(1, \"\\n          \");\n    i0.ɵɵelementStart(2, \"td\");\n    i0.ɵɵtext(3, \"\\n            \");\n    i0.ɵɵelementStart(4, \"span\");\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n          \");\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10, \"\\n            \");\n    i0.ɵɵelementStart(11, \"small\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(13, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n          \");\n    i0.ɵɵelementStart(15, \"td\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(17, \"\\n          \");\n    i0.ɵɵelementStart(18, \"td\");\n    i0.ɵɵtext(19, \"\\n            \");\n    i0.ɵɵtemplate(20, AuditsComponent_div_37_tr_42_span_20_Template, 2, 1, \"span\", 31);\n    i0.ɵɵtext(21, \"\\n            \");\n    i0.ɵɵtemplate(22, AuditsComponent_div_37_tr_42_span_22_Template, 4, 1, \"span\", 32);\n    i0.ɵɵtext(23, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24, \"\\n        \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const audit_r5 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(6, 5, audit_r5.timestamp, \"medium\"));\n    i0.ɵɵadvance(7);\n    i0.ɵɵtextInterpolate(audit_r5.principal);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(audit_r5.type);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", audit_r5.data);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", audit_r5.data);\n  }\n}\nfunction AuditsComponent_div_37_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"table\", 17);\n    i0.ɵɵtext(3, \"\\n      \");\n    i0.ɵɵelementStart(4, \"thead\", 18);\n    i0.ɵɵtext(5, \"\\n        \");\n    i0.ɵɵelementStart(6, \"tr\", 19);\n    i0.ɵɵlistener(\"predicateChange\", function AuditsComponent_div_37_Template_tr_predicateChange_6_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.predicate = $event);\n    })(\"ascendingChange\", function AuditsComponent_div_37_Template_tr_ascendingChange_6_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.ascending = $event);\n    });\n    i0.ɵɵtext(7, \"\\n          \");\n    i0.ɵɵelementStart(8, \"th\", 20);\n    i0.ɵɵtext(9, \"\\n            \");\n    i0.ɵɵelementStart(10, \"span\", 21);\n    i0.ɵɵtext(11, \"Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \" \");\n    i0.ɵɵelement(13, \"fa-icon\", 22);\n    i0.ɵɵtext(14, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15, \"\\n          \");\n    i0.ɵɵelementStart(16, \"th\", 23);\n    i0.ɵɵtext(17, \"\\n            \");\n    i0.ɵɵelementStart(18, \"span\", 24);\n    i0.ɵɵtext(19, \"User\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(20, \" \");\n    i0.ɵɵelement(21, \"fa-icon\", 22);\n    i0.ɵɵtext(22, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(23, \"\\n          \");\n    i0.ɵɵelementStart(24, \"th\", 25);\n    i0.ɵɵtext(25, \"\\n            \");\n    i0.ɵɵelementStart(26, \"span\", 26);\n    i0.ɵɵtext(27, \"State\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(28, \" \");\n    i0.ɵɵelement(29, \"fa-icon\", 22);\n    i0.ɵɵtext(30, \"\\n          \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(31, \"\\n          \");\n    i0.ɵɵelementStart(32, \"th\", 27)(33, \"span\", 28);\n    i0.ɵɵtext(34, \"Extra data\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtext(35, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(36, \"\\n        \");\n    i0.ɵɵtemplate(37, AuditsComponent_div_37_tr_37_Template, 18, 0, \"tr\", 29);\n    i0.ɵɵtext(38, \"\\n      \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(39, \"\\n      \");\n    i0.ɵɵelementStart(40, \"tbody\");\n    i0.ɵɵtext(41, \"\\n        \");\n    i0.ɵɵtemplate(42, AuditsComponent_div_37_tr_42_Template, 25, 8, \"tr\", 30);\n    i0.ɵɵtext(43, \"\\n      \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(44, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(45, \"\\n  \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngSwitch\", ctx_r1.canLoad());\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"predicate\", ctx_r1.predicate)(\"ascending\", ctx_r1.ascending)(\"callback\", ctx_r1.transition.bind(ctx_r1));\n    i0.ɵɵadvance(31);\n    i0.ɵɵproperty(\"ngSwitchCase\", false);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.audits);\n  }\n}\nconst _c0 = function (a0, a1, a2) {\n  return {\n    page: a0,\n    totalItems: a1,\n    itemsPerPage: a2\n  };\n};\nfunction AuditsComponent_div_39_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"div\", 36);\n    i0.ɵɵtext(3, \"\\n      \");\n    i0.ɵɵelement(4, \"ic-item-count\", 37);\n    i0.ɵɵtext(5, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n\\n    \");\n    i0.ɵɵelementStart(7, \"div\", 36);\n    i0.ɵɵtext(8, \"\\n      \");\n    i0.ɵɵelementStart(9, \"ngb-pagination\", 38);\n    i0.ɵɵlistener(\"pageChange\", function AuditsComponent_div_39_Template_ngb_pagination_pageChange_9_listener($event) {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.page = $event);\n    })(\"pageChange\", function AuditsComponent_div_39_Template_ngb_pagination_pageChange_9_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.transition());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n  \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"params\", i0.ɵɵpureFunction3(8, _c0, ctx_r2.page, ctx_r2.totalItems, ctx_r2.itemsPerPage));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"collectionSize\", ctx_r2.totalItems)(\"page\", ctx_r2.page)(\"pageSize\", ctx_r2.itemsPerPage)(\"maxSize\", 5)(\"rotate\", true)(\"boundaryLinks\", true)(\"disabled\", !ctx_r2.canLoad());\n  }\n}\nclass AuditsComponent {\n  constructor(auditsService, activatedRoute, router) {\n    this.auditsService = auditsService;\n    this.activatedRoute = activatedRoute;\n    this.router = router;\n    this.fromDate = '';\n    this.itemsPerPage = pagination_constants_1.ITEMS_PER_PAGE;\n    this.toDate = '';\n    this.totalItems = 0;\n  }\n  ngOnInit() {\n    this.toDate = this.today();\n    this.fromDate = this.previousMonth();\n    this.handleNavigation();\n  }\n  canLoad() {\n    return this.fromDate !== '' && this.toDate !== '';\n  }\n  transition() {\n    if (this.canLoad()) {\n      this.router.navigate(['/admin/audits'], {\n        queryParams: {\n          page: this.page,\n          sort: this.predicate + ',' + (this.ascending ? 'asc' : 'desc'),\n          from: this.fromDate,\n          to: this.toDate\n        }\n      });\n    }\n  }\n  previousMonth() {\n    let date = new Date();\n    if (date.getMonth() === 0) {\n      date = new Date(date.getFullYear() - 1, 11, date.getDate());\n    } else {\n      date = new Date(date.getFullYear(), date.getMonth() - 1, date.getDate());\n    }\n    return (0, dayjs_1.default)(date).format(input_constants_1.DATE_FORMAT);\n  }\n  today() {\n    // Today + 1 day - needed if the current day must be included\n    const date = new Date();\n    date.setDate(date.getDate() + 1);\n    return (0, dayjs_1.default)(date).format(input_constants_1.DATE_FORMAT);\n  }\n  handleNavigation() {\n    (0, rxjs_1.combineLatest)([this.activatedRoute.data, this.activatedRoute.queryParamMap]).subscribe(([data, params]) => {\n      const page = params.get('page');\n      this.page = page !== null ? +page : 1;\n      const sort = (params.get('sort') ?? data['defaultSort']).split(',');\n      this.predicate = sort[0];\n      this.ascending = sort[1] === 'asc';\n      this.loadData();\n    });\n  }\n  loadData() {\n    this.auditsService.query({\n      page: this.page - 1,\n      size: this.itemsPerPage,\n      sort: this.sort(),\n      fromDate: this.fromDate,\n      toDate: this.toDate\n    }).subscribe(res => this.onSuccess(res.body, res.headers));\n  }\n  sort() {\n    const result = [this.predicate + ',' + (this.ascending ? 'asc' : 'desc')];\n    if (this.predicate !== 'id') {\n      result.push('id');\n    }\n    return result;\n  }\n  onSuccess(audits, headers) {\n    this.totalItems = Number(headers.get('X-Total-Count'));\n    this.audits = audits ?? [];\n  }\n}\nexports.AuditsComponent = AuditsComponent;\nAuditsComponent.ɵfac = function AuditsComponent_Factory(t) {\n  return new (t || AuditsComponent)(i0.ɵɵdirectiveInject(i1.AuditsService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router));\n};\nAuditsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AuditsComponent,\n  selectors: [[\"ic-audit\"]],\n  decls: 42,\n  vars: 5,\n  consts: [[\"id\", \"audits-page-heading\", \"icTranslate\", \"audits.title\"], [1, \"row\"], [1, \"col-md-5\"], [\"icTranslate\", \"audits.filter.title\"], [1, \"input-group\", \"mb-3\"], [1, \"input-group-prepend\"], [\"icTranslate\", \"audits.filter.from\", 1, \"input-group-text\"], [\"type\", \"date\", \"name\", \"start\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"input-group-append\"], [\"icTranslate\", \"audits.filter.to\", 1, \"input-group-text\"], [\"type\", \"date\", \"name\", \"end\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"class\", \"alert alert-warning\", 4, \"ngIf\"], [\"class\", \"table-responsive\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"alert\", \"alert-warning\"], [\"icTranslate\", \"audits.notFound\"], [1, \"table-responsive\"], [\"aria-describedby\", \"audits-page-heading\", 1, \"table\", \"table-sm\", \"table-striped\"], [3, \"ngSwitch\"], [\"icSort\", \"\", 3, \"predicate\", \"ascending\", \"callback\", \"predicateChange\", \"ascendingChange\"], [\"scope\", \"col\", \"icSortBy\", \"auditEventDate\"], [\"icTranslate\", \"audits.table.header.date\"], [\"icon\", \"sort\"], [\"scope\", \"col\", \"icSortBy\", \"principal\"], [\"icTranslate\", \"audits.table.header.principal\"], [\"scope\", \"col\", \"icSortBy\", \"auditEventType\"], [\"icTranslate\", \"audits.table.header.status\"], [\"scope\", \"col\"], [\"icTranslate\", \"audits.table.header.data\"], [4, \"ngSwitchCase\"], [4, \"ngFor\", \"ngForOf\"], [\"ng-show\", \"audit.data.message\", 4, \"ngIf\"], [\"ng-show\", \"audit.data.remoteAddress\", 4, \"ngIf\"], [\"ng-show\", \"audit.data.message\"], [\"ng-show\", \"audit.data.remoteAddress\"], [\"icTranslate\", \"audits.table.data.remoteAddress\"], [1, \"row\", \"justify-content-center\"], [3, \"params\"], [3, \"collectionSize\", \"page\", \"pageSize\", \"maxSize\", \"rotate\", \"boundaryLinks\", \"disabled\", \"pageChange\"]],\n  template: function AuditsComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\");\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelementStart(2, \"h2\", 0);\n      i0.ɵɵtext(3, \"Audits\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(4, \"\\n\\n  \");\n      i0.ɵɵelement(5, \"ic-alert-error\");\n      i0.ɵɵtext(6, \"\\n\\n  \");\n      i0.ɵɵelementStart(7, \"div\", 1);\n      i0.ɵɵtext(8, \"\\n    \");\n      i0.ɵɵelementStart(9, \"div\", 2);\n      i0.ɵɵtext(10, \"\\n      \");\n      i0.ɵɵelementStart(11, \"h4\", 3);\n      i0.ɵɵtext(12, \"Filter by date\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(13, \"\\n\\n      \");\n      i0.ɵɵelementStart(14, \"div\", 4);\n      i0.ɵɵtext(15, \"\\n        \");\n      i0.ɵɵelementStart(16, \"div\", 5);\n      i0.ɵɵtext(17, \"\\n          \");\n      i0.ɵɵelementStart(18, \"span\", 6);\n      i0.ɵɵtext(19, \"from\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(20, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(21, \"\\n        \");\n      i0.ɵɵelementStart(22, \"input\", 7);\n      i0.ɵɵlistener(\"ngModelChange\", function AuditsComponent_Template_input_ngModelChange_22_listener($event) {\n        return ctx.fromDate = $event;\n      })(\"ngModelChange\", function AuditsComponent_Template_input_ngModelChange_22_listener() {\n        return ctx.transition();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(23, \"\\n\\n        \");\n      i0.ɵɵelementStart(24, \"div\", 8);\n      i0.ɵɵtext(25, \"\\n          \");\n      i0.ɵɵelementStart(26, \"span\", 9);\n      i0.ɵɵtext(27, \"To\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(28, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(29, \"\\n        \");\n      i0.ɵɵelementStart(30, \"input\", 10);\n      i0.ɵɵlistener(\"ngModelChange\", function AuditsComponent_Template_input_ngModelChange_30_listener($event) {\n        return ctx.toDate = $event;\n      })(\"ngModelChange\", function AuditsComponent_Template_input_ngModelChange_30_listener() {\n        return ctx.transition();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(31, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(32, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(33, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(34, \"\\n\\n  \");\n      i0.ɵɵtemplate(35, AuditsComponent_div_35_Template, 5, 0, \"div\", 11);\n      i0.ɵɵtext(36, \"\\n\\n  \");\n      i0.ɵɵtemplate(37, AuditsComponent_div_37_Template, 46, 6, \"div\", 12);\n      i0.ɵɵtext(38, \"\\n\\n  \");\n      i0.ɵɵtemplate(39, AuditsComponent_div_39_Template, 12, 12, \"div\", 13);\n      i0.ɵɵtext(40, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(41, \"\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(22);\n      i0.ɵɵproperty(\"ngModel\", ctx.fromDate);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngModel\", ctx.toDate);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngIf\", (ctx.audits == null ? null : ctx.audits.length) === 0);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", (ctx.audits == null ? null : ctx.audits.length) > 0);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", (ctx.audits == null ? null : ctx.audits.length) > 0);\n    }\n  },\n  dependencies: [i3.DefaultValueAccessor, i3.NgControlStatus, i3.RequiredValidator, i3.NgModel, i4.NgForOf, i4.NgIf, i4.NgSwitch, i4.NgSwitchCase, i5.NgbPagination, i6.FaIconComponent, i7.TranslateDirective, i8.AlertErrorComponent, i9.SortByDirective, i10.SortDirective, i11.ItemCountComponent, i4.DatePipe],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["i0","AuditsComponent","constructor","auditsService","activatedRoute","router","pagination_constants_1","ngOnInit","toDate","today","fromDate","previousMonth","handleNavigation","canLoad","transition","navigate","queryParams","page","sort","predicate","ascending","from","to","date","Date","getMonth","getFullYear","getDate","format","input_constants_1","setDate","data","queryParamMap","subscribe","params","get","split","loadData","query","size","itemsPerPage","res","onSuccess","body","headers","result","push","audits","totalItems","Number","exports","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\admin\\audits\\audits.component.ts","C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\admin\\audits\\audits.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { HttpResponse, HttpHeaders } from '@angular/common/http';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { combineLatest } from 'rxjs';\r\nimport dayjs from 'dayjs';\r\nimport { DATE_FORMAT } from 'app/config/input.constants';\r\nimport { ITEMS_PER_PAGE } from 'app/config/pagination.constants';\r\nimport { Audit } from './audit.model';\r\nimport { AuditsService } from './audits.service';\r\n\r\n@Component({\r\n  selector: 'ic-audit',\r\n  templateUrl: './audits.component.html',\r\n})\r\nexport class AuditsComponent implements OnInit {\r\n  audits?: Audit[];\r\n  fromDate = '';\r\n  itemsPerPage = ITEMS_PER_PAGE;\r\n  page!: number;\r\n  predicate!: string;\r\n  ascending!: boolean;\r\n  toDate = '';\r\n  totalItems = 0;\r\n\r\n  constructor(private auditsService: AuditsService, private activatedRoute: ActivatedRoute, private router: Router) {}\r\n\r\n  ngOnInit(): void {\r\n    this.toDate = this.today();\r\n    this.fromDate = this.previousMonth();\r\n    this.handleNavigation();\r\n  }\r\n\r\n  canLoad(): boolean {\r\n    return this.fromDate !== '' && this.toDate !== '';\r\n  }\r\n\r\n  transition(): void {\r\n    if (this.canLoad()) {\r\n      this.router.navigate(['/admin/audits'], {\r\n        queryParams: {\r\n          page: this.page,\r\n          sort: this.predicate + ',' + (this.ascending ? 'asc' : 'desc'),\r\n          from: this.fromDate,\r\n          to: this.toDate,\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  private previousMonth(): string {\r\n    let date = new Date();\r\n    if (date.getMonth() === 0) {\r\n      date = new Date(date.getFullYear() - 1, 11, date.getDate());\r\n    } else {\r\n      date = new Date(date.getFullYear(), date.getMonth() - 1, date.getDate());\r\n    }\r\n    return dayjs(date).format(DATE_FORMAT);\r\n  }\r\n\r\n  private today(): string {\r\n    // Today + 1 day - needed if the current day must be included\r\n    const date = new Date();\r\n    date.setDate(date.getDate() + 1);\r\n    return dayjs(date).format(DATE_FORMAT);\r\n  }\r\n\r\n  private handleNavigation(): void {\r\n    combineLatest([this.activatedRoute.data, this.activatedRoute.queryParamMap]).subscribe(([data, params]) => {\r\n      const page = params.get('page');\r\n      this.page = page !== null ? +page : 1;\r\n      const sort = (params.get('sort') ?? data['defaultSort']).split(',');\r\n      this.predicate = sort[0];\r\n      this.ascending = sort[1] === 'asc';\r\n      this.loadData();\r\n    });\r\n  }\r\n\r\n  private loadData(): void {\r\n    this.auditsService\r\n      .query({\r\n        page: this.page - 1,\r\n        size: this.itemsPerPage,\r\n        sort: this.sort(),\r\n        fromDate: this.fromDate,\r\n        toDate: this.toDate,\r\n      })\r\n      .subscribe((res: HttpResponse<Audit[]>) => this.onSuccess(res.body, res.headers));\r\n  }\r\n\r\n  private sort(): string[] {\r\n    const result = [this.predicate + ',' + (this.ascending ? 'asc' : 'desc')];\r\n    if (this.predicate !== 'id') {\r\n      result.push('id');\r\n    }\r\n    return result;\r\n  }\r\n\r\n  private onSuccess(audits: Audit[] | null, headers: HttpHeaders): void {\r\n    this.totalItems = Number(headers.get('X-Total-Count'));\r\n    this.audits = audits ?? [];\r\n  }\r\n}\r\n","<div>\r\n  <h2 id=\"audits-page-heading\" icTranslate=\"audits.title\">Audits</h2>\r\n\r\n  <ic-alert-error></ic-alert-error>\r\n\r\n  <div class=\"row\">\r\n    <div class=\"col-md-5\">\r\n      <h4 icTranslate=\"audits.filter.title\">Filter by date</h4>\r\n\r\n      <div class=\"input-group mb-3\">\r\n        <div class=\"input-group-prepend\">\r\n          <span class=\"input-group-text\" icTranslate=\"audits.filter.from\">from</span>\r\n        </div>\r\n        <input type=\"date\" class=\"form-control\" name=\"start\" [(ngModel)]=\"fromDate\" (ngModelChange)=\"transition()\" required />\r\n\r\n        <div class=\"input-group-append\">\r\n          <span class=\"input-group-text\" icTranslate=\"audits.filter.to\">To</span>\r\n        </div>\r\n        <input type=\"date\" class=\"form-control\" name=\"end\" [(ngModel)]=\"toDate\" (ngModelChange)=\"transition()\" required />\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"alert alert-warning\" *ngIf=\"audits?.length! === 0\">\r\n    <span icTranslate=\"audits.notFound\">No audit found</span>\r\n  </div>\r\n\r\n  <div class=\"table-responsive\" *ngIf=\"audits?.length! > 0\">\r\n    <table class=\"table table-sm table-striped\" aria-describedby=\"audits-page-heading\">\r\n      <thead [ngSwitch]=\"canLoad()\">\r\n        <tr icSort [(predicate)]=\"predicate\" [(ascending)]=\"ascending\" [callback]=\"transition.bind(this)\">\r\n          <th scope=\"col\" icSortBy=\"auditEventDate\">\r\n            <span icTranslate=\"audits.table.header.date\">Date</span> <fa-icon icon=\"sort\"></fa-icon>\r\n          </th>\r\n          <th scope=\"col\" icSortBy=\"principal\">\r\n            <span icTranslate=\"audits.table.header.principal\">User</span> <fa-icon icon=\"sort\"></fa-icon>\r\n          </th>\r\n          <th scope=\"col\" icSortBy=\"auditEventType\">\r\n            <span icTranslate=\"audits.table.header.status\">State</span> <fa-icon icon=\"sort\"></fa-icon>\r\n          </th>\r\n          <th scope=\"col\"><span icTranslate=\"audits.table.header.data\">Extra data</span></th>\r\n        </tr>\r\n        <tr *ngSwitchCase=\"false\">\r\n          <th scope=\"col\"><span icTranslate=\"audits.table.header.date\">Date</span></th>\r\n          <th scope=\"col\"><span icTranslate=\"audits.table.header.principal\">User</span></th>\r\n          <th scope=\"col\"><span icTranslate=\"audits.table.header.status\">State</span></th>\r\n          <th scope=\"col\"><span icTranslate=\"audits.table.header.data\">Extra data</span></th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr *ngFor=\"let audit of audits\">\r\n          <td>\r\n            <span>{{ audit.timestamp | date: 'medium' }}</span>\r\n          </td>\r\n          <td>\r\n            <small>{{ audit.principal }}</small>\r\n          </td>\r\n          <td>{{ audit.type }}</td>\r\n          <td>\r\n            <span *ngIf=\"audit.data\" ng-show=\"audit.data.message\">{{ audit.data.messageValue }}</span>\r\n            <span *ngIf=\"audit.data\" ng-show=\"audit.data.remoteAddress\"\r\n              ><span icTranslate=\"audits.table.data.remoteAddress\">Remote Address</span> {{ audit.data.messageKey }}</span\r\n            >\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n\r\n  <div *ngIf=\"audits?.length! > 0\">\r\n    <div class=\"row justify-content-center\">\r\n      <ic-item-count [params]=\"{ page: page, totalItems: totalItems, itemsPerPage: itemsPerPage }\"></ic-item-count>\r\n    </div>\r\n\r\n    <div class=\"row justify-content-center\">\r\n      <ngb-pagination\r\n        [collectionSize]=\"totalItems\"\r\n        [(page)]=\"page\"\r\n        [pageSize]=\"itemsPerPage\"\r\n        [maxSize]=\"5\"\r\n        [rotate]=\"true\"\r\n        [boundaryLinks]=\"true\"\r\n        (pageChange)=\"transition()\"\r\n        [disabled]=\"!canLoad()\"\r\n      ></ngb-pagination>\r\n    </div>\r\n  </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}