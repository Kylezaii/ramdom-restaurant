{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.SearchOverpaymentComponent = void 0;\nconst tslib_1 = require(\"tslib\");\nconst core_1 = require(\"@angular/core\");\nconst i0 = tslib_1.__importStar(require(\"@angular/core\"));\nconst i1 = tslib_1.__importStar(require(\"../service/overpayment.service\"));\nconst i2 = tslib_1.__importStar(require(\"app/shared/service/ns2-http.service\"));\nconst i3 = tslib_1.__importStar(require(\"app/layouts/service/customtoast.service\"));\nconst i4 = tslib_1.__importStar(require(\"@angular/common\"));\nconst i5 = tslib_1.__importStar(require(\"primeng/api\"));\nconst i6 = tslib_1.__importStar(require(\"primeng/table\"));\nfunction SearchOverpaymentComponent_div_0_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n            \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementStart(3, \"th\", 5);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n                \");\n    i0.ɵɵelementStart(6, \"th\", 6);\n    i0.ɵɵtext(7, \"NRIC\");\n    i0.ɵɵelement(8, \"p-sortIcon\", 7);\n    i0.ɵɵtext(9, \"\\n                    \");\n    i0.ɵɵelement(10, \"p-columnFilter\", 8);\n    i0.ɵɵtext(11, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n                \");\n    i0.ɵɵelementStart(13, \"th\", 9);\n    i0.ɵɵtext(14, \"Name\");\n    i0.ɵɵelement(15, \"p-sortIcon\", 10);\n    i0.ɵɵtext(16, \"\\n                    \");\n    i0.ɵɵelement(17, \"p-columnFilter\", 11);\n    i0.ɵɵtext(18, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(20, \"\\n        \");\n  }\n}\nfunction SearchOverpaymentComponent_div_0_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n            \");\n    i0.ɵɵelementStart(1, \"tr\", 12);\n    i0.ɵɵlistener(\"click\", function SearchOverpaymentComponent_div_0_ng_template_6_Template_tr_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const nsman_r5 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.handleSelection(nsman_r5.nric));\n    });\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n                \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n                \");\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n        \");\n  }\n  if (rf & 2) {\n    const nsman_r5 = ctx.$implicit;\n    const i_r6 = ctx.rowIndex;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r6 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(nsman_r5.nric);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(nsman_r5.name);\n  }\n}\nfunction SearchOverpaymentComponent_div_0_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n            \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4, \"\\n                    No records found\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n        \");\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵattribute(\"colspan\", 3);\n  }\n}\nconst _c0 = function () {\n  return [10, 25, 50];\n};\nfunction SearchOverpaymentComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"p-table\", 1);\n    i0.ɵɵlistener(\"onLazyLoad\", function SearchOverpaymentComponent_div_0_Template_p_table_onLazyLoad_2_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.loadData($event));\n    })(\"onPage\", function SearchOverpaymentComponent_div_0_Template_p_table_onPage_2_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.onPage($event));\n    });\n    i0.ɵɵtext(3, \"\\n        \");\n    i0.ɵɵtemplate(4, SearchOverpaymentComponent_div_0_ng_template_4_Template, 21, 0, \"ng-template\", 2);\n    i0.ɵɵtext(5, \"\\n        \");\n    i0.ɵɵtemplate(6, SearchOverpaymentComponent_div_0_ng_template_6_Template, 13, 3, \"ng-template\", 3);\n    i0.ɵɵtext(7, \"\\n        \");\n    i0.ɵɵtemplate(8, SearchOverpaymentComponent_div_0_ng_template_8_Template, 7, 1, \"ng-template\", 4);\n    i0.ɵɵtext(9, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"value\", ctx_r0.resultList)(\"paginator\", true)(\"rows\", 10)(\"lazy\", true)(\"loading\", ctx_r0.loading)(\"totalRecords\", ctx_r0.totalRecords)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(9, _c0))(\"showCurrentPageReport\", true)(\"sortOrder\", 1);\n  }\n}\nfunction SearchOverpaymentComponent_div_2_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n            \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementStart(3, \"th\", 5);\n    i0.ɵɵtext(4, \"SN\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n                \");\n    i0.ɵɵelementStart(6, \"th\", 14);\n    i0.ɵɵtext(7, \"csn\");\n    i0.ɵɵelement(8, \"p-sortIcon\", 15);\n    i0.ɵɵtext(9, \"\\n                    \");\n    i0.ɵɵelement(10, \"p-columnFilter\", 16);\n    i0.ɵɵtext(11, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n                \");\n    i0.ɵɵelementStart(13, \"th\", 9);\n    i0.ɵɵtext(14, \"Name\");\n    i0.ɵɵelement(15, \"p-sortIcon\", 10);\n    i0.ɵɵtext(16, \"\\n                    \");\n    i0.ɵɵelement(17, \"p-columnFilter\", 11);\n    i0.ɵɵtext(18, \"\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(20, \"\\n        \");\n  }\n}\nfunction SearchOverpaymentComponent_div_2_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵtext(0, \"\\n            \");\n    i0.ɵɵelementStart(1, \"tr\", 12);\n    i0.ɵɵlistener(\"click\", function SearchOverpaymentComponent_div_2_ng_template_6_Template_tr_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const record_r15 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r17.handleSelection(record_r15.csn));\n    });\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n                \");\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \"\\n                \");\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(12, \"\\n        \");\n  }\n  if (rf & 2) {\n    const record_r15 = ctx.$implicit;\n    const i_r16 = ctx.rowIndex;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(i_r16 + 1);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(record_r15.csn);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(record_r15.name);\n  }\n}\nfunction SearchOverpaymentComponent_div_2_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n            \");\n    i0.ɵɵelementStart(1, \"tr\");\n    i0.ɵɵtext(2, \"\\n                \");\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4, \"\\n                    No records found\\n                \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\n            \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \"\\n        \");\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵattribute(\"colspan\", 3);\n  }\n}\nfunction SearchOverpaymentComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"\\n    \");\n    i0.ɵɵelementStart(2, \"p-table\", 13);\n    i0.ɵɵlistener(\"onLazyLoad\", function SearchOverpaymentComponent_div_2_Template_p_table_onLazyLoad_2_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.loadData($event));\n    })(\"onPage\", function SearchOverpaymentComponent_div_2_Template_p_table_onPage_2_listener($event) {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.onPage($event));\n    });\n    i0.ɵɵtext(3, \"\\n        \");\n    i0.ɵɵtemplate(4, SearchOverpaymentComponent_div_2_ng_template_4_Template, 21, 0, \"ng-template\", 2);\n    i0.ɵɵtext(5, \"\\n        \");\n    i0.ɵɵtemplate(6, SearchOverpaymentComponent_div_2_ng_template_6_Template, 13, 3, \"ng-template\", 3);\n    i0.ɵɵtext(7, \"\\n        \");\n    i0.ɵɵtemplate(8, SearchOverpaymentComponent_div_2_ng_template_8_Template, 7, 1, \"ng-template\", 4);\n    i0.ɵɵtext(9, \"\\n    \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(10, \"\\n\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"value\", ctx_r1.resultList)(\"paginator\", true)(\"rows\", 10)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(9, _c0))(\"showCurrentPageReport\", true)(\"loading\", ctx_r1.loading)(\"lazy\", true)(\"totalRecords\", ctx_r1.totalRecords)(\"sortOrder\", 1);\n  }\n}\nclass SearchOverpaymentComponent {\n  constructor(overpaymentService, n2httpService, toastService) {\n    this.overpaymentService = overpaymentService;\n    this.n2httpService = n2httpService;\n    this.toastService = toastService;\n    this.resultList = [];\n    this.searchInput = \"\";\n    this.selectEvent = new core_1.EventEmitter();\n    this.pageData = {\n      currentPage: 0\n    };\n    this.pageSize = 10;\n  }\n  ngOnInit() {\n    console.log(\"Search component initiated\");\n  }\n  loadData(event) {\n    this.lazyLoadEvent = event;\n    this.loading = true;\n    setTimeout(() => {\n      const options = this.n2httpService.convertLazyEvent(event, this.pageData, this.pageSize);\n      console.log(\"options\", options);\n      if (this.isNSman) {\n        this.overpaymentService.searchByNric(this.searchInput, options).subscribe(res => {\n          console.log(\"Search by NRIC Response\", res);\n          this.resultList = res.body.data.content;\n          this.totalRecords = res.body.data.totalElements;\n          this.loading = false;\n        }, error => {\n          this.toastService.add({\n            severity: 'error',\n            summary: 'Error',\n            detail: error.error.error_desc\n          });\n          this.loading = false;\n        });\n      } else {\n        this.overpaymentService.searchByCSN(this.searchInput, options).subscribe(res => {\n          this.resultList = res.body.data.content;\n          this.totalRecords = res.body.data.totalElements;\n          this.loading = false;\n          console.log(this.resultList);\n          if (this.resultList.length === 1) {\n            this.handleSelection(this.resultList[0]?.csn);\n          }\n        }, error => {\n          this.toastService.add({\n            severity: 'error',\n            summary: 'Error',\n            detail: error.error.error_desc\n          });\n          this.loading = false;\n        });\n      }\n    }, 1000);\n  }\n  onPage(event) {\n    this.pageSize = event.rows;\n    this.pageData.currentPage = event.first / event.rows;\n  }\n  refreshTable() {\n    this.loadData(this.lazyLoadEvent);\n  }\n  handleSelection(id) {\n    console.log(\"Emit event = \" + id);\n    this.selectEvent.emit(id);\n  }\n  exportCSV() {\n    // TODO: Implement export CSV function or call it from a utility class\n  }\n  log() {\n    console.log(this.selectedId);\n  }\n}\nexports.SearchOverpaymentComponent = SearchOverpaymentComponent;\nSearchOverpaymentComponent.ɵfac = function SearchOverpaymentComponent_Factory(t) {\n  return new (t || SearchOverpaymentComponent)(i0.ɵɵdirectiveInject(i1.OverpaymentService), i0.ɵɵdirectiveInject(i2.Ns2HttpService), i0.ɵɵdirectiveInject(i3.CustomToastService));\n};\nSearchOverpaymentComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: SearchOverpaymentComponent,\n  selectors: [[\"n2-search-overpayment\"]],\n  inputs: {\n    resultList: \"resultList\",\n    isNSman: \"isNSman\",\n    searchInput: \"searchInput\"\n  },\n  outputs: {\n    selectEvent: \"selectEvent\"\n  },\n  decls: 4,\n  vars: 2,\n  consts: [[4, \"ngIf\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", \"selectionMode\", \"single\", \"sortField\", \"name\", 3, \"value\", \"paginator\", \"rows\", \"lazy\", \"loading\", \"totalRecords\", \"rowsPerPageOptions\", \"showCurrentPageReport\", \"sortOrder\", \"onLazyLoad\", \"onPage\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"emptymessage\"], [\"scope\", \"col\", 2, \"width\", \"10%\"], [\"scope\", \"col\", \"pSortableColumn\", \"nric\", 2, \"width\", \"25%\"], [\"field\", \"nric\"], [\"type\", \"text\", \"field\", \"nric\", \"display\", \"menu\", \"matchMode\", \"contains\"], [\"scope\", \"col\", \"pSortableColumn\", \"name\", 2, \"width\", \"65%\"], [\"field\", \"name\"], [\"type\", \"text\", \"field\", \"name\", \"display\", \"menu\", \"matchMode\", \"contains\"], [3, \"click\"], [\"styleClass\", \"p-datatable-gridlines\", \"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", \"selectionMode\", \"single\", \"sortField\", \"name\", 3, \"value\", \"paginator\", \"rows\", \"rowsPerPageOptions\", \"showCurrentPageReport\", \"loading\", \"lazy\", \"totalRecords\", \"sortOrder\", \"onLazyLoad\", \"onPage\"], [\"scope\", \"col\", \"pSortableColumn\", \"csn\", 2, \"width\", \"25%\"], [\"field\", \"csn\"], [\"type\", \"text\", \"field\", \"csn\", \"display\", \"menu\", \"matchMode\", \"contains\"]],\n  template: function SearchOverpaymentComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, SearchOverpaymentComponent_div_0_Template, 11, 10, \"div\", 0);\n      i0.ɵɵtext(1, \"\\n\\n\");\n      i0.ɵɵtemplate(2, SearchOverpaymentComponent_div_2_Template, 11, 10, \"div\", 0);\n      i0.ɵɵtext(3, \"\\n\");\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.isNSman);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isNSman);\n    }\n  },\n  dependencies: [i4.NgIf, i5.PrimeTemplate, i6.Table, i6.SortableColumn, i6.SortIcon, i6.ColumnFilter],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzZWFyY2gtb3ZlcnBheW1lbnQuY29tcG9uZW50LnNjc3MifQ== */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tYWluL3dlYmFwcC9hcHAvcGF5bWVudC9vdmVycGF5bWVudC9zZWFyY2gvc2VhcmNoLW92ZXJwYXltZW50LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxvTEFBb0wiLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["i0","SearchOverpaymentComponent","constructor","overpaymentService","n2httpService","toastService","core_1","currentPage","ngOnInit","console","log","loadData","event","lazyLoadEvent","loading","setTimeout","options","convertLazyEvent","pageData","pageSize","isNSman","searchByNric","searchInput","subscribe","res","resultList","body","data","content","totalRecords","totalElements","error","add","severity","summary","detail","error_desc","searchByCSN","length","handleSelection","csn","onPage","rows","first","refreshTable","id","selectEvent","emit","exportCSV","selectedId","exports","selectors","inputs","outputs","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\payment\\overpayment\\search\\search-overpayment.component.ts","C:\\Users\\D1347074\\Desktop\\projects 2\\nspayiiapp\\src\\main\\webapp\\app\\payment\\overpayment\\search\\search-overpayment.component.html"],"sourcesContent":["import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\r\nimport {ISearchOP} from './search-overpayment.model';\r\nimport {LazyLoadEvent} from 'primeng/api';\r\nimport {Ns2HttpService} from 'app/shared/service/ns2-http.service';\r\nimport {OverpaymentService} from '../service/overpayment.service';\r\nimport {HttpErrorResponse, HttpResponse} from '@angular/common/http';\r\nimport {CustomToastService} from 'app/layouts/service/customtoast.service';\r\n\r\n@Component({\r\n  selector: 'n2-search-overpayment',\r\n  templateUrl: './search-overpayment.component.html',\r\n  styleUrls: ['./search-overpayment.component.scss']\r\n})\r\nexport class SearchOverpaymentComponent implements OnInit {\r\n\r\n  @Input() resultList: ISearchOP[] = [];\r\n  @Input() isNSman!: boolean;\r\n  @Input() searchInput = \"\";\r\n\r\n  @Output() selectEvent = new EventEmitter<string>();\r\n\r\n  selectedId: string;\r\n\r\n  // Lazy loading\r\n  totalRecords: number;\r\n  loading: boolean;\r\n  pageData: { currentPage: number } = {\r\n    currentPage: 0\r\n  }\r\n  pageSize = 10;\r\n  lazyLoadEvent!: LazyLoadEvent;\r\n\r\n  constructor(\r\n    private overpaymentService: OverpaymentService,\r\n    private n2httpService: Ns2HttpService,\r\n    private toastService: CustomToastService) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    console.log(\"Search component initiated\");\r\n  }\r\n\r\n  loadData(event: any): void {\r\n    this.lazyLoadEvent = event;\r\n    this.loading = true;\r\n\r\n    setTimeout(() => {\r\n      const options = this.n2httpService.convertLazyEvent(event, this.pageData, this.pageSize);\r\n\r\n      console.log(\"options\", options);\r\n      if(this.isNSman) {\r\n        this.overpaymentService.searchByNric(this.searchInput, options).subscribe(\r\n          (res: HttpResponse<any>) => {\r\n            console.log(\"Search by NRIC Response\", res);\r\n            this.resultList = res.body.data.content;\r\n            this.totalRecords = res.body.data.totalElements;\r\n            this.loading = false;\r\n          },\r\n          (error: HttpErrorResponse) => {\r\n            this.toastService.add({\r\n              severity: 'error',\r\n              summary: 'Error',\r\n              detail: error.error.error_desc\r\n            });\r\n            this.loading = false;\r\n          }\r\n        );\r\n      } else {\r\n        this.overpaymentService.searchByCSN(this.searchInput, options).subscribe(\r\n          (res: HttpResponse<any>) => {\r\n            this.resultList = res.body.data.content;\r\n            this.totalRecords = res.body.data.totalElements;\r\n            this.loading = false;\r\n            console.log(this.resultList);\r\n\r\n            if(this.resultList.length === 1) {\r\n              this.handleSelection(this.resultList[0]?.csn);\r\n            }\r\n          },\r\n          (error: HttpErrorResponse) => {\r\n            this.toastService.add({\r\n              severity: 'error',\r\n              summary: 'Error',\r\n              detail: error.error.error_desc\r\n            });\r\n            this.loading = false;\r\n          }\r\n        );\r\n      }\r\n    }, 1000);\r\n  }\r\n\r\n  onPage(event: any): void {\r\n    this.pageSize = event.rows;\r\n    this.pageData.currentPage = event.first / event.rows;\r\n  }\r\n\r\n  refreshTable(): void {\r\n    this.loadData(this.lazyLoadEvent);\r\n  }\r\n\r\n  handleSelection(id: string): void {\r\n    console.log(\"Emit event = \" + id);\r\n    this.selectEvent.emit(id);\r\n  }\r\n\r\n  exportCSV(): void {\r\n    // TODO: Implement export CSV function or call it from a utility class\r\n  }\r\n\r\n  log(): void {\r\n    console.log(this.selectedId);\r\n  }\r\n}\r\n","<div *ngIf=\"isNSman\">\r\n    <p-table\r\n        [value]=\"resultList\"\r\n        styleClass=\"p-datatable-gridlines\"\r\n        [paginator]=\"true\"\r\n        [rows]=\"10\"\r\n        [lazy]=\"true\"\r\n        [loading]=\"loading\"\r\n        (onLazyLoad)=\"loadData($event)\"\r\n        [totalRecords]=\"totalRecords\"\r\n        (onPage) = \"onPage($event)\"\r\n        currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} entries\"\r\n        [rowsPerPageOptions]=\"[10,25,50]\"\r\n        [showCurrentPageReport]=\"true\"\r\n        selectionMode=\"single\"\r\n        sortField=\"name\"\r\n        [sortOrder]=\"1\"\r\n        >\r\n        <ng-template pTemplate=\"header\">\r\n            <tr>\r\n                <th scope=\"col\" style=\"width: 10%\">SN</th>\r\n                <th scope=\"col\" style=\"width: 25%\" pSortableColumn=\"nric\">NRIC<p-sortIcon field=\"nric\"></p-sortIcon>\r\n                    <p-columnFilter type=\"text\" field=\"nric\" display=\"menu\" matchMode=\"contains\"></p-columnFilter>\r\n                </th>\r\n                <th scope=\"col\" style=\"width: 65%\" pSortableColumn=\"name\">Name<p-sortIcon field=\"name\"></p-sortIcon>\r\n                    <p-columnFilter type=\"text\" field=\"name\" display=\"menu\" matchMode=\"contains\"></p-columnFilter>\r\n                </th>\r\n            </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"body\" let-nsman let-i=\"rowIndex\">\r\n            <tr (click)=\"handleSelection(nsman.nric)\">\r\n                <td>{{i+1}}</td>\r\n                <td>{{nsman.nric}}</td>\r\n                <td>{{nsman.name}}</td>\r\n            </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"emptymessage\">\r\n            <tr>\r\n                <td [attr.colspan]=\"3\">\r\n                    No records found\r\n                </td>\r\n            </tr>\r\n        </ng-template>\r\n    </p-table>\r\n</div>\r\n\r\n<div *ngIf=\"!isNSman\">\r\n    <p-table\r\n        [value]=\"resultList\"\r\n        styleClass=\"p-datatable-gridlines\"\r\n        [paginator]=\"true\"\r\n        [rows]=\"10\"\r\n        currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} entries\"\r\n        [rowsPerPageOptions]=\"[10,25,50]\"\r\n        [showCurrentPageReport]=\"true\"\r\n        selectionMode=\"single\"\r\n        [loading]=\"loading\"\r\n        [lazy]=\"true\"\r\n        (onLazyLoad)=\"loadData($event)\"\r\n        [totalRecords]=\"totalRecords\"\r\n        (onPage) = \"onPage($event)\"\r\n        sortField=\"name\"\r\n        [sortOrder]=\"1\">\r\n        <ng-template pTemplate=\"header\">\r\n            <tr>\r\n                <th scope=\"col\" style=\"width: 10%\">SN</th>\r\n                <th scope=\"col\" style=\"width: 25%\" pSortableColumn=\"csn\">csn<p-sortIcon field=\"csn\"></p-sortIcon>\r\n                    <p-columnFilter type=\"text\" field=\"csn\" display=\"menu\" matchMode=\"contains\"></p-columnFilter>\r\n                </th>\r\n                <th scope=\"col\" style=\"width: 65%\" pSortableColumn=\"name\">Name<p-sortIcon field=\"name\"></p-sortIcon>\r\n                    <p-columnFilter type=\"text\" field=\"name\" display=\"menu\" matchMode=\"contains\"></p-columnFilter>\r\n                </th>\r\n            </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"body\" let-record let-i=\"rowIndex\">\r\n            <tr (click)=\"handleSelection(record.csn)\">\r\n                <td>{{i+1}}</td>\r\n                <td>{{record.csn}}</td>\r\n                <td>{{record.name}}</td>\r\n            </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"emptymessage\">\r\n            <tr>\r\n                <td [attr.colspan]=\"3\">\r\n                    No records found\r\n                </td>\r\n            </tr>\r\n        </ng-template>\r\n    </p-table>\r\n</div>\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}